<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kungfu Pandas</title>
  <meta name="description" content="Kungfu Pandas" />
  <meta name="generator" content="bookdown #bookdown:version# and GitBook 2.6.7" />

  <meta property="og:title" content="Kungfu Pandas" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Kungfu Pandas" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kungfu Pandas" />
  
  <meta name="twitter:description" content="Kungfu Pandas" />
  

<meta name="author" content="Lê Huỳnh Đức" />


<meta name="date" content="2025-01-05" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
<link rel="stylesheet" href="css/toc.css" type="text/css" />
<link rel="stylesheet" href="css/highlight.css" type="text/css" />
</head>

<body>



<!--bookdown:title:start-->
<div id="header">
<h1 class="title">Kungfu Pandas</h1>
<p class="author"><em>Lê Huỳnh Đức</em></p>
<p class="date"><em>2025-01-05</em></p>
</div>
<!--bookdown:title:end-->

<!--bookdown:toc:start-->
  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">
<!--bookdown:toc2:start-->
<ul>
<li><a href="#l%E1%BB%9Di-n%C3%B3i-%C4%91%E1%BA%A7u" id="toc-lời-nói-đầu">Lời nói đầu</a></li>
<li><a href="#gi%E1%BB%9Bi-thi%E1%BB%87u-pandas" id="toc-giới-thiệu-pandas"><span class="toc-section-number">1</span> Giới thiệu Pandas</a></li>
<li><a href="#gi%E1%BB%9Bi-thi%E1%BB%87u-pandas-1" id="toc-giới-thiệu-pandas-1"><span class="toc-section-number">2</span> Giới thiệu Pandas</a></li>
<li><a href="#c%E1%BA%A5u-tr%C3%BAc-v%C3%A0-ki%E1%BB%83u-d%E1%BB%AF-li%E1%BB%87u" id="toc-cấu-trúc-và-kiểu-dữ-liệu"><span class="toc-section-number">3</span> Cấu trúc và kiểu dữ liệu</a>
<ul>
<li><a href="#series" id="toc-series"><span class="toc-section-number">3.1</span> Series</a>
<ul>
<li><a href="#c%C3%A1c-c%C3%A1ch-kh%E1%BB%9Fi-t%E1%BA%A1o" id="toc-các-cách-khởi-tạo"><span class="toc-section-number">3.1.1</span> Các cách khởi tạo</a></li>
<li><a href="#m%E1%BB%99t-s%E1%BB%91-thao-t%C3%A1c-c%C6%A1-b%E1%BA%A3n-v%E1%BB%9Bi-series" id="toc-một-số-thao-tác-cơ-bản-với-series"><span class="toc-section-number">3.1.2</span> Một số thao tác cơ bản với Series</a></li>
</ul></li>
<li><a href="#cach-khoi-tao-data-frame" id="toc-cach-khoi-tao-data-frame"><span class="toc-section-number">3.2</span> DataFrame</a>
<ul>
<li><a href="#c%C3%A1c-c%C3%A1ch-kh%E1%BB%9Fi-t%E1%BA%A1o-1" id="toc-các-cách-khởi-tạo-1"><span class="toc-section-number">3.2.1</span> Các cách khởi tạo</a></li>
<li><a href="#c%C3%A1c-h%C3%A0m-kh%E1%BB%9Fi-t%E1%BA%A1o-thay-th%E1%BA%BF" id="toc-các-hàm-khởi-tạo-thay-thế"><span class="toc-section-number">3.2.2</span> Các hàm khởi tạo thay thế</a></li>
</ul></li>
<li><a href="#data-type-trong-pandas" id="toc-data-type-trong-pandas"><span class="toc-section-number">3.3</span> Data type trong pandas</a></li>
</ul></li>
</ul>
<!--bookdown:toc2:end-->
      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Kungfu Pandas</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<!--bookdown:toc:end-->
<!--bookdown:body:start-->
<div id="lời-nói-đầu" class="section level1 unnumbered hasAnchor">
<h1 class="unnumbered hasAnchor">Lời nói đầu<a href="#l%E1%BB%9Di-n%C3%B3i-%C4%91%E1%BA%A7u" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p><img src="../images/index/cover.jpg" /></p>
<!-- ## Giới thiệu cuốn sách {-} -->
<!-- ## Giới thiệu tác giả {-} -->
<!--chapter:end:index.Rmd-->
</div>
<div id="giới-thiệu-pandas" class="section level1 hasAnchor" number="1">
<h1 class="hasAnchor"><span class="header-section-number">1</span> Giới thiệu Pandas<a href="#gi%E1%BB%9Bi-thi%E1%BB%87u-pandas" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:posts/00-Introduction.Rmd-->
</div>
<div id="giới-thiệu-pandas-1" class="section level1 hasAnchor" number="2">
<h1 class="hasAnchor"><span class="header-section-number">2</span> Giới thiệu Pandas<a href="#gi%E1%BB%9Bi-thi%E1%BB%87u-pandas-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:posts/00-Introduction/00-Introduction.Rmd-->
</div>
<div id="cấu-trúc-và-kiểu-dữ-liệu" class="section level1 hasAnchor" number="3">
<h1 class="hasAnchor"><span class="header-section-number">3</span> Cấu trúc và kiểu dữ liệu<a href="#c%E1%BA%A5u-tr%C3%BAc-v%C3%A0-ki%E1%BB%83u-d%E1%BB%AF-li%E1%BB%87u" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Mục tiêu của chương này nhằm giới thiệu về các cấu trúc cơ bản trong Pandas là <code>Series</code> và <code>DataFrame</code>.
Trong chương này, bạn sẽ học cách khởi tạo các cấu trúc này cũng như một số thao tác cơ bản trên <code>Series</code>.
Bạn cũng sẽ được biết về một số kiểu dữ liệu thường gặp trong pandas và cách để giảm thiểu bộ nhớ sử dụng khi khởi tạo dữ liệu.</p>
<!--chapter:end:posts/01-DataStructure/00-Introduction.Rmd-->
<div id="series" class="section level2 hasAnchor" number="3.1">
<h2 class="hasAnchor"><span class="header-section-number">3.1</span> Series<a href="#series" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Trong Pandas, <code>Series</code> là mảng 1 chiều bao gồm một danh sách giá trị, và một mảng chứa index
của các giá trị. Trong dữ liệu dảng bảng, mỗi Series được xem như là một cột của bảng đó.
Cách đơn giản để tạo Series như sau</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>s <span class="op">=</span> pd.Series(data, index<span class="op">=</span><span class="va">None</span>, name<span class="op">=</span><span class="va">None</span>)</span></code></pre></div>
<p>Trong đó <code>data</code> có thể có dạng:</p>
<ul>
<li><p>dạng List của Python hoặc dạng <code>numpy.array</code></p></li>
<li><p>dictionary của Python</p></li>
<li><p>là một hằng số duy nhất</p></li>
</ul>
<p><code>index</code> có thể truyền hoặc không, tùy vào dạng của <code>data</code> mà <code>index</code> sẽ được định nghĩa khác nhau.
<code>name</code> là tên của <code>Series</code>, giá trị này cũng không nhất thiết phải truyền vào.</p>
<div id="các-cách-khởi-tạo" class="section level3 hasAnchor" number="3.1.1">
<h3 class="hasAnchor"><span class="header-section-number">3.1.1</span> Các cách khởi tạo<a href="#c%C3%A1c-c%C3%A1ch-kh%E1%BB%9Fi-t%E1%BA%A1o" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="khởi-tạo-series-bằng-list-hoặc-dạng-numpy.array" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Khởi tạo Series bằng List hoặc dạng numpy.array<a href="#kh%E1%BB%9Fi-t%E1%BA%A1o-series-b%E1%BA%B1ng-list-ho%E1%BA%B7c-d%E1%BA%A1ng-numpy.array" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Khi không truyền giá trị <code>index</code>, <code>Series</code> sẽ mặc định index của nó là 1 mảng số nguyên từ <code>0</code> đến <code>len(data) - 1</code></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>pd.Series(data<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>], index<span class="op">=</span>[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>], name<span class="op">=</span><span class="st">&quot;meow&quot;</span>)</span></code></pre></div>
<pre class="python_output"><code>a    0
b    1
c    2
Name: meow, dtype: int64</code></pre>
</div>
<div id="khởi-tạo-series-bằng-dictionary" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Khởi tạo Series bằng dictionary<a href="#kh%E1%BB%9Fi-t%E1%BA%A1o-series-b%E1%BA%B1ng-dictionary" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>pd.Series({<span class="st">&quot;b&quot;</span>: <span class="dv">1</span>, <span class="st">&quot;a&quot;</span>:<span class="dv">0</span>, <span class="st">&quot;c&quot;</span>: <span class="dv">2</span>})</span></code></pre></div>
<pre class="python_output"><code>b    1
a    0
c    2
dtype: int64
</code></pre>

<div class="rmdnote">
<strong><em>Lưu ý</em>:</strong>
Trong trường hợp bạn truyền biến <code>index</code> vào, <code>Series</code> sẽ đánh index dựa vào thứ tự trong <code>index</code>, và chỉ chứa các giá trị của dict có key nằm trong <code>index</code>.
Với các giá trị trong biến <code>index</code> không có trong keys của dict, <code>Series</code> sẽ tạo ra các giá trị bị thiếu <code>NaN</code>.
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>pd.Series({<span class="st">&quot;a&quot;</span>: <span class="dv">0</span>, <span class="st">&quot;b&quot;</span>: <span class="dv">1</span>, <span class="st">&quot;c&quot;</span>: <span class="dv">2</span>, <span class="st">&quot;e&quot;</span>: <span class="dv">4</span>}, index<span class="op">=</span>[<span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;a&quot;</span>])</span></code></pre></div>
<pre class="python_output"><code>b    1.0
c    2.0
d    NaN
a    0.0
dtype: float64</code></pre>

<div class="rmdnote">
<p><strong><em>Lưu ý</em>:</strong>
<code>NaN</code> là giá trị mặc định cho dữ liệu bị thiếu trong pandas và giá trị này có kiểu
là <code>float64</code> nên kiểu dữ liệu của <code>Series</code> cũng là <code>float64</code> khác với <code>int64</code> ở ví dụ trước đó.</p>
</div>
</div>
<div id="khởi-tạo-series-bằng-một-giá-trị-duy-nhất" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Khởi tạo Series bằng một giá trị duy nhất<a href="#kh%E1%BB%9Fi-t%E1%BA%A1o-series-b%E1%BA%B1ng-m%E1%BB%99t-gi%C3%A1-tr%E1%BB%8B-duy-nh%E1%BA%A5t" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a>pd.Series(data<span class="op">=</span><span class="dv">1</span>, index<span class="op">=</span>[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>])</span></code></pre></div>
<pre class="python_output"><code>a    1
b    1
c    1
dtype: int64</code></pre>
</div>
</div>
<div id="một-số-thao-tác-cơ-bản-với-series" class="section level3 hasAnchor" number="3.1.2">
<h3 class="hasAnchor"><span class="header-section-number">3.1.2</span> Một số thao tác cơ bản với Series<a href="#m%E1%BB%99t-s%E1%BB%91-thao-t%C3%A1c-c%C6%A1-b%E1%BA%A3n-v%E1%BB%9Bi-series" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Thao tác trên <code>Series</code> cũng giống với thao tác trên <code>numpy.array</code>. Ngoài ra chúng ta còn có thể
tác với Series dựa vào index</p>
<p>Ví dụ:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>s <span class="op">=</span> pd.Series(data<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>], index<span class="op">=</span>[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;f&quot;</span>])</span></code></pre></div>
<div id="hiển-thị-toàn-bộ-giá-trị-của-series" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Hiển thị toàn bộ giá trị của Series<a href="#hi%E1%BB%83n-th%E1%BB%8B-to%C3%A0n-b%E1%BB%99-gi%C3%A1-tr%E1%BB%8B-c%E1%BB%A7a-series" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Để xem toàn bộ các giá trị của một Series, ta có thể gọi thuộc tính <code>.values</code>, kết quả sẽ trả về dạng <code>numpy.ndarray</code></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>s.values</span></code></pre></div>
<pre class="python_output"><code>array([0, 1, 2, 3, 4, 5])</code></pre>
</div>
<div id="truy-cập-một-phần-tử-trong-series" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Truy cập một phần tử trong Series<a href="#truy-c%E1%BA%ADp-m%E1%BB%99t-ph%E1%BA%A7n-t%E1%BB%AD-trong-series" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><strong>Theo indice</strong></li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>s[<span class="dv">2</span>]</span></code></pre></div>
<pre class="python_output"><code>2</code></pre>
<ul>
<li><strong>Theo index</strong></li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a>s[<span class="st">&quot;c&quot;</span>]</span></code></pre></div>
<pre class="python_output"><code>2 </code></pre>
</div>
<div id="lấy-series-con-của-một-series" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Lấy Series con của một Series<a href="#l%E1%BA%A5y-series-con-c%E1%BB%A7a-m%E1%BB%99t-series" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<ul>
<li><strong>Theo Slice indice</strong></li>
</ul>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a>s[<span class="dv">1</span>:<span class="dv">3</span>]</span></code></pre></div>
<pre class="python_output"><code>b    1
d    2
dtype: int64</code></pre>
<ul>
<li><strong>Theo Slice index</strong></li>
</ul>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a>s[<span class="st">&quot;b&quot;</span>:<span class="st">&quot;c&quot;</span>]</span></code></pre></div>
<pre class="python_output"><code>b    1
c    2
dtype: int64</code></pre>
<ul>
<li><strong>Theo List indice</strong></li>
</ul>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a>s[[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>]]</span></code></pre></div>
<pre class="python_output"><code>b    1
c    2
e    4
dtype: int64</code></pre>
<ul>
<li><strong>Theo List index</strong></li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>s[[<span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;e&quot;</span>]]</span></code></pre></div>
<pre class="python_output"><code>b    1
c    2
e    4
dtype: int64</code></pre>
<ul>
<li><strong>Theo Điều kiện</strong></li>
</ul>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a>s[s <span class="op">&gt;</span> s.mean()]</span></code></pre></div>
<pre class="python_output"><code>d    3
e    4
f    5
dtype: int64</code></pre>
<!--chapter:end:posts/01-DataStructure/01-Series.Rmd-->
</div>
</div>
</div>
<div id="cach-khoi-tao-data-frame" class="section level2 hasAnchor" number="3.2">
<h2 class="hasAnchor"><span class="header-section-number">3.2</span> DataFrame<a href="#cach-khoi-tao-data-frame" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>DataFrame</code> là cấu trúc dữ liệu chính và cũng là đặc trưng của pandas. Cũng giống như SQL Table,
<code>DataFrame</code> là một bảng gồm một hay nhiều cột dữ liệu. Hoặc có thể nói rõ hơn là DataFrame là tập
hợp các Series lại với nhau.</p>
<p>Cách khởi tạo DataFrame như sau</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data<span class="op">=</span><span class="va">None</span>, index<span class="op">=</span><span class="va">None</span>, columns<span class="op">=</span><span class="va">None</span>, dtype<span class="op">=</span><span class="va">None</span>, copy<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<p>Cũng giống như Series, <code>data</code> của DataFrame có nhiều cách khởi tạo khác nhau như:</p>
<ul>
<li><code>dict</code> của Series, <code>dict</code> của <code>numpy.array</code>/<code>List</code></li>
<li>Mảng 2 chiều <code>numpy.ndarray</code>, <code>List</code> của <code>List</code></li>
<li><a href="https://numpy.org/doc/stable/user/basics.rec.html">Mảng có cấu trúc</a></li>
<li>Từ 1 <code>Series</code></li>
<li>Từ <code>DataFrame</code> khác</li>
</ul>
<p>Tùy vào cấu trúc của <code>data</code> mà chúng ta có thể bỏ qua biến <code>index</code>. Biến <code>columns</code> thể hiện tên
của các <code>Series</code>. <code>dtype</code> sẽ định nghĩa các kiểu dữ liệu của dữ liệu, chúng ta sẽ thảo luận về nó
ở phần kế tiếp của chương này. <code>copy</code> dùng để tạo bản sao từ dữ liệu <code>data</code>, nó chỉ ảnh hưởng khi
<code>data</code> là DataFrame khác hoặc numpy.ndarray, việc copy này sẽ tránh trường hợp 2 biến cùng trỏ về
cùng 1 bộ nhớ.</p>
<div id="các-cách-khởi-tạo-1" class="section level3 hasAnchor" number="3.2.1">
<h3 class="hasAnchor"><span class="header-section-number">3.2.1</span> Các cách khởi tạo<a href="#c%C3%A1c-c%C3%A1ch-kh%E1%BB%9Fi-t%E1%BA%A1o-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Khởi tạo DataFrame từ dict của Series</strong></p>
<p>Khi không truyền biến <code>index</code> vào, thì index của <code>DataFrame</code> sẽ là hợp giữa 2 index của <code>Series</code> và
chúng sẽ được sắp xếp theo thứ tự từ vựng. Nếu ta không truyền <code>columns</code> thì các cột của <code>DataFrame</code> sẽ
được sắp xếp theo thứ tự truyền vào các keys của dict.</p>
<p>Khi truyền biến <code>index</code> vào, tương tự như Series, chỉ những index nằm trong <code>index</code> mới được chọn, còn
những index bị thiếu sẽ được điền giá trị <code>NaN</code></p>
<p>Khi truyền giá trị <code>columns</code>, DataFrame sẽ chọn những <code>Series</code> thuộc dict có key thuộc <code>columns</code>, giá trị
trong <code>columns</code> không có trong key của dict sẽ được gán <code>NaN</code></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>d <span class="op">=</span> {</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>            <span class="st">&quot;one&quot;</span>: pd.Series([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], index<span class="op">=</span>[<span class="st">&quot;c&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>]),</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>            <span class="st">&quot;two&quot;</span>: pd.Series([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>], index<span class="op">=</span>[<span class="st">&quot;c&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;d&quot;</span>])</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>        }</span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>pd.DataFrame(d)</span></code></pre></div>
<pre class="python_output"><code>   one  two
a  3.0    2
b  2.0    3
c  1.0    1
d  NaN    4</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a>pd.DataFrame(d, index<span class="op">=</span>[<span class="st">&quot;d&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>])</span></code></pre></div>
<pre class="python_output"><code>   one  two
d  NaN    4
b  2.0    3
a  3.0    2</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a>pd.DataFrame(d, index<span class="op">=</span>[<span class="st">&quot;d&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>], columns<span class="op">=</span>[<span class="st">&quot;two&quot;</span>, <span class="st">&quot;three&quot;</span>])</span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>   two  three</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>d    <span class="dv">4</span>    NaN</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>b    <span class="dv">3</span>    NaN</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>a    <span class="dv">2</span>    NaN</span></code></pre></div>
<p><strong>Khởi tạo DataFrame từ dict của numpy.ndarray/List</strong></p>
<p>Đối với việc khởi tạo này, bắt buộc các mảng phải có cùng độ dài. Khi không truyền <code>index</code> vào thì
index của DataFrame sẽ được tạo từ <code>0</code> đến <code>len(n) - 1</code> trong đó <code>n</code> là độ dài của mảng. Khi truyền
giá trị <code>columns</code>, DataFrame sẽ chọn những key thuộc dict và cũng thuộc <code>columns</code>, giá trị trong
<code>columns</code> không có trong key của dict sẽ được gán <code>NaN</code></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a>d <span class="op">=</span> {</span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a>            <span class="st">&quot;one&quot;</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>],</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>            <span class="st">&quot;two&quot;</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>],</span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>            <span class="st">&quot;three&quot;</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]</span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>        }</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>pd.DataFrame(data<span class="op">=</span>d,</span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>                     index<span class="op">=</span>[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>],</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a>                     columns<span class="op">=</span>[<span class="st">&quot;one&quot;</span>, <span class="st">&quot;two&quot;</span>, <span class="st">&quot;four&quot;</span>])</span></code></pre></div>
<pre class="python_output"><code>   one  two four
a    1    1   NaN
b    2    2   NaN
c    3    3   NaN
d    4    4   NaN</code></pre>
<p><strong>Khởi tạo DataFrame từ Mảng 2 chiều/ 2-d numpy.ndarray</strong></p>
<p>Khi không truyền <code>index</code> vào thì index của <code>DataFrame</code> sẽ được tạo từ <code>0</code> đến <code>len(n) - 1</code> trong đó <code>n</code>
là số lượng List con hoặc là số dòng hay <code>shape[0]</code> của <code>numpy.ndarray</code>. Khi không truyền <code>columns</code>
thì tên columns sẽ được tạo từ <code>0</code> đến <code>len(n) - 1</code> với <code>n</code> là độ dài lớn nhất của List con hoặc <code>shape[1]</code>
của <code>numpy.ndarray</code></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a>pd.DataFrame(data<span class="op">=</span>[[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]], </span>
<span id="cb36-2"><a href="#cb36-2" tabindex="-1"></a>                     index<span class="op">=</span>[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>], </span>
<span id="cb36-3"><a href="#cb36-3" tabindex="-1"></a>                     columns<span class="op">=</span>[<span class="st">&#39;one&#39;</span>,<span class="st">&#39;two&#39;</span>,<span class="st">&#39;three&#39;</span>])</span></code></pre></div>
<pre class="python_output"><code>   one  two  three
a    1    2    NaN
b    3    4    5.0</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a>pd.DataFrame(data<span class="op">=</span>np.random.rand(<span class="dv">2</span>,<span class="dv">3</span>), </span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>                     index<span class="op">=</span>[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>], </span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>                     columns<span class="op">=</span>[<span class="st">&#39;one&#39;</span>,<span class="st">&#39;two&#39;</span>,<span class="st">&#39;three&#39;</span>]))</span></code></pre></div>
<pre class="python_output"><code>        one       two     three
a  0.662008  0.085735  0.331281
b  0.115360  0.358092  0.862477</code></pre>
<p><strong>Khởi tạo DataFrame từ danh sách các dict</strong></p>
<p>Ở cách khởi tạo này, bạn hãy tưởng tượng rằng mỗi dict là một dòng của DataFrame với các key là tên
cột và value là giá trị tại cột đó. Việc truyền thêm hoặc không truyền <code>index</code> cũng giống
như các trường hợp khởi tạo trên.</p>

<div class="rmdnote">
<strong><em>Lưu ý:</em></strong> Trong trường hợp này, nếu bạn truyền <code>columns</code> vào thì <code>columns</code> bắt buộc phải chứa tất cả
các key của dict
</div>
<p>Trong ví dụ dưới đây, <code>columns</code> phải chứa toàn bộ keys <code>["one", "two", "three"]</code>, nếu thiếu 1 trong 3
sẽ phát sinh lỗi.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>d <span class="op">=</span> [{<span class="st">&quot;one&quot;</span>: <span class="dv">1</span>, <span class="st">&quot;two&quot;</span>: <span class="dv">2</span>}, {<span class="st">&quot;one&quot;</span>: <span class="dv">4</span>, <span class="st">&quot;two&quot;</span>: <span class="dv">5</span>, <span class="st">&quot;three&quot;</span>: <span class="dv">6</span>}]</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>pd.DataFrame(d, index<span class="op">=</span>[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>], columns<span class="op">=</span>[<span class="st">&quot;one&quot;</span>, <span class="st">&quot;two&quot;</span>, <span class="st">&quot;three&quot;</span>, <span class="st">&quot;four&quot;</span>])</span></code></pre></div>
<pre class="python_output"><code>   one  two  three  four
a    1    2    NaN   NaN
b    4    5    6.0   NaN</code></pre>
<p><strong>Khởi tạo DataFrame từ Mảng có cấu trúc</strong></p>
<p>Mảng có cấu trúc là mảng mà các phần tử của nó là một cấu trúc, bao gồm các thành phần nhỏ hơn, các thành phần này được đặt tên và khai báo kiểu dữ liệu.
Dưới đây là một ví dụ Mảng có cấu trúc trong numpy</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a>data <span class="op">=</span> np.array([(<span class="st">&#39;pikachu&#39;</span>, <span class="dv">9</span>, <span class="fl">27.0</span>), (<span class="st">&#39;mewtwo&#39;</span>, <span class="dv">3</span>, <span class="fl">81.0</span>)],</span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a>                        dtype<span class="op">=</span>[(<span class="st">&#39;name&#39;</span>, <span class="st">&#39;U10&#39;</span>), (<span class="st">&#39;age&#39;</span>, <span class="st">&#39;i4&#39;</span>), (<span class="st">&#39;weight&#39;</span>, <span class="st">&#39;f4&#39;</span>)])</span>
<span id="cb42-3"><a href="#cb42-3" tabindex="-1"></a>pd.DataFrame(data)</span></code></pre></div>
<pre class="python_output"><code>       name  age  weight
0   pikachu    9    27.0
1    mewtwo    3    81.0</code></pre>
<p><strong>Khởi tạo DataFrame từ namedtuple</strong></p>
<p>Các trường trong <code>nametuple</code> sẽ được gán thành tên các columns trong <code>DataFrame</code>. Những giá trị của <code>namedtuple</code> sẽ được xem là 1 dòng trong <code>DataFrame</code>.
Số lượng cột của <code>DataFrame</code> sẽ phụ thuộc vào số lượng giá trị của phần từ <code>namedtuple</code> đầu tiên. Nếu các phần tử phía sau có số lượng giá trị ít hơn thì
sẽ được điền <code>NaN</code> và ngược lại sẽ trả ra lỗi nếu số lượng giá trị của <code>namedtuple</code> lớn hơn số lượng giá trị của phần tử <code>namedtuple</code> đầu tiên.</p>
<p>Ví dụ về cách tạo namedtuple</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> namedtuple</span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>Point2D <span class="op">=</span> namedtuple(<span class="st">&quot;Point2D&quot;</span>, <span class="st">&quot;x y&quot;</span>)</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>Point3D <span class="op">=</span> namedtuple(<span class="st">&quot;Point3D&quot;</span>, <span class="st">&quot;x y z&quot;</span>)</span></code></pre></div>
<p>Tạo DataFrame từ namedtuple <code>Point2D</code></p>
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a>pd.DataFrame([Point2D(<span class="dv">0</span>, <span class="dv">0</span>), Point2D(<span class="dv">0</span>, <span class="dv">1</span>), Point2D(<span class="dv">0</span>, <span class="dv">2</span>)])</span></code></pre></div>
<pre class="python_output"><code>   x  y
0  0  0
1  0  1
2  0  2</code></pre>
<p>Tạo DataFrame từ namedtuple cả <code>Point2D</code> và <code>Point3D</code></p>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a>pd.DataFrame([Point3D(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), Point2D(<span class="dv">0</span>, <span class="dv">1</span>), Point3D(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">3</span>)])</span></code></pre></div>
<pre class="python_output"><code>   x  y    z
0  0  0  0.0
1  0  1  NaN
2  0  2  3.0</code></pre>
<p>Như ta thấy, tại phần tử thứ 2 chỉ có 2 giá trị, trong khi phần tử thứ nhất có 3 giá trị, vậy nên phần tử bị thiếu tại cột <code>z</code> sẽ được gán <code>NaN</code></p>
<p><strong>Khởi tạo DataFrame từ Series</strong></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a>s <span class="op">=</span> pd.Series(data<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>], index<span class="op">=</span>[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>], name<span class="op">=</span><span class="st">&quot;meow&quot;</span>)</span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>pd.DataFrame(s)</span></code></pre></div>
<pre class="python_output"><code>   meow
a     0
b     1
c     2</code></pre>
<p><code>name</code> của Series sẽ là tên cột của DataFrame và <code>index</code> của Series sẽ là index của DataFrame nếu ta không truyền các biến <code>index</code>, <code>columns</code> khi khởi tạo <code>pd.DataFrame</code></p>
</div>
<div id="các-hàm-khởi-tạo-thay-thế" class="section level3 hasAnchor" number="3.2.2">
<h3 class="hasAnchor"><span class="header-section-number">3.2.2</span> Các hàm khởi tạo thay thế<a href="#c%C3%A1c-h%C3%A0m-kh%E1%BB%9Fi-t%E1%BA%A1o-thay-th%E1%BA%BF" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>DataFrame.from_dict</strong></p>
<p>Cách khởi tạo</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a>pd.DataFrame.from_dict(data, orient<span class="op">=</span><span class="st">&#39;columns&#39;</span>, dtype<span class="op">=</span><span class="va">None</span>, columns<span class="op">=</span><span class="va">None</span>)</span></code></pre></div>
<p><code>data</code> truyền vào là 1 dict, <code>orient</code> có 2 giá trị có thể đưa vào là <code>{"columns", "index"}</code>, <code>columns</code> là danh sách tên các cột của DataFrame.</p>

<div class="rmdnote">
<strong><em>Lưu ý:</em></strong> Chỉ được truyền <code>columns</code> khi <code>orient="index"</code>. Khi <code>orient="columns"</code> sẽ báo lỗi.
</div>
<p>Ví dụ tạo DataFrame khi <code>orient="columns"</code>. Với cách khởi tạo này tên các cột của DataFrame sẽ là key của dict</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">&quot;col_1&quot;</span>: [<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>], <span class="st">&quot;col_2&quot;</span>: [<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>]}</span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>pd.DataFrame.from_dict(data)</span></code></pre></div>
<pre class="python_output"><code>   col_1 col_2
0      3     a
1      2     b
2      1     c
3      0     d</code></pre>
<p>Ví dụ tạo DataFrame khi <code>orient="index"</code>. Với cách khởi tạo này index của DataFrame sẽ là key của dict.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">&quot;col_1&quot;</span>: [<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>], <span class="st">&quot;col_2&quot;</span>: [<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>]}</span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>pd.DataFrame.from_dict(data, orient<span class="op">=</span><span class="st">&quot;index&quot;</span>, </span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>                               columns<span class="op">=</span>[<span class="st">&quot;one&quot;</span>, <span class="st">&quot;two&quot;</span>, <span class="st">&quot;three&quot;</span>, <span class="st">&quot;four&quot;</span>])</span></code></pre></div>
<pre class="python_output"><code>   col_1 col_2
0      3     a
1      2     b
2      1     c
3      0     d</code></pre>
<p><strong>DataFrame.from_records</strong></p>
<p>Cách khởi tạo</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a>pd.DataFrame.from_records(data)</span></code></pre></div>
<p><code>data</code> truyền vào có thể là một mảng có cấu trúc</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a>data <span class="op">=</span> np.array([(<span class="st">&#39;Rex&#39;</span>, <span class="dv">9</span>, <span class="fl">81.0</span>), (<span class="st">&#39;Fido&#39;</span>, <span class="dv">3</span>, <span class="fl">27.0</span>)],</span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a>                        dtype<span class="op">=</span>[(<span class="st">&#39;name&#39;</span>, <span class="st">&#39;U10&#39;</span>), (<span class="st">&#39;age&#39;</span>, <span class="st">&#39;i4&#39;</span>), (<span class="st">&#39;weight&#39;</span>, <span class="st">&#39;f4&#39;</span>)])</span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>pd.DataFrame.from_records(data, index<span class="op">=</span>[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>])</span></code></pre></div>
<pre class="python_output"><code>   name  age  weight
a   Rex    9    81.0
b  Fido    3    27.0</code></pre>
<p>Dữ liệu có thể một danh sách các namedtuple</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> namedtuple</span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a>Point2D <span class="op">=</span> namedtuple(<span class="st">&quot;Point2D&quot;</span>, <span class="st">&quot;x y&quot;</span>)</span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a>Point3D <span class="op">=</span> namedtuple(<span class="st">&quot;Point3D&quot;</span>, <span class="st">&quot;x y z&quot;</span>)</span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a>pd.DataFrame.from_records([Point3D(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), Point2D(<span class="dv">0</span>, <span class="dv">1</span>), Point3D(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">3</span>)],</span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a>                          columns<span class="op">=</span>[<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>], index<span class="op">=</span>[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>])</span></code></pre></div>
<pre class="python_output"><code>   x  y    z
a  0  0  0.0
b  0  1  NaN
c  0  2  3.0</code></pre>
<p>Hoặc 1 danh sách các dict</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a>d <span class="op">=</span> [{<span class="st">&quot;one&quot;</span>: <span class="dv">1</span>, <span class="st">&quot;two&quot;</span>: <span class="dv">2</span>}, {<span class="st">&quot;one&quot;</span>: <span class="dv">4</span>, <span class="st">&quot;two&quot;</span>: <span class="dv">5</span>, <span class="st">&quot;three&quot;</span>: <span class="dv">6</span>}]</span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>pd.DataFrame.from_records(d, index<span class="op">=</span>[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>], columns<span class="op">=</span>[<span class="st">&quot;one&quot;</span>, <span class="st">&quot;two&quot;</span>, <span class="st">&quot;three&quot;</span>, <span class="st">&quot;four&quot;</span>])</span></code></pre></div>
<pre class="python_output"><code>   one  two  three  four
a    1    2    NaN   NaN
b    4    5    6.0   NaN</code></pre>
<!--chapter:end:posts/01-DataStructure/02-DataFrame.Rmd-->
</div>
</div>
<div id="data-type-trong-pandas" class="section level2 hasAnchor" number="3.3">
<h2 class="hasAnchor"><span class="header-section-number">3.3</span> Data type trong pandas<a href="#data-type-trong-pandas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Để kiểm tra kiểu dữ liệu của <code>Series</code> hay <code>DataFrame</code> bạn có thể gọi thuộc tính <code>dtypes</code> hoặc phương thức <code>.info()</code>.
Các kiểu dữ liệu thường gặp của Pandas được mô tả theo bảng dưới đây:</p>
<table style="width:79%;">
<colgroup>
<col width="33%" />
<col width="25%" />
<col width="20%" />
</colgroup>
<thead>
<tr>
<th align="left">Các kiểu dữ liệu
phổ biến</th>
<th align="left">Numpy/Pandas
object</th>
<th align="left">Hiển thị</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Boolean</td>
<td align="left">np.bool</td>
<td align="left"><em>bool</em></td>
</tr>
<tr>
<td align="left">Integer</td>
<td align="left">np.int,
np.uint</td>
<td align="left"><em>int</em>
<em>uint</em></td>
</tr>
<tr>
<td align="left">Float</td>
<td align="left">np.float</td>
<td align="left"><em>float</em></td>
</tr>
<tr>
<td align="left">Object</td>
<td align="left">np.object</td>
<td align="left"><em>O, object</em></td>
</tr>
<tr>
<td align="left">Datetime</td>
<td align="left">np.datetime64,
pd.Timestamp</td>
<td align="left"><em>datetime64</em></td>
</tr>
<tr>
<td align="left">Timedelta</td>
<td align="left">np.timedelta64,
pd.Timedelta</td>
<td align="left"><em>timedelta64</em></td>
</tr>
<tr>
<td align="left">Category</td>
<td align="left">pd.Categorical</td>
<td align="left"><em>category</em></td>
</tr>
<tr>
<td align="left">Complex</td>
<td align="left">np.complex</td>
<td align="left"><em>complex</em></td>
</tr>
</tbody>
</table>
<p>Ví dụ:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>                   <span class="st">&#39;col_1&#39;</span>: [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>], </span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>                   <span class="st">&#39;col_2&#39;</span>: [<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">3.0</span>, <span class="fl">4.0</span>], </span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>                   <span class="st">&#39;col_3&#39;</span>: [<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;3&#39;</span>, <span class="st">&#39;4&#39;</span>],</span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>                   <span class="st">&#39;col_4&#39;</span>: [<span class="st">&#39;1&#39;</span>, <span class="dv">2</span>, <span class="st">&#39;3&#39;</span>, <span class="dv">4</span>],</span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a>                   <span class="st">&#39;col_5&#39;</span>: [<span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>, <span class="va">False</span>],</span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a>                   <span class="st">&#39;col_6&#39;</span>: [<span class="st">&#39;2021-06-01&#39;</span>, <span class="st">&#39;2021-06-02&#39;</span>, <span class="st">&#39;2021-06-03&#39;</span>, <span class="st">&#39;2021-06-04&#39;</span>]})</span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a>df</span></code></pre></div>
<pre class="python_output"><code>   col_1  col_2 col_3 col_4  col_5       col_6
0      1    1.0     1     1   True  2021-06-01
1      0    2.0     2     2  False  2021-06-02
2      1    3.0     3     3   True  2021-06-03
3      0    4.0     4     4  False  2021-06-04</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" tabindex="-1"></a>df.dtypes</span></code></pre></div>
<pre class="python_output"><code>col_1      int64
col_2    float64
col_3     object
col_4     object
col_5       bool
col_6     object
dtype: object</code></pre>

<div class="rmdnote">
<p><strong><em>Lưu ý:</em></strong></p>
<ul>
<li><p>Nếu không khai báo kiểu dữ liệu khi khởi tạo, pandas sẽ mặc định kiểu dữ liệu là <code>int64</code>, <code>float64</code>, <code>object</code> và <code>bool</code>.
Pandas sẽ không biết kiểu dữ liệu <code>timestamp</code> nếu không khai báo.</p></li>
<li><p>Chỉ có thể khai báo duy nhất 1 kiểu dữ liệu khi <a href="#cach-khoi-tao-data-frame">khởi tạo pandas</a>.
Ví dụ như tất cả dữ liệu của bạn là <code>int</code> hoặc có thể được ép kiểu về <code>int</code>thì có thể khai báo <code>dtype=np.int</code></p>
</div></li>
</ul>
<p>Ở ví dụ phía dưới <code>col_1</code>, <code>col_2</code>, <code>col_3</code>, <code>col_4</code>, <code>col_5</code> có thể ép về kiểu <code>int</code>, còn <code>col_6</code> thì không thể ép kiểu được.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a>                   <span class="st">&#39;col_1&#39;</span>: [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>], </span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a>                   <span class="st">&#39;col_2&#39;</span>: [<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">3.0</span>, <span class="fl">4.0</span>], </span>
<span id="cb67-4"><a href="#cb67-4" tabindex="-1"></a>                   <span class="st">&#39;col_3&#39;</span>: [<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;3&#39;</span>, <span class="st">&#39;4&#39;</span>],</span>
<span id="cb67-5"><a href="#cb67-5" tabindex="-1"></a>                   <span class="st">&#39;col_4&#39;</span>: [<span class="st">&#39;1&#39;</span>, <span class="dv">2</span>, <span class="st">&#39;3&#39;</span>, <span class="dv">4</span>],</span>
<span id="cb67-6"><a href="#cb67-6" tabindex="-1"></a>                   <span class="st">&#39;col_5&#39;</span>: [<span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>, <span class="va">False</span>],</span>
<span id="cb67-7"><a href="#cb67-7" tabindex="-1"></a>                   <span class="st">&#39;col_6&#39;</span>: [<span class="st">&#39;2021-06-01&#39;</span>, <span class="st">&#39;2021-06-02&#39;</span>, <span class="st">&#39;2021-06-03&#39;</span>, <span class="st">&#39;2021-06-04&#39;</span>]},</span>
<span id="cb67-8"><a href="#cb67-8" tabindex="-1"></a>                   dtype<span class="op">=</span>np.<span class="bu">int</span>)</span>
<span id="cb67-9"><a href="#cb67-9" tabindex="-1"></a>df</span></code></pre></div>
<pre class="python_output"><code>   col_1  col_2  col_3  col_4  col_5       col_6
0      1      1      1      1      1  2021-06-01
1      0      2      2      2      0  2021-06-02
2      1      3      3      3      1  2021-06-03
3      0      4      4      4      0  2021-06-04</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" tabindex="-1"></a>df.dtypes</span></code></pre></div>
<pre class="python_output"><code>col_1     int64
col_2     int64
col_3    object
col_4     int64
col_5     int64
col_6     int64
dtype: object</code></pre>

<div class="rmdtip">
<p><strong><em>Mẹo:</em></strong>
Nếu dữ liệu có khoảng nhỏ thì thay vì khai báo kiểu <code>np.int</code>, ta có thể khai báo kiểu <code>integer</code> với số byte phù hợp để giảm bộ nhớ lưu trữ.
Để xem bộ nhớ sử dụng của DataFrame, ta có thể dùng <code>.memory_usage()</code>.</p>
Một số kiểu integer trong numpy như <code>np.int8</code>, <code>np.int16</code>, <code>np.int32</code>, <code>np.int64</code>, <code>np.uint8</code>, <code>np.uint16</code>, <code>np.uint32</code>, <code>np.uint64</code>
</div>
<p>Theo ví dụ trên, khi <code>dtype=np.int</code></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a> df.memory_usage()</span></code></pre></div>
<pre class="python_output"><code>Index    128
col_1     32
col_2     32
col_3     32
col_4     32
col_5     32
col_6     32
dtype: int64</code></pre>
<p>và sau khi thay bằng <code>dtype=np.int8</code></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a> df.memory_usage()</span></code></pre></div>
<pre class="python_output"><code>Index    128
col_1      4
col_2      4
col_3      4
col_4      4
col_5      4
col_6     32
dtype: int64</code></pre>
<p>Phương thức ép kiểu này được áp dụng khi bạn khởi tạo DataFrame, ngoài ra còn có hàm ép kiểu khác đối với DataFrame cho trước, nội dung này sẽ được đề cập ở <a href="#Chuong-3">Chương 3</a>.</p>
<!--chapter:end:posts/01-DataStructure/03-Datatype.Rmd-->
<div id="cấu-trúc-và-kiểu-dữ-liệu-1" class="section level1 hasAnchor" number="4">
<h1 class="hasAnchor"><span class="header-section-number">4</span> Cấu trúc và kiểu dữ liệu<a href="#c%E1%BA%A5u-tr%C3%BAc-v%C3%A0-ki%E1%BB%83u-d%E1%BB%AF-li%E1%BB%87u-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Mục tiêu của chương này nhằm giới thiệu về các cấu trúc cơ bản trong Pandas là <code>Series</code> và <code>DataFrame</code>.
Trong chương này, bạn sẽ học cách khởi tạo các cấu trúc này cũng như một số thao tác cơ bản trên <code>Series</code>.
Bạn cũng sẽ được biết về một số kiểu dữ liệu thường gặp trong pandas và cách để giảm thiểu bộ nhớ sử dụng khi khởi tạo dữ liệu.</p>
<div id="series-1" class="section level2 hasAnchor" number="4.1">
<h2 class="hasAnchor"><span class="header-section-number">4.1</span> Series<a href="#series-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Trong Pandas, <code>Series</code> là mảng 1 chiều bao gồm một danh sách giá trị, và một mảng chứa index
của các giá trị. Trong dữ liệu dảng bảng, mỗi Series được xem như là một cột của bảng đó.
Cách đơn giản để tạo Series như sau</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a>s <span class="op">=</span> pd.Series(data, index<span class="op">=</span><span class="va">None</span>, name<span class="op">=</span><span class="va">None</span>)</span></code></pre></div>
<p>Trong đó <code>data</code> có thể có dạng:</p>
<ul>
<li><p><code>numpy.ndarray</code>, <code>List</code></p></li>
<li><p>Python <code>dict</code></p></li>
<li><p><code>Scalar</code></p></li>
</ul>
<p><code>index</code> có thể truyền hoặc không, tùy vào dạng của <code>data</code> mà <code>index</code> sẽ được định nghĩa khác nhau.
<code>name</code> là tên của <code>Series</code>, giá trị này cũng không nhất thiết phải truyền vào.</p>
<div id="các-cách-khởi-tạo-2" class="section level3 hasAnchor" number="4.1.1">
<h3 class="hasAnchor"><span class="header-section-number">4.1.1</span> Các cách khởi tạo<a href="#c%C3%A1c-c%C3%A1ch-kh%E1%BB%9Fi-t%E1%BA%A1o-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Khởi tạo Series bằng array</strong></p>
<p>Khi không truyền giá trị <code>index</code>, <code>Series</code> sẽ mặc định index của nó là 1 mảng số nguyên từ <code>0</code> đến <code>len(data) - 1</code></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a>pd.Series(data<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>], index<span class="op">=</span>[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>], name<span class="op">=</span><span class="st">&quot;meow&quot;</span>)</span></code></pre></div>
<pre class="python_output"><code>a    0
b    1
c    2
Name: meow, dtype: int64</code></pre>
<p><strong>Khởi tạo Series bằng dict</strong></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a>pd.Series({<span class="st">&quot;b&quot;</span>: <span class="dv">1</span>, <span class="st">&quot;a&quot;</span>:<span class="dv">0</span>, <span class="st">&quot;c&quot;</span>: <span class="dv">2</span>})</span></code></pre></div>
<pre class="python_output"><code>b    1
a    0
c    2
dtype: int64
</code></pre>

<div class="rmdnote">
<strong><em>Lưu ý</em>:</strong>
Trong trường hợp bạn truyền biến <code>index</code> vào, <code>Series</code> sẽ đánh index dựa vào thứ tự trong <code>index</code>, và chỉ chứa các giá trị của dict có key nằm trong <code>index</code>.
Với các giá trị trong biến <code>index</code> không có trong keys của dict, <code>Series</code> sẽ tạo ra các giá trị bị thiếu <code>NaN</code>.
</div>
<div class="sourceCode" id="cb80"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a>pd.Series({<span class="st">&quot;a&quot;</span>: <span class="dv">0</span>, <span class="st">&quot;b&quot;</span>: <span class="dv">1</span>, <span class="st">&quot;c&quot;</span>: <span class="dv">2</span>, <span class="st">&quot;e&quot;</span>: <span class="dv">4</span>}, index<span class="op">=</span>[<span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;a&quot;</span>])</span></code></pre></div>
<pre class="python_output"><code>b    1.0
c    2.0
d    NaN
a    0.0
dtype: float64</code></pre>

<div class="rmdnote">
<p><strong><em>Lưu ý</em>:</strong>
<code>NaN</code> là giá trị mặc định cho dữ liệu bị thiếu trong pandas và giá trị này có kiểu
là <code>float64</code> nên kiểu dữ liệu của <code>Series</code> cũng là <code>float64</code> khác với <code>int64</code> ở ví dụ trước đó.</p>
</div>
<p><strong>Khởi tạo Series bằng một giá trị (Scalar)</strong></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a>pd.Series(data<span class="op">=</span><span class="dv">1</span>, index<span class="op">=</span>[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>])</span></code></pre></div>
<pre class="python_output"><code>a    1
b    1
c    1
dtype: int64</code></pre>
</div>
<div id="một-số-thao-tác-cơ-bản" class="section level3 hasAnchor" number="4.1.2">
<h3 class="hasAnchor"><span class="header-section-number">4.1.2</span> Một số thao tác cơ bản<a href="#m%E1%BB%99t-s%E1%BB%91-thao-t%C3%A1c-c%C6%A1-b%E1%BA%A3n" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Thao tác trên <code>Series</code> cũng giống với thao tác trên <code>numpy.array</code>. Ngoài ra chúng ta còn có thể
tác với Series dựa vào index</p>
<p>Ví dụ:</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a>s <span class="op">=</span> pd.Series(data<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>], index<span class="op">=</span>[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>, <span class="st">&quot;e&quot;</span>, <span class="st">&quot;f&quot;</span>])</span></code></pre></div>
<p><strong>Hiển thị toàn bộ giá trị của Series</strong>
Ta gọi thuộc tính <code>.values</code></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a>s.values</span></code></pre></div>
<pre class="python_output"><code>array([0, 1, 2, 3, 4, 5])</code></pre>
<p><strong>Lấy theo indice</strong></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a>s[<span class="dv">2</span>]</span></code></pre></div>
<pre class="python_output"><code>2</code></pre>
<p><strong>Lấy theo index</strong></p>
<div class="sourceCode" id="cb89"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" tabindex="-1"></a>s[<span class="st">&quot;c&quot;</span>]</span></code></pre></div>
<pre class="python_output"><code>2 </code></pre>
<p><strong>Slice indice</strong></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a>s[<span class="dv">1</span>:<span class="dv">3</span>]</span></code></pre></div>
<pre class="python_output"><code>b    1
d    2
dtype: int64</code></pre>
<p><strong>Slice index</strong></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a>s[<span class="st">&quot;b&quot;</span>:<span class="st">&quot;c&quot;</span>]</span></code></pre></div>
<pre class="python_output"><code>b    1
c    2
dtype: int64</code></pre>
<p><strong>List indice</strong></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a>s[[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>]]</span></code></pre></div>
<pre class="python_output"><code>b    1
c    2
e    4
dtype: int64</code></pre>
<p><strong>List index</strong></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a>s[[<span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;e&quot;</span>]]</span></code></pre></div>
<pre class="python_output"><code>b    1
c    2
e    4
dtype: int64</code></pre>
<p><strong>Điều kiện</strong></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a>s[s <span class="op">&gt;</span> s.mean()]</span></code></pre></div>
<pre class="python_output"><code>d    3
e    4
f    5
dtype: int64</code></pre>
</div>
</div>
<div id="cach-khoi-tao-data-frame" class="section level2 hasAnchor" number="4.2">
<h2 class="hasAnchor"><span class="header-section-number">4.2</span> DataFrame<a href="#cach-khoi-tao-data-frame" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><code>DataFrame</code> là cấu trúc dữ liệu chính và cũng là đặc trưng của pandas. Cũng giống như SQL Table,
<code>DataFrame</code> là một bảng gồm một hay nhiều cột dữ liệu. Hoặc có thể nói rõ hơn là DataFrame là tập
hợp các Series lại với nhau.</p>
<p>Cách khởi tạo DataFrame như sau</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(data<span class="op">=</span><span class="va">None</span>, index<span class="op">=</span><span class="va">None</span>, columns<span class="op">=</span><span class="va">None</span>, dtype<span class="op">=</span><span class="va">None</span>, copy<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<p>Cũng giống như Series, <code>data</code> của DataFrame có nhiều cách khởi tạo khác nhau như:</p>
<ul>
<li><code>dict</code> của Series, <code>dict</code> của <code>numpy.array</code>/<code>List</code></li>
<li>Mảng 2 chiều <code>numpy.ndarray</code>, <code>List</code> của <code>List</code></li>
<li><a href="https://numpy.org/doc/stable/user/basics.rec.html">Mảng có cấu trúc</a></li>
<li>Từ 1 <code>Series</code></li>
<li>Từ <code>DataFrame</code> khác</li>
</ul>
<p>Tùy vào cấu trúc của <code>data</code> mà chúng ta có thể bỏ qua biến <code>index</code>. Biến <code>columns</code> thể hiện tên
của các <code>Series</code>. <code>dtype</code> sẽ định nghĩa các kiểu dữ liệu của dữ liệu, chúng ta sẽ thảo luận về nó
ở phần kế tiếp của chương này. <code>copy</code> dùng để tạo bản sao từ dữ liệu <code>data</code>, nó chỉ ảnh hưởng khi
<code>data</code> là DataFrame khác hoặc numpy.ndarray, việc copy này sẽ tránh trường hợp 2 biến cùng trỏ về
cùng 1 bộ nhớ.</p>
<div id="các-cách-khởi-tạo-3" class="section level3 hasAnchor" number="4.2.1">
<h3 class="hasAnchor"><span class="header-section-number">4.2.1</span> Các cách khởi tạo<a href="#c%C3%A1c-c%C3%A1ch-kh%E1%BB%9Fi-t%E1%BA%A1o-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Khởi tạo DataFrame từ dict của Series</strong></p>
<p>Khi không truyền biến <code>index</code> vào, thì index của <code>DataFrame</code> sẽ là hợp giữa 2 index của <code>Series</code> và
chúng sẽ được sắp xếp theo thứ tự từ vựng. Nếu ta không truyền <code>columns</code> thì các cột của <code>DataFrame</code> sẽ
được sắp xếp theo thứ tự truyền vào các keys của dict.</p>
<p>Khi truyền biến <code>index</code> vào, tương tự như Series, chỉ những index nằm trong <code>index</code> mới được chọn, còn
những index bị thiếu sẽ được điền giá trị <code>NaN</code></p>
<p>Khi truyền giá trị <code>columns</code>, DataFrame sẽ chọn những <code>Series</code> thuộc dict có key thuộc <code>columns</code>, giá trị
trong <code>columns</code> không có trong key của dict sẽ được gán <code>NaN</code></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a>d <span class="op">=</span> {</span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a>            <span class="st">&quot;one&quot;</span>: pd.Series([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>], index<span class="op">=</span>[<span class="st">&quot;c&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>]),</span>
<span id="cb102-3"><a href="#cb102-3" tabindex="-1"></a>            <span class="st">&quot;two&quot;</span>: pd.Series([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>], index<span class="op">=</span>[<span class="st">&quot;c&quot;</span>, <span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;d&quot;</span>])</span>
<span id="cb102-4"><a href="#cb102-4" tabindex="-1"></a>        }</span>
<span id="cb102-5"><a href="#cb102-5" tabindex="-1"></a>pd.DataFrame(d)</span></code></pre></div>
<pre class="python_output"><code>   one  two
a  3.0    2
b  2.0    3
c  1.0    1
d  NaN    4</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a>pd.DataFrame(d, index<span class="op">=</span>[<span class="st">&quot;d&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>])</span></code></pre></div>
<pre class="python_output"><code>   one  two
d  NaN    4
b  2.0    3
a  3.0    2</code></pre>
<div class="sourceCode" id="cb106"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a>pd.DataFrame(d, index<span class="op">=</span>[<span class="st">&quot;d&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;a&quot;</span>], columns<span class="op">=</span>[<span class="st">&quot;two&quot;</span>, <span class="st">&quot;three&quot;</span>])</span></code></pre></div>
<div class="sourceCode" id="cb107"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a>   two  three</span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a>d    <span class="dv">4</span>    NaN</span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a>b    <span class="dv">3</span>    NaN</span>
<span id="cb107-4"><a href="#cb107-4" tabindex="-1"></a>a    <span class="dv">2</span>    NaN</span></code></pre></div>
<p><strong>Khởi tạo DataFrame từ dict của numpy.ndarray/List</strong></p>
<p>Đối với việc khởi tạo này, bắt buộc các mảng phải có cùng độ dài. Khi không truyền <code>index</code> vào thì
index của DataFrame sẽ được tạo từ <code>0</code> đến <code>len(n) - 1</code> trong đó <code>n</code> là độ dài của mảng. Khi truyền
giá trị <code>columns</code>, DataFrame sẽ chọn những key thuộc dict và cũng thuộc <code>columns</code>, giá trị trong
<code>columns</code> không có trong key của dict sẽ được gán <code>NaN</code></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a>d <span class="op">=</span> {</span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a>            <span class="st">&quot;one&quot;</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>],</span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a>            <span class="st">&quot;two&quot;</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>],</span>
<span id="cb108-4"><a href="#cb108-4" tabindex="-1"></a>            <span class="st">&quot;three&quot;</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]</span>
<span id="cb108-5"><a href="#cb108-5" tabindex="-1"></a>        }</span>
<span id="cb108-6"><a href="#cb108-6" tabindex="-1"></a>pd.DataFrame(data<span class="op">=</span>d,</span>
<span id="cb108-7"><a href="#cb108-7" tabindex="-1"></a>                     index<span class="op">=</span>[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>],</span>
<span id="cb108-8"><a href="#cb108-8" tabindex="-1"></a>                     columns<span class="op">=</span>[<span class="st">&quot;one&quot;</span>, <span class="st">&quot;two&quot;</span>, <span class="st">&quot;four&quot;</span>])</span></code></pre></div>
<pre class="python_output"><code>   one  two four
a    1    1   NaN
b    2    2   NaN
c    3    3   NaN
d    4    4   NaN</code></pre>
<p><strong>Khởi tạo DataFrame từ Mảng 2 chiều/ 2-d numpy.ndarray</strong></p>
<p>Khi không truyền <code>index</code> vào thì index của <code>DataFrame</code> sẽ được tạo từ <code>0</code> đến <code>len(n) - 1</code> trong đó <code>n</code>
là số lượng List con hoặc là số dòng hay <code>shape[0]</code> của <code>numpy.ndarray</code>. Khi không truyền <code>columns</code>
thì tên columns sẽ được tạo từ <code>0</code> đến <code>len(n) - 1</code> với <code>n</code> là độ dài lớn nhất của List con hoặc <code>shape[1]</code>
của <code>numpy.ndarray</code></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a>pd.DataFrame(data<span class="op">=</span>[[<span class="dv">1</span>, <span class="dv">2</span>], [<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]], </span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a>                     index<span class="op">=</span>[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>], </span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a>                     columns<span class="op">=</span>[<span class="st">&#39;one&#39;</span>,<span class="st">&#39;two&#39;</span>,<span class="st">&#39;three&#39;</span>])</span></code></pre></div>
<pre class="python_output"><code>   one  two  three
a    1    2    NaN
b    3    4    5.0</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a>pd.DataFrame(data<span class="op">=</span>np.random.rand(<span class="dv">2</span>,<span class="dv">3</span>), </span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a>                     index<span class="op">=</span>[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>], </span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a>                     columns<span class="op">=</span>[<span class="st">&#39;one&#39;</span>,<span class="st">&#39;two&#39;</span>,<span class="st">&#39;three&#39;</span>]))</span></code></pre></div>
<pre class="python_output"><code>        one       two     three
a  0.662008  0.085735  0.331281
b  0.115360  0.358092  0.862477</code></pre>
<p><strong>Khởi tạo DataFrame từ danh sách các dict</strong></p>
<p>Ở cách khởi tạo này, bạn hãy tưởng tượng rằng mỗi dict là một dòng của DataFrame với các key là tên
cột và value là giá trị tại cột đó. Việc truyền thêm hoặc không truyền <code>index</code> cũng giống
như các trường hợp khởi tạo trên.</p>

<div class="rmdnote">
<strong><em>Lưu ý:</em></strong> Trong trường hợp này, nếu bạn truyền <code>columns</code> vào thì <code>columns</code> bắt buộc phải chứa tất cả
các key của dict
</div>
<p>Trong ví dụ dưới đây, <code>columns</code> phải chứa toàn bộ keys <code>["one", "two", "three"]</code>, nếu thiếu 1 trong 3
sẽ phát sinh lỗi.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a>d <span class="op">=</span> [{<span class="st">&quot;one&quot;</span>: <span class="dv">1</span>, <span class="st">&quot;two&quot;</span>: <span class="dv">2</span>}, {<span class="st">&quot;one&quot;</span>: <span class="dv">4</span>, <span class="st">&quot;two&quot;</span>: <span class="dv">5</span>, <span class="st">&quot;three&quot;</span>: <span class="dv">6</span>}]</span>
<span id="cb114-2"><a href="#cb114-2" tabindex="-1"></a>pd.DataFrame(d, index<span class="op">=</span>[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>], columns<span class="op">=</span>[<span class="st">&quot;one&quot;</span>, <span class="st">&quot;two&quot;</span>, <span class="st">&quot;three&quot;</span>, <span class="st">&quot;four&quot;</span>])</span></code></pre></div>
<pre class="python_output"><code>   one  two  three  four
a    1    2    NaN   NaN
b    4    5    6.0   NaN</code></pre>
<p><strong>Khởi tạo DataFrame từ Mảng có cấu trúc</strong></p>
<p>Mảng có cấu trúc là mảng mà các phần tử của nó là một cấu trúc, bao gồm các thành phần nhỏ hơn, các thành phần này được đặt tên và khai báo kiểu dữ liệu.
Dưới đây là một ví dụ Mảng có cấu trúc trong numpy</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a>data <span class="op">=</span> np.array([(<span class="st">&#39;pikachu&#39;</span>, <span class="dv">9</span>, <span class="fl">27.0</span>), (<span class="st">&#39;mewtwo&#39;</span>, <span class="dv">3</span>, <span class="fl">81.0</span>)],</span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a>                        dtype<span class="op">=</span>[(<span class="st">&#39;name&#39;</span>, <span class="st">&#39;U10&#39;</span>), (<span class="st">&#39;age&#39;</span>, <span class="st">&#39;i4&#39;</span>), (<span class="st">&#39;weight&#39;</span>, <span class="st">&#39;f4&#39;</span>)])</span>
<span id="cb116-3"><a href="#cb116-3" tabindex="-1"></a>pd.DataFrame(data)</span></code></pre></div>
<pre class="python_output"><code>       name  age  weight
0   pikachu    9    27.0
1    mewtwo    3    81.0</code></pre>
<p><strong>Khởi tạo DataFrame từ namedtuple</strong></p>
<p>Các trường trong <code>nametuple</code> sẽ được gán thành tên các columns trong <code>DataFrame</code>. Những giá trị của <code>namedtuple</code> sẽ được xem là 1 dòng trong <code>DataFrame</code>.
Số lượng cột của <code>DataFrame</code> sẽ phụ thuộc vào số lượng giá trị của phần từ <code>namedtuple</code> đầu tiên. Nếu các phần tử phía sau có số lượng giá trị ít hơn thì
sẽ được điền <code>NaN</code> và ngược lại sẽ trả ra lỗi nếu số lượng giá trị của <code>namedtuple</code> lớn hơn số lượng giá trị của phần tử <code>namedtuple</code> đầu tiên.</p>
<p>Ví dụ về cách tạo namedtuple</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> namedtuple</span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a>Point2D <span class="op">=</span> namedtuple(<span class="st">&quot;Point2D&quot;</span>, <span class="st">&quot;x y&quot;</span>)</span>
<span id="cb118-3"><a href="#cb118-3" tabindex="-1"></a>Point3D <span class="op">=</span> namedtuple(<span class="st">&quot;Point3D&quot;</span>, <span class="st">&quot;x y z&quot;</span>)</span></code></pre></div>
<p>Tạo DataFrame từ namedtuple <code>Point2D</code></p>
<div class="sourceCode" id="cb119"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a>pd.DataFrame([Point2D(<span class="dv">0</span>, <span class="dv">0</span>), Point2D(<span class="dv">0</span>, <span class="dv">1</span>), Point2D(<span class="dv">0</span>, <span class="dv">2</span>)])</span></code></pre></div>
<pre class="python_output"><code>   x  y
0  0  0
1  0  1
2  0  2</code></pre>
<p>Tạo DataFrame từ namedtuple cả <code>Point2D</code> và <code>Point3D</code></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a>pd.DataFrame([Point3D(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), Point2D(<span class="dv">0</span>, <span class="dv">1</span>), Point3D(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">3</span>)])</span></code></pre></div>
<pre class="python_output"><code>   x  y    z
0  0  0  0.0
1  0  1  NaN
2  0  2  3.0</code></pre>
<p>Như ta thấy, tại phần tử thứ 2 chỉ có 2 giá trị, trong khi phần tử thứ nhất có 3 giá trị, vậy nên phần tử bị thiếu tại cột <code>z</code> sẽ được gán <code>NaN</code></p>
<p><strong>Khởi tạo DataFrame từ Series</strong></p>
<div class="sourceCode" id="cb123"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a>s <span class="op">=</span> pd.Series(data<span class="op">=</span>[<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>], index<span class="op">=</span>[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>], name<span class="op">=</span><span class="st">&quot;meow&quot;</span>)</span>
<span id="cb123-2"><a href="#cb123-2" tabindex="-1"></a>pd.DataFrame(s)</span></code></pre></div>
<pre class="python_output"><code>   meow
a     0
b     1
c     2</code></pre>
<p><code>name</code> của Series sẽ là tên cột của DataFrame và <code>index</code> của Series sẽ là index của DataFrame nếu ta không truyền các biến <code>index</code>, <code>columns</code> khi khởi tạo <code>pd.DataFrame</code></p>
</div>
<div id="các-hàm-khởi-tạo-thay-thế-1" class="section level3 hasAnchor" number="4.2.2">
<h3 class="hasAnchor"><span class="header-section-number">4.2.2</span> Các hàm khởi tạo thay thế<a href="#c%C3%A1c-h%C3%A0m-kh%E1%BB%9Fi-t%E1%BA%A1o-thay-th%E1%BA%BF-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>DataFrame.from_dict</strong></p>
<p>Cách khởi tạo</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a>pd.DataFrame.from_dict(data, orient<span class="op">=</span><span class="st">&#39;columns&#39;</span>, dtype<span class="op">=</span><span class="va">None</span>, columns<span class="op">=</span><span class="va">None</span>)</span></code></pre></div>
<p><code>data</code> truyền vào là 1 dict, <code>orient</code> có 2 giá trị có thể đưa vào là <code>{"columns", "index"}</code>, <code>columns</code> là danh sách tên các cột của DataFrame.</p>

<div class="rmdnote">
<strong><em>Lưu ý:</em></strong> Chỉ được truyền <code>columns</code> khi <code>orient="index"</code>. Khi <code>orient="columns"</code> sẽ báo lỗi.
</div>
<p>Ví dụ tạo DataFrame khi <code>orient="columns"</code>. Với cách khởi tạo này tên các cột của DataFrame sẽ là key của dict</p>
<div class="sourceCode" id="cb126"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">&quot;col_1&quot;</span>: [<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>], <span class="st">&quot;col_2&quot;</span>: [<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>]}</span>
<span id="cb126-2"><a href="#cb126-2" tabindex="-1"></a>pd.DataFrame.from_dict(data)</span></code></pre></div>
<pre class="python_output"><code>   col_1 col_2
0      3     a
1      2     b
2      1     c
3      0     d</code></pre>
<p>Ví dụ tạo DataFrame khi <code>orient="index"</code>. Với cách khởi tạo này index của DataFrame sẽ là key của dict.</p>
<div class="sourceCode" id="cb128"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a>data <span class="op">=</span> {<span class="st">&quot;col_1&quot;</span>: [<span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">0</span>], <span class="st">&quot;col_2&quot;</span>: [<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>, <span class="st">&quot;d&quot;</span>]}</span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a>pd.DataFrame.from_dict(data, orient<span class="op">=</span><span class="st">&quot;index&quot;</span>, </span>
<span id="cb128-3"><a href="#cb128-3" tabindex="-1"></a>                               columns<span class="op">=</span>[<span class="st">&quot;one&quot;</span>, <span class="st">&quot;two&quot;</span>, <span class="st">&quot;three&quot;</span>, <span class="st">&quot;four&quot;</span>])</span></code></pre></div>
<pre class="python_output"><code>   col_1 col_2
0      3     a
1      2     b
2      1     c
3      0     d</code></pre>
<p><strong>DataFrame.from_records</strong></p>
<p>Cách khởi tạo</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a>pd.DataFrame.from_records(data)</span></code></pre></div>
<p><code>data</code> truyền vào có thể là một mảng có cấu trúc</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" tabindex="-1"></a>data <span class="op">=</span> np.array([(<span class="st">&#39;Rex&#39;</span>, <span class="dv">9</span>, <span class="fl">81.0</span>), (<span class="st">&#39;Fido&#39;</span>, <span class="dv">3</span>, <span class="fl">27.0</span>)],</span>
<span id="cb131-2"><a href="#cb131-2" tabindex="-1"></a>                        dtype<span class="op">=</span>[(<span class="st">&#39;name&#39;</span>, <span class="st">&#39;U10&#39;</span>), (<span class="st">&#39;age&#39;</span>, <span class="st">&#39;i4&#39;</span>), (<span class="st">&#39;weight&#39;</span>, <span class="st">&#39;f4&#39;</span>)])</span>
<span id="cb131-3"><a href="#cb131-3" tabindex="-1"></a>pd.DataFrame.from_records(data, index<span class="op">=</span>[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>])</span></code></pre></div>
<pre class="python_output"><code>   name  age  weight
a   Rex    9    81.0
b  Fido    3    27.0</code></pre>
<p>Dữ liệu có thể một danh sách các namedtuple</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a><span class="im">from</span> collections <span class="im">import</span> namedtuple</span>
<span id="cb133-2"><a href="#cb133-2" tabindex="-1"></a>Point2D <span class="op">=</span> namedtuple(<span class="st">&quot;Point2D&quot;</span>, <span class="st">&quot;x y&quot;</span>)</span>
<span id="cb133-3"><a href="#cb133-3" tabindex="-1"></a>Point3D <span class="op">=</span> namedtuple(<span class="st">&quot;Point3D&quot;</span>, <span class="st">&quot;x y z&quot;</span>)</span>
<span id="cb133-4"><a href="#cb133-4" tabindex="-1"></a>pd.DataFrame.from_records([Point3D(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), Point2D(<span class="dv">0</span>, <span class="dv">1</span>), Point3D(<span class="dv">0</span>, <span class="dv">2</span>, <span class="dv">3</span>)],</span>
<span id="cb133-5"><a href="#cb133-5" tabindex="-1"></a>                          columns<span class="op">=</span>[<span class="st">&quot;x&quot;</span>,<span class="st">&quot;y&quot;</span>,<span class="st">&quot;z&quot;</span>], index<span class="op">=</span>[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>])</span></code></pre></div>
<pre class="python_output"><code>   x  y    z
a  0  0  0.0
b  0  1  NaN
c  0  2  3.0</code></pre>
<p>Hoặc 1 danh sách các dict</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" tabindex="-1"></a>d <span class="op">=</span> [{<span class="st">&quot;one&quot;</span>: <span class="dv">1</span>, <span class="st">&quot;two&quot;</span>: <span class="dv">2</span>}, {<span class="st">&quot;one&quot;</span>: <span class="dv">4</span>, <span class="st">&quot;two&quot;</span>: <span class="dv">5</span>, <span class="st">&quot;three&quot;</span>: <span class="dv">6</span>}]</span>
<span id="cb135-2"><a href="#cb135-2" tabindex="-1"></a>pd.DataFrame.from_records(d, index<span class="op">=</span>[<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>], columns<span class="op">=</span>[<span class="st">&quot;one&quot;</span>, <span class="st">&quot;two&quot;</span>, <span class="st">&quot;three&quot;</span>, <span class="st">&quot;four&quot;</span>])</span></code></pre></div>
<pre class="python_output"><code>   one  two  three  four
a    1    2    NaN   NaN
b    4    5    6.0   NaN</code></pre>
</div>
</div>
<div id="data-type-trong-pandas-1" class="section level2 hasAnchor" number="4.3">
<h2 class="hasAnchor"><span class="header-section-number">4.3</span> Data type trong pandas<a href="#data-type-trong-pandas-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Để kiểm tra kiểu dữ liệu của <code>Series</code> hay <code>DataFrame</code> bạn có thể gọi thuộc tính <code>dtypes</code> hoặc phương thức <code>.info()</code>.
Các kiểu dữ liệu thường gặp của Pandas được mô tả theo bảng dưới đây:</p>
<table style="width:79%;">
<colgroup>
<col width="33%" />
<col width="25%" />
<col width="20%" />
</colgroup>
<thead>
<tr>
<th align="left">Các kiểu dữ liệu
phổ biến</th>
<th align="left">Numpy/Pandas
object</th>
<th align="left">Hiển thị</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Boolean</td>
<td align="left">np.bool</td>
<td align="left"><em>bool</em></td>
</tr>
<tr>
<td align="left">Integer</td>
<td align="left">np.int,
np.uint</td>
<td align="left"><em>int</em>
<em>uint</em></td>
</tr>
<tr>
<td align="left">Float</td>
<td align="left">np.float</td>
<td align="left"><em>float</em></td>
</tr>
<tr>
<td align="left">Object</td>
<td align="left">np.object</td>
<td align="left"><em>O, object</em></td>
</tr>
<tr>
<td align="left">Datetime</td>
<td align="left">np.datetime64,
pd.Timestamp</td>
<td align="left"><em>datetime64</em></td>
</tr>
<tr>
<td align="left">Timedelta</td>
<td align="left">np.timedelta64,
pd.Timedelta</td>
<td align="left"><em>timedelta64</em></td>
</tr>
<tr>
<td align="left">Category</td>
<td align="left">pd.Categorical</td>
<td align="left"><em>category</em></td>
</tr>
<tr>
<td align="left">Complex</td>
<td align="left">np.complex</td>
<td align="left"><em>complex</em></td>
</tr>
</tbody>
</table>
<p>Ví dụ:</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb137-2"><a href="#cb137-2" tabindex="-1"></a>                   <span class="st">&#39;col_1&#39;</span>: [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>], </span>
<span id="cb137-3"><a href="#cb137-3" tabindex="-1"></a>                   <span class="st">&#39;col_2&#39;</span>: [<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">3.0</span>, <span class="fl">4.0</span>], </span>
<span id="cb137-4"><a href="#cb137-4" tabindex="-1"></a>                   <span class="st">&#39;col_3&#39;</span>: [<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;3&#39;</span>, <span class="st">&#39;4&#39;</span>],</span>
<span id="cb137-5"><a href="#cb137-5" tabindex="-1"></a>                   <span class="st">&#39;col_4&#39;</span>: [<span class="st">&#39;1&#39;</span>, <span class="dv">2</span>, <span class="st">&#39;3&#39;</span>, <span class="dv">4</span>],</span>
<span id="cb137-6"><a href="#cb137-6" tabindex="-1"></a>                   <span class="st">&#39;col_5&#39;</span>: [<span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>, <span class="va">False</span>],</span>
<span id="cb137-7"><a href="#cb137-7" tabindex="-1"></a>                   <span class="st">&#39;col_6&#39;</span>: [<span class="st">&#39;2021-06-01&#39;</span>, <span class="st">&#39;2021-06-02&#39;</span>, <span class="st">&#39;2021-06-03&#39;</span>, <span class="st">&#39;2021-06-04&#39;</span>]})</span>
<span id="cb137-8"><a href="#cb137-8" tabindex="-1"></a>df</span></code></pre></div>
<pre class="python_output"><code>   col_1  col_2 col_3 col_4  col_5       col_6
0      1    1.0     1     1   True  2021-06-01
1      0    2.0     2     2  False  2021-06-02
2      1    3.0     3     3   True  2021-06-03
3      0    4.0     4     4  False  2021-06-04</code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" tabindex="-1"></a>df.dtypes</span></code></pre></div>
<pre class="python_output"><code>col_1      int64
col_2    float64
col_3     object
col_4     object
col_5       bool
col_6     object
dtype: object</code></pre>

<div class="rmdnote">
<p><strong><em>Lưu ý:</em></strong></p>
<ul>
<li><p>Nếu không khai báo kiểu dữ liệu khi khởi tạo, pandas sẽ mặc định kiểu dữ liệu là <code>int64</code>, <code>float64</code>, <code>object</code> và <code>bool</code>.
Pandas sẽ không biết kiểu dữ liệu <code>timestamp</code> nếu không khai báo.</p></li>
<li><p>Chỉ có thể khai báo duy nhất 1 kiểu dữ liệu khi <a href="#cach-khoi-tao-data-frame">khởi tạo pandas</a>.
Ví dụ như tất cả dữ liệu của bạn là <code>int</code> hoặc có thể được ép kiểu về <code>int</code>thì có thể khai báo <code>dtype=np.int</code></p>
</div></li>
</ul>
<p>Ở ví dụ phía dưới <code>col_1</code>, <code>col_2</code>, <code>col_3</code>, <code>col_4</code>, <code>col_5</code> có thể ép về kiểu <code>int</code>, còn <code>col_6</code> thì không thể ép kiểu được.</p>
<div class="sourceCode" id="cb141"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb141-2"><a href="#cb141-2" tabindex="-1"></a>                   <span class="st">&#39;col_1&#39;</span>: [<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>], </span>
<span id="cb141-3"><a href="#cb141-3" tabindex="-1"></a>                   <span class="st">&#39;col_2&#39;</span>: [<span class="fl">1.0</span>, <span class="fl">2.0</span>, <span class="fl">3.0</span>, <span class="fl">4.0</span>], </span>
<span id="cb141-4"><a href="#cb141-4" tabindex="-1"></a>                   <span class="st">&#39;col_3&#39;</span>: [<span class="st">&#39;1&#39;</span>, <span class="st">&#39;2&#39;</span>, <span class="st">&#39;3&#39;</span>, <span class="st">&#39;4&#39;</span>],</span>
<span id="cb141-5"><a href="#cb141-5" tabindex="-1"></a>                   <span class="st">&#39;col_4&#39;</span>: [<span class="st">&#39;1&#39;</span>, <span class="dv">2</span>, <span class="st">&#39;3&#39;</span>, <span class="dv">4</span>],</span>
<span id="cb141-6"><a href="#cb141-6" tabindex="-1"></a>                   <span class="st">&#39;col_5&#39;</span>: [<span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>, <span class="va">False</span>],</span>
<span id="cb141-7"><a href="#cb141-7" tabindex="-1"></a>                   <span class="st">&#39;col_6&#39;</span>: [<span class="st">&#39;2021-06-01&#39;</span>, <span class="st">&#39;2021-06-02&#39;</span>, <span class="st">&#39;2021-06-03&#39;</span>, <span class="st">&#39;2021-06-04&#39;</span>]},</span>
<span id="cb141-8"><a href="#cb141-8" tabindex="-1"></a>                   dtype<span class="op">=</span>np.<span class="bu">int</span>)</span>
<span id="cb141-9"><a href="#cb141-9" tabindex="-1"></a>df</span></code></pre></div>
<pre class="python_output"><code>   col_1  col_2  col_3  col_4  col_5       col_6
0      1      1      1      1      1  2021-06-01
1      0      2      2      2      0  2021-06-02
2      1      3      3      3      1  2021-06-03
3      0      4      4      4      0  2021-06-04</code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" tabindex="-1"></a>df.dtypes</span></code></pre></div>
<pre class="python_output"><code>col_1     int64
col_2     int64
col_3    object
col_4     int64
col_5     int64
col_6     int64
dtype: object</code></pre>

<div class="rmdtip">
<p><strong><em>Mẹo:</em></strong>
Nếu dữ liệu có khoảng nhỏ thì thay vì khai báo kiểu <code>np.int</code>, ta có thể khai báo kiểu <code>integer</code> với số byte phù hợp để giảm bộ nhớ lưu trữ.
Để xem bộ nhớ sử dụng của DataFrame, ta có thể dùng <code>.memory_usage()</code>.</p>
Một số kiểu integer trong numpy như <code>np.int8</code>, <code>np.int16</code>, <code>np.int32</code>, <code>np.int64</code>, <code>np.uint8</code>, <code>np.uint16</code>, <code>np.uint32</code>, <code>np.uint64</code>
</div>
<p>Theo ví dụ trên, khi <code>dtype=np.int</code></p>
<div class="sourceCode" id="cb145"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" tabindex="-1"></a> df.memory_usage()</span></code></pre></div>
<pre class="python_output"><code>Index    128
col_1     32
col_2     32
col_3     32
col_4     32
col_5     32
col_6     32
dtype: int64</code></pre>
<p>và sau khi thay bằng <code>dtype=np.int8</code></p>
<div class="sourceCode" id="cb147"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" tabindex="-1"></a> df.memory_usage()</span></code></pre></div>
<pre class="python_output"><code>Index    128
col_1      4
col_2      4
col_3      4
col_4      4
col_5      4
col_6     32
dtype: int64</code></pre>
<p>Phương thức ép kiểu này được áp dụng khi bạn khởi tạo DataFrame, ngoài ra còn có hàm ép kiểu khác đối với DataFrame cho trước, nội dung này sẽ được đề cập ở <a href="#Chuong-3">Chương 3</a>.</p>
<!--chapter:end:posts/01-DataStructure_Datatype.Rmd-->
<div id="đọc-và-lưu-file-trong-pandas" class="section level1 hasAnchor" number="5">
<h1 class="hasAnchor"><span class="header-section-number">5</span> Đọc và lưu file trong Pandas<a href="#%C4%91%E1%BB%8Dc-v%C3%A0-l%C6%B0u-file-trong-pandas" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Ở Chương 1 chúng ta đã biết cách khởi tạo DataFrame từ các dữ liệu cho trước.
Trong chương này sẽ hướng dẫn cách đọc dữ liệu từ file bằng pandas, một số kiểu file thường thấy cho dữ liệu dạng bảng là <code>.csv</code> và <code>.xlsx</code>.
Bạn cũng có thể đọc dữ liệu bán cấu trúc như <code>JSON</code> bằng cách load file bằng Python sau đó dùng các cách khởi tạo như ở Chương 1 hoặc có thể dùng
hàm phụ trợ của Pandas.</p>
<p>Ở phần thứ hai của chương, bạn sẽ được hướng dẫn một số cách cấu hình cho Pandas như thay đổi số dòng, số cột hiển thị…</p>
<div id="csv-tsv" class="section level2 hasAnchor" number="5.1">
<h2 class="hasAnchor"><span class="header-section-number">5.1</span> csv, tsv<a href="#csv-tsv" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="đọc-file-csv-tsv" class="section level3 hasAnchor" number="5.1.1">
<h3 class="hasAnchor"><span class="header-section-number">5.1.1</span> Đọc file csv, tsv<a href="#%C4%91%E1%BB%8Dc-file-csv-tsv" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Chúng ta có thể đọc file csv với pandas theo lệnh sau</p>
<div class="sourceCode" id="cb149"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(filepath, sep<span class="op">=</span><span class="st">&#39;,&#39;</span>, names<span class="op">=</span>NoDefault.no_default, index_col<span class="op">=</span><span class="va">None</span>, usecols<span class="op">=</span><span class="va">None</span>, dtype<span class="op">=</span><span class="va">None</span>, skiprows<span class="op">=</span><span class="va">None</span>, skipfooter<span class="op">=</span><span class="dv">0</span>, nrows<span class="op">=</span><span class="va">None</span>)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>filepath</code> là đường dẫn đến file trong máy hoặc đường link URL</p></li>
<li><p><code>sep</code> dùng để nhận diện cách chia thành cột, nếu không truyền tham số này thì <code>pandas</code> tự hiểu là chia theo <code>','</code>, ngoài ra có thể chia theo <code>';'</code> đối với macOS và <code>'\t'</code> với file có định dạng <code>.tsv</code></p></li>
<li><p><code>names</code> là tên các cột của bảng. Nếu bảng đã có tên cột thì nên bỏ qua tham số này, <code>pandas</code> sẽ lấy dòng đầu tiên của file làm tên cột.</p></li>
<li><p><code>index_col</code> dùng để chỉ định vị trí các cột dùng để làm index cho bảng.</p></li>
<li><p><code>usecols</code> dùng để chỉ định vị trí hoặc tên các cột cần đọc.</p></li>
<li><p><code>dtype</code> dùng để định dạng kiểu dữ liệu của các cột.</p></li>
<li><p><code>skiprows</code> được dùng khi muốn bỏ qua một số dòng đầu của bảng.</p></li>
<li><p><code>skipfooter</code> tương tự như <code>skiprows</code> nhưng sẽ bỏ qua các dòng cuối cùng của bảng.</p></li>
<li><p><code>nrows</code> dùng để chỉ định số lượng dòng của bạn mà bạn sẽ đọc bằng <code>pandas</code></p></li>
</ul>
<p><strong>Ví dụ</strong></p>
<p>Đọc file dữ liệu sale được cho tại <a href="https://raw.githubusercontent.com/lhduc94/kungfupandas/master/data/sales_subset.csv">đây</a>. Giả sử ta chỉ lấy các cột <code>date</code>, <code>weekly_sales</code> và <code>is_holiday</code> và lấy cột <code>date</code> làm <code>index</code> và chỉ lấy 6 dòng đầu</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;https://raw.githubusercontent.com/lhduc94/kungfupandas/master/data/sales_subset.csv&#39;</span>, index_col<span class="op">=</span>[<span class="st">&#39;date&#39;</span>], usecols<span class="op">=</span>[<span class="st">&#39;date&#39;</span>,<span class="st">&#39;weekly_sales&#39;</span>,<span class="st">&#39;is_holiday&#39;</span>], nrows<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb150-2"><a href="#cb150-2" tabindex="-1"></a>df</span></code></pre></div>
<pre class="python_output"><code>            weekly_sales  is_holiday
date                                
2010-02-05      24924.50       False
2010-03-05      21827.90       False
2010-04-02      57258.43       False
2010-05-07      17413.94       False
2010-06-04      17558.09       False
2010-07-02      16333.14       False</code></pre>
</div>
<div id="xuất-file-csv-tsv" class="section level3 hasAnchor" number="5.1.2">
<h3 class="hasAnchor"><span class="header-section-number">5.1.2</span> Xuất file csv, tsv<a href="#xu%E1%BA%A5t-file-csv-tsv" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Để lưu <code>DataFrame</code> dưới dạng file ta có thể dùng câu lệnh <code>.to_csv()</code> theo cú pháp sau</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" tabindex="-1"></a>df.to_csv(filename, sep<span class="op">=</span><span class="st">&#39;,&#39;</span>, columns<span class="op">=</span><span class="va">None</span>, header<span class="op">=</span><span class="va">True</span>, index<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>filename</code> là địa chỉ file mà bạn muốn lưu lại</p></li>
<li><p><code>sep</code> tương tự như lúc đọc file</p></li>
<li><p><code>columns</code> là tên các cột bạn muốn lưu xuống, nếu muốn lưu tất cả các cột thì
bạn có thể bỏ qua tham số này.</p></li>
<li><p><code>header</code> mặc định là <code>True</code> nếu bạn muốn lưu tên cột</p></li>
<li><p><code>index</code> mặc định là <code>True</code> nếu bạn muốn lưu index của bảng.</p></li>
</ul>
<p>Ví dụ</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb153-1"><a href="#cb153-1" tabindex="-1"></a>df.to_csv(<span class="st">&#39;sales.csv&#39;</span>, columns<span class="op">=</span><span class="st">&#39;weekly_sales&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
</div>
</div>
<div id="excel" class="section level2 hasAnchor" number="5.2">
<h2 class="hasAnchor"><span class="header-section-number">5.2</span> Excel<a href="#excel" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="đọc-file-excel" class="section level3 hasAnchor" number="5.2.1">
<h3 class="hasAnchor"><span class="header-section-number">5.2.1</span> Đọc file Excel<a href="#%C4%91%E1%BB%8Dc-file-excel" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Để đọc file Excel ta dùng cú pháp sau</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" tabindex="-1"></a>x <span class="op">=</span> pd.ExcelFile(filename)</span></code></pre></div>
<p>Với <code>filename</code> là đường dẫn đến file</p>
<p>Để xem tên các sheets của <code>x</code> ta có thể dùng <code>x.sheet_names</code>. Sau đó để đọc từng sheet của <code>x</code> ta có thể dùng <code>.parse()</code></p>
<div class="sourceCode" id="cb155"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" tabindex="-1"></a>df <span class="op">=</span> x.parse(sheet_name, header<span class="op">=</span><span class="dv">0</span>, names<span class="op">=</span><span class="va">None</span>, index_col<span class="op">=</span><span class="va">None</span>, usecols<span class="op">=</span><span class="va">None</span>, skiprows<span class="op">=</span><span class="va">None</span>, skipfooter<span class="op">=</span><span class="dv">0</span>, nrows<span class="op">=</span><span class="va">None</span>)</span></code></pre></div>
<p>Trong đó <code>sheet_name</code> là tên sheet cần đọc, các thông số còn lại tương tự như phần đọc file <code>csv</code> và <code>tsv</code>. Một cách khác để đọc file excel là dùng hàm <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_excel.html">pandas.read_excel</a> với tham số <code>io</code> là tên file.</p>
<div id="xuất-file-excel" class="section level4 hasAnchor" number="5.2.1.1">
<h4 class="hasAnchor"><span class="header-section-number">5.2.1.1</span> Xuất file Excel<a href="#xu%E1%BA%A5t-file-excel" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Giả sử ta có các <code>DataFrame</code> df1, df2, df3 cần được lưu vào 1 file Excel duy nhất</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb156-2"><a href="#cb156-2" tabindex="-1"></a></span>
<span id="cb156-3"><a href="#cb156-3" tabindex="-1"></a>df1 <span class="op">=</span> pd.DataFrame({<span class="st">&#39;col_1&#39;</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]})</span>
<span id="cb156-4"><a href="#cb156-4" tabindex="-1"></a>df2 <span class="op">=</span> pd.DataFrame({<span class="st">&#39;col_1&#39;</span>: [<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>, <span class="st">&#39;d&#39;</span>]})</span>
<span id="cb156-5"><a href="#cb156-5" tabindex="-1"></a>df3 <span class="op">=</span> pd.DataFrame({<span class="st">&#39;col_1&#39;</span>: [<span class="va">True</span>, <span class="va">True</span>, <span class="va">False</span>, <span class="va">False</span>]})</span></code></pre></div>
<p>Để ghi các bảng vào file Excel, bước đầu tiên là khởi tạo biến <code>writer</code> theo cú pháp</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" tabindex="-1"></a>writer <span class="op">=</span> pd.ExcelWriter(<span class="st">&#39;pandas_multiple.xlsx&#39;</span>, mode<span class="op">=</span><span class="st">&#39;w&#39;</span>,  if_sheet_exists<span class="op">=</span><span class="va">None</span>, engine<span class="op">=</span><span class="va">None</span>)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>filename</code> là tên file excel</p></li>
<li><p><code>mode</code> là phương thức ghi file với <code>w</code> là viết file mới và <code>a</code> là viết thêm vào file. Mặc định là <code>w</code></p></li>
<li><p><code>if_sheet_exists</code> là phương thức ghi file nếu file hoặc sheet đã tồn tại, bao gồm các phương thức dưới đây (mặc định là error)</p>
<ul>
<li><p><code>error</code>: hiện ValueError nếu đã tồn tại sheet</p></li>
<li><p><code>new</code>: Tạo sheet mới với tên phụ thuộc vào <code>engine</code></p></li>
<li><p><code>replace</code>: Xóa nội dung của sheet trước khi viết.</p></li>
<li><p><code>overlay</code>: Viết lên sheet đã tồn tại mà không xóa các sheet cũ</p></li>
</ul></li>
<li><p><code>engine</code>: Một số kiểu hỗ trợ ghi file như <code>xlsxwriter</code>, <code>openpyxl</code>, <code>openpyxl</code>, <code>odswriter</code></p></li>
</ul>

<div class="rmdnote">
<p><strong><em>Lưu ý</em>:</strong>
<code>mode='w'</code> không được sử dụng với engine <code>xlsxwriter</code>, khi khai báo engine này sẽ báo lỗi.</p>
<p><code>if_sheet_exists</code> chỉ sử dụng với <code>mode='a'</code></p>
<code>overlay</code> chỉ hỗ trợ với phiên bản <code>1.4.0</code> trở lên.
</div>
<p>Để ghi từng sheet bạn dùng lệnh <code>.to_excel()</code>. Sau khi ghi tất cả các sheet bạn kết thúc với <code>writer.save()</code> để lưu file</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" tabindex="-1"></a>writer <span class="op">=</span> pd.ExcelWriter(<span class="st">&#39;mul_sheets.xlsx&#39;</span>, mode<span class="op">=</span><span class="st">&#39;w&#39;</span>, engine<span class="op">=</span><span class="st">&#39;openpyxl&#39;</span>)</span>
<span id="cb158-2"><a href="#cb158-2" tabindex="-1"></a>df1.to_excel(writer, sheet_name<span class="op">=</span><span class="st">&#39;Sheet1&#39;</span>)</span>
<span id="cb158-3"><a href="#cb158-3" tabindex="-1"></a>df2.to_excel(writer, sheet_name<span class="op">=</span><span class="st">&#39;Sheet2&#39;</span>)</span>
<span id="cb158-4"><a href="#cb158-4" tabindex="-1"></a>df3.to_excel(writer, sheet_name<span class="op">=</span><span class="st">&#39;Sheet3&#39;</span>)</span>
<span id="cb158-5"><a href="#cb158-5" tabindex="-1"></a>writer.save()</span></code></pre></div>

<div class="rmdtip">
<strong><em>Mẹo:</em></strong>
Có thể dùng <code>with</code> để mở file để tránh trường hợp quên gọi lệnh <code>.save()</code>, lệnh <code>with</code> sẽ tự động lưu file sau khi kết thúc các lệnh con trong nó
</div>
<div class="sourceCode" id="cb159"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb159-2"><a href="#cb159-2" tabindex="-1"></a>df1 <span class="op">=</span> pd.DataFrame({<span class="st">&#39;col_1&#39;</span>: [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]})</span>
<span id="cb159-3"><a href="#cb159-3" tabindex="-1"></a>df2 <span class="op">=</span> pd.DataFrame({<span class="st">&#39;col_1&#39;</span>: [<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>, <span class="st">&#39;d&#39;</span>]})</span>
<span id="cb159-4"><a href="#cb159-4" tabindex="-1"></a>df3 <span class="op">=</span> pd.DataFrame({<span class="st">&#39;col_1&#39;</span>: [<span class="va">True</span>, <span class="va">True</span>, <span class="va">False</span>, <span class="va">False</span>]})</span>
<span id="cb159-5"><a href="#cb159-5" tabindex="-1"></a>sheet_names <span class="op">=</span> [<span class="st">&#39;Sheet1&#39;</span>,<span class="st">&#39;Sheet2&#39;</span>, <span class="st">&#39;Sheet3&#39;</span>]</span>
<span id="cb159-6"><a href="#cb159-6" tabindex="-1"></a></span>
<span id="cb159-7"><a href="#cb159-7" tabindex="-1"></a><span class="cf">with</span> pd.ExcelWriter(<span class="st">&#39;mul_sheets.xlsx&#39;</span>, mode<span class="op">=</span><span class="st">&#39;a&#39;</span>, if_sheet_exists<span class="op">=</span><span class="st">&#39;new&#39;</span>, engine<span class="op">=</span><span class="st">&#39;openpyxl&#39;</span>) <span class="im">as</span> writer:</span>
<span id="cb159-8"><a href="#cb159-8" tabindex="-1"></a>    <span class="cf">for</span> df, sheet_name <span class="kw">in</span> <span class="bu">zip</span>([df1, df2, df3], sheet_names):</span>
<span id="cb159-9"><a href="#cb159-9" tabindex="-1"></a>        df.to_excel(writer, sheet_name)</span></code></pre></div>
</div>
</div>
</div>
<div id="json" class="section level2 hasAnchor" number="5.3">
<h2 class="hasAnchor"><span class="header-section-number">5.3</span> JSON<a href="#json" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="đọc-file-json" class="section level3 hasAnchor" number="5.3.1">
<h3 class="hasAnchor"><span class="header-section-number">5.3.1</span> Đọc file JSON<a href="#%C4%91%E1%BB%8Dc-file-json" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>JSON</code> là 1 dạng dữ liệu khá phổ biến trong thực tế. <code>Pandas</code> hỗ trợ đọc file <code>JSON</code> theo phương thức sau</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" tabindex="-1"></a>pd.read_json(path_or_buf<span class="op">=</span><span class="va">None</span>, orient<span class="op">=</span><span class="va">None</span>,...)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>path_or_buf</code>: là đường dẫn đến file json hoặc Object cho trước</p></li>
<li><p><code>orient</code>: Kiểu cấu trúc của json</p>
<ul>
<li><code>split</code>: Dữ liệu có dạng dictionary theo cấu trúc <code>{index -&gt; [index], columns - [columns], data -&gt; [values]}</code></li>
<li><code>records</code>: Dữ liệu có dạng danh sách các dictionary theo cấu trúc <code>[{column -&gt; value}, ... , {column -&gt; value}]</code></li>
<li><code>index</code>: Dữ liệu dạng dictionary theo cấu trúc <code>{"index" -&gt; {"column" -&gt; "value"}}</code></li>
<li><code>columns</code>: Dữ liệu dạng dictionary theo cấu trúc <code>{column -&gt; {index -&gt; value}}</code></li>
<li><code>values</code>: danh sách các giá trị</li>
</ul></li>
<li><p>Ngoài ra còn các tham số khác nữa như <code>chunksize</code>, <code>nrow</code>, các bạn có thể tham khảo tại <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_json.html">pd.read_json()</a></p></li>
</ul>
<p>Dưới đây là file <code>sample_pokemon.json</code> với các cấu trúc như sau</p>
<p>Cấu trúc <code>records</code></p>
<div class="sourceCode" id="cb161"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb161-1"><a href="#cb161-1" tabindex="-1"></a><span class="ot">[</span><span class="fu">{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;Bulbasaur&quot;</span><span class="fu">,</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;height&quot;</span><span class="fu">:</span><span class="st">&quot;0.71 m&quot;</span><span class="fu">,</span><span class="dt">&quot;weight&quot;</span><span class="fu">:</span><span class="st">&quot;6.9 kg&quot;</span><span class="fu">}</span><span class="ot">,</span></span>
<span id="cb161-2"><a href="#cb161-2" tabindex="-1"></a> <span class="fu">{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;Ivysaur&quot;</span><span class="fu">,</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;height&quot;</span><span class="fu">:</span><span class="st">&quot;0.99 m&quot;</span><span class="fu">,</span><span class="dt">&quot;weight&quot;</span><span class="fu">:</span><span class="st">&quot;13.0 kg&quot;</span><span class="fu">}</span><span class="ot">,</span></span>
<span id="cb161-3"><a href="#cb161-3" tabindex="-1"></a> <span class="fu">{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;Venusaur&quot;</span><span class="fu">,</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;height&quot;</span><span class="fu">:</span><span class="st">&quot;2.01 m&quot;</span><span class="fu">,</span><span class="dt">&quot;weight&quot;</span><span class="fu">:</span><span class="st">&quot;100.0 kg&quot;</span><span class="fu">}</span><span class="ot">,</span></span>
<span id="cb161-4"><a href="#cb161-4" tabindex="-1"></a> <span class="fu">{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;Charmander&quot;</span><span class="fu">,</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Fire&quot;</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;height&quot;</span><span class="fu">:</span><span class="st">&quot;0.61 m&quot;</span><span class="fu">,</span><span class="dt">&quot;weight&quot;</span><span class="fu">:</span><span class="st">&quot;8.5 kg&quot;</span><span class="fu">}</span><span class="ot">,</span></span>
<span id="cb161-5"><a href="#cb161-5" tabindex="-1"></a> <span class="fu">{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;Charmeleon&quot;</span><span class="fu">,</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Fire&quot;</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;height&quot;</span><span class="fu">:</span><span class="st">&quot;1.09 m&quot;</span><span class="fu">,</span><span class="dt">&quot;weight&quot;</span><span class="fu">:</span><span class="st">&quot;19.0 kg&quot;</span><span class="fu">}</span><span class="ot">]</span></span></code></pre></div>
<p>ta có thể gọi</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_json(<span class="st">&#39;sample_pokemon.json&#39;</span>, orient<span class="op">=</span><span class="st">&#39;records&#39;</span>)</span>
<span id="cb162-2"><a href="#cb162-2" tabindex="-1"></a>df.head()</span></code></pre></div>
<pre class="python_output"><code>         name             type  height    weight
0   Bulbasaur  [Grass, Poison]  0.71 m    6.9 kg
1     Ivysaur  [Grass, Poison]  0.99 m   13.0 kg
2    Venusaur  [Grass, Poison]  2.01 m  100.0 kg
3  Charmander           [Fire]  0.61 m    8.5 kg
4  Charmeleon           [Fire]  1.09 m   19.0 kg</code></pre>
<p>Tương tự với cấu trúc <code>split</code></p>
<div class="sourceCode" id="cb164"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb164-1"><a href="#cb164-1" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span>   <span class="ot">[</span><span class="dv">0</span><span class="ot">,</span><span class="dv">1</span><span class="ot">,</span><span class="dv">2</span><span class="ot">,</span><span class="dv">3</span><span class="ot">,</span><span class="dv">4</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb164-2"><a href="#cb164-2" tabindex="-1"></a> <span class="dt">&quot;columns&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;name&quot;</span><span class="ot">,</span><span class="st">&quot;type&quot;</span><span class="ot">,</span><span class="st">&quot;height&quot;</span><span class="ot">,</span><span class="st">&quot;weight&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb164-3"><a href="#cb164-3" tabindex="-1"></a> <span class="dt">&quot;data&quot;</span><span class="fu">:</span>    <span class="ot">[[</span><span class="st">&quot;Bulbasaur&quot;</span><span class="ot">,[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">],</span><span class="st">&quot;0.71 m&quot;</span><span class="ot">,</span><span class="st">&quot;6.9 kg&quot;</span><span class="ot">],</span></span>
<span id="cb164-4"><a href="#cb164-4" tabindex="-1"></a>             <span class="ot">[</span><span class="st">&quot;Ivysaur&quot;</span><span class="ot">,[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">],</span><span class="st">&quot;0.99 m&quot;</span><span class="ot">,</span><span class="st">&quot;13.0 kg&quot;</span><span class="ot">],</span></span>
<span id="cb164-5"><a href="#cb164-5" tabindex="-1"></a>             <span class="ot">[</span><span class="st">&quot;Venusaur&quot;</span><span class="ot">,[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">],</span><span class="st">&quot;2.01 m&quot;</span><span class="ot">,</span><span class="st">&quot;100.0 kg&quot;</span><span class="ot">],</span></span>
<span id="cb164-6"><a href="#cb164-6" tabindex="-1"></a>             <span class="ot">[</span><span class="st">&quot;Charmander&quot;</span><span class="ot">,[</span><span class="st">&quot;Fire&quot;</span><span class="ot">],</span><span class="st">&quot;0.61 m&quot;</span><span class="ot">,</span><span class="st">&quot;8.5 kg&quot;</span><span class="ot">],</span></span>
<span id="cb164-7"><a href="#cb164-7" tabindex="-1"></a>             <span class="ot">[</span><span class="st">&quot;Charmeleon&quot;</span><span class="ot">,[</span><span class="st">&quot;Fire&quot;</span><span class="ot">],</span><span class="st">&quot;1.09 m&quot;</span><span class="ot">,</span><span class="st">&quot;19.0 kg&quot;</span><span class="ot">]]</span><span class="fu">}</span></span></code></pre></div>
<p>ta có thể gọi</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_json(<span class="st">&#39;sample_pokemon.json&#39;</span>, orient<span class="op">=</span><span class="st">&#39;split&#39;</span>)</span>
<span id="cb165-2"><a href="#cb165-2" tabindex="-1"></a>df.head()</span></code></pre></div>
<p>Các cấu trúc còn lại</p>
<p><code>index</code></p>
<div class="sourceCode" id="cb166"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb166-1"><a href="#cb166-1" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;0&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;Bulbasaur&quot;</span><span class="fu">,</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;height&quot;</span><span class="fu">:</span><span class="st">&quot;0.71 m&quot;</span><span class="fu">,</span><span class="dt">&quot;weight&quot;</span><span class="fu">:</span><span class="st">&quot;6.9 kg&quot;</span><span class="fu">},</span></span>
<span id="cb166-2"><a href="#cb166-2" tabindex="-1"></a><span class="dt">&quot;1&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;Ivysaur&quot;</span><span class="fu">,</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;height&quot;</span><span class="fu">:</span><span class="st">&quot;0.99 m&quot;</span><span class="fu">,</span><span class="dt">&quot;weight&quot;</span><span class="fu">:</span><span class="st">&quot;13.0 kg&quot;</span><span class="fu">},</span></span>
<span id="cb166-3"><a href="#cb166-3" tabindex="-1"></a><span class="dt">&quot;2&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;Venusaur&quot;</span><span class="fu">,</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;height&quot;</span><span class="fu">:</span><span class="st">&quot;2.01 m&quot;</span><span class="fu">,</span><span class="dt">&quot;weight&quot;</span><span class="fu">:</span><span class="st">&quot;100.0 kg&quot;</span><span class="fu">},</span></span>
<span id="cb166-4"><a href="#cb166-4" tabindex="-1"></a><span class="dt">&quot;3&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;Charmander&quot;</span><span class="fu">,</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Fire&quot;</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;height&quot;</span><span class="fu">:</span><span class="st">&quot;0.61 m&quot;</span><span class="fu">,</span><span class="dt">&quot;weight&quot;</span><span class="fu">:</span><span class="st">&quot;8.5 kg&quot;</span><span class="fu">},</span></span>
<span id="cb166-5"><a href="#cb166-5" tabindex="-1"></a><span class="dt">&quot;4&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;Charmeleon&quot;</span><span class="fu">,</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Fire&quot;</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;height&quot;</span><span class="fu">:</span><span class="st">&quot;1.09 m&quot;</span><span class="fu">,</span><span class="dt">&quot;weight&quot;</span><span class="fu">:</span><span class="st">&quot;19.0 kg&quot;</span><span class="fu">}}</span></span></code></pre></div>
<p><code>columns</code></p>
<div class="sourceCode" id="cb167"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb167-1"><a href="#cb167-1" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;name&quot;</span><span class="fu">:{</span><span class="dt">&quot;0&quot;</span><span class="fu">:</span><span class="st">&quot;Bulbasaur&quot;</span><span class="fu">,</span></span>
<span id="cb167-2"><a href="#cb167-2" tabindex="-1"></a>         <span class="dt">&quot;1&quot;</span><span class="fu">:</span><span class="st">&quot;Ivysaur&quot;</span><span class="fu">,</span></span>
<span id="cb167-3"><a href="#cb167-3" tabindex="-1"></a>         <span class="dt">&quot;2&quot;</span><span class="fu">:</span><span class="st">&quot;Venusaur&quot;</span><span class="fu">,</span></span>
<span id="cb167-4"><a href="#cb167-4" tabindex="-1"></a>         <span class="dt">&quot;3&quot;</span><span class="fu">:</span><span class="st">&quot;Charmander&quot;</span></span>
<span id="cb167-5"><a href="#cb167-5" tabindex="-1"></a>         <span class="st">&quot;4&quot;</span><span class="er">:</span><span class="st">&quot;Charmeleon&quot;</span><span class="fu">},</span></span>
<span id="cb167-6"><a href="#cb167-6" tabindex="-1"></a> <span class="dt">&quot;type&quot;</span><span class="fu">:{</span><span class="dt">&quot;0&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb167-7"><a href="#cb167-7" tabindex="-1"></a>         <span class="dt">&quot;1&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb167-8"><a href="#cb167-8" tabindex="-1"></a>         <span class="dt">&quot;2&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb167-9"><a href="#cb167-9" tabindex="-1"></a>         <span class="dt">&quot;3&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Fire&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb167-10"><a href="#cb167-10" tabindex="-1"></a>         <span class="dt">&quot;4&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Fire&quot;</span><span class="ot">]</span><span class="fu">},</span></span>
<span id="cb167-11"><a href="#cb167-11" tabindex="-1"></a> <span class="dt">&quot;height&quot;</span><span class="fu">:{</span><span class="dt">&quot;0&quot;</span><span class="fu">:</span><span class="st">&quot;0.71 m&quot;</span><span class="fu">,</span></span>
<span id="cb167-12"><a href="#cb167-12" tabindex="-1"></a>           <span class="dt">&quot;1&quot;</span><span class="fu">:</span><span class="st">&quot;0.99 m&quot;</span><span class="fu">,</span></span>
<span id="cb167-13"><a href="#cb167-13" tabindex="-1"></a>           <span class="dt">&quot;2&quot;</span><span class="fu">:</span><span class="st">&quot;2.01 m&quot;</span><span class="fu">,</span></span>
<span id="cb167-14"><a href="#cb167-14" tabindex="-1"></a>           <span class="dt">&quot;3&quot;</span><span class="fu">:</span><span class="st">&quot;0.61 m&quot;</span><span class="fu">,</span></span>
<span id="cb167-15"><a href="#cb167-15" tabindex="-1"></a>           <span class="dt">&quot;4&quot;</span><span class="fu">:</span><span class="st">&quot;1.09 m&quot;</span><span class="fu">},</span></span>
<span id="cb167-16"><a href="#cb167-16" tabindex="-1"></a> <span class="dt">&quot;weight&quot;</span><span class="fu">:{</span><span class="dt">&quot;0&quot;</span><span class="fu">:</span><span class="st">&quot;6.9 kg&quot;</span><span class="fu">,</span></span>
<span id="cb167-17"><a href="#cb167-17" tabindex="-1"></a>           <span class="dt">&quot;1&quot;</span><span class="fu">:</span><span class="st">&quot;13.0 kg&quot;</span><span class="fu">,</span></span>
<span id="cb167-18"><a href="#cb167-18" tabindex="-1"></a>           <span class="dt">&quot;2&quot;</span><span class="fu">:</span><span class="st">&quot;100.0 kg&quot;</span><span class="fu">,</span></span>
<span id="cb167-19"><a href="#cb167-19" tabindex="-1"></a>           <span class="dt">&quot;3&quot;</span><span class="fu">:</span><span class="st">&quot;8.5 kg&quot;</span><span class="fu">,</span></span>
<span id="cb167-20"><a href="#cb167-20" tabindex="-1"></a>           <span class="dt">&quot;4&quot;</span><span class="fu">:</span><span class="st">&quot;19.0 kg&quot;</span><span class="fu">}}</span></span></code></pre></div>
<p><code>values</code></p>
<div class="sourceCode" id="cb168"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb168-1"><a href="#cb168-1" tabindex="-1"></a><span class="ot">[[</span><span class="st">&quot;Bulbasaur&quot;</span><span class="ot">,[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">],</span><span class="st">&quot;0.71 m&quot;</span><span class="ot">,</span><span class="st">&quot;6.9 kg&quot;</span><span class="ot">],</span></span>
<span id="cb168-2"><a href="#cb168-2" tabindex="-1"></a> <span class="ot">[</span><span class="st">&quot;Ivysaur&quot;</span><span class="ot">,[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">],</span><span class="st">&quot;0.99 m&quot;</span><span class="ot">,</span><span class="st">&quot;13.0 kg&quot;</span><span class="ot">],</span></span>
<span id="cb168-3"><a href="#cb168-3" tabindex="-1"></a> <span class="ot">[</span><span class="st">&quot;Venusaur&quot;</span><span class="ot">,[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">],</span><span class="st">&quot;2.01 m&quot;</span><span class="ot">,</span><span class="st">&quot;100.0 kg&quot;</span><span class="ot">],</span></span>
<span id="cb168-4"><a href="#cb168-4" tabindex="-1"></a> <span class="ot">[</span><span class="st">&quot;Charmander&quot;</span><span class="ot">,[</span><span class="st">&quot;Fire&quot;</span><span class="ot">],</span><span class="st">&quot;0.61 m&quot;</span><span class="ot">,</span><span class="st">&quot;8.5 kg&quot;</span><span class="ot">],</span></span>
<span id="cb168-5"><a href="#cb168-5" tabindex="-1"></a> <span class="ot">[</span><span class="st">&quot;Charmeleon&quot;</span><span class="ot">,[</span><span class="st">&quot;Fire&quot;</span><span class="ot">],</span><span class="st">&quot;1.09 m&quot;</span><span class="ot">,</span><span class="st">&quot;19.0 kg&quot;</span><span class="ot">]]</span></span></code></pre></div>

<div class="rmdnote">
<p><strong><em>Lưu ý</em>:</strong></p>
<ul>
<li><p><code>pd.read_json()</code> mặc định <code>orient='records'</code>. Các cấu trúc <code>records</code> và <code>index</code> là các cấu trúc JSON thường gặp.</p></li>
<li><p><code>values</code> không phải cấu trúc JSON.</p></li>
<li><p>có thể truyền link file thay vì file được lưu ở máy.</p></li>
</ul>
</div>
</div>
<div id="xuất-file-json" class="section level3 hasAnchor" number="5.3.2">
<h3 class="hasAnchor"><span class="header-section-number">5.3.2</span> Xuất file JSON<a href="#xu%E1%BA%A5t-file-json" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="pickle" class="section level2 hasAnchor" number="5.4">
<h2 class="hasAnchor"><span class="header-section-number">5.4</span> Pickle<a href="#pickle" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="đọc-file-pickle" class="section level3 hasAnchor" number="5.4.1">
<h3 class="hasAnchor"><span class="header-section-number">5.4.1</span> Đọc file Pickle<a href="#%C4%91%E1%BB%8Dc-file-pickle" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="xuất-file-pickle" class="section level3 hasAnchor" number="5.4.2">
<h3 class="hasAnchor"><span class="header-section-number">5.4.2</span> Xuất file Pickle<a href="#xu%E1%BA%A5t-file-pickle" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
</div>
<div id="cấu-hình-pandas" class="section level2 hasAnchor" number="5.5">
<h2 class="hasAnchor"><span class="header-section-number">5.5</span> Cấu hình pandas<a href="#c%E1%BA%A5u-h%C3%ACnh-pandas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:posts/02-IO.Rmd-->
</div>
</div>
<div id="đọc-và-lưu-file-trong-pandas-1" class="section level1 hasAnchor" number="6">
<h1 class="hasAnchor"><span class="header-section-number">6</span> Đọc và lưu file trong Pandas<a href="#%C4%91%E1%BB%8Dc-v%C3%A0-l%C6%B0u-file-trong-pandas-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Ở Chương 1 chúng ta đã biết cách khởi tạo DataFrame từ các dữ liệu cho trước.
Trong chương này sẽ hướng dẫn cách đọc dữ liệu từ file bằng pandas, một số kiểu file thường thấy cho dữ liệu dạng bảng là <code>.csv</code> và <code>.xlsx</code>.
Bạn cũng có thể đọc dữ liệu bán cấu trúc như <code>JSON</code> bằng cách load file bằng Python sau đó dùng các cách khởi tạo như ở Chương 1 hoặc có thể dùng
hàm phụ trợ của Pandas.</p>
<p>Ở phần thứ hai của chương, bạn sẽ được hướng dẫn một số cách cấu hình cho Pandas như thay đổi số dòng, số cột hiển thị…</p>
<!--chapter:end:posts/02-IO/00-Introduction.Rmd-->
<div id="csv-tsv-1" class="section level2 hasAnchor" number="6.1">
<h2 class="hasAnchor"><span class="header-section-number">6.1</span> csv, tsv<a href="#csv-tsv-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="đọc-file-csv-tsv-1" class="section level3 hasAnchor" number="6.1.1">
<h3 class="hasAnchor"><span class="header-section-number">6.1.1</span> Đọc file csv, tsv<a href="#%C4%91%E1%BB%8Dc-file-csv-tsv-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Chúng ta có thể đọc file csv với pandas theo lệnh sau</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb169-1"><a href="#cb169-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(filepath, sep<span class="op">=</span><span class="st">&#39;,&#39;</span>, names<span class="op">=</span>NoDefault.no_default, index_col<span class="op">=</span><span class="va">None</span>, usecols<span class="op">=</span><span class="va">None</span>, dtype<span class="op">=</span><span class="va">None</span>, skiprows<span class="op">=</span><span class="va">None</span>, skipfooter<span class="op">=</span><span class="dv">0</span>, nrows<span class="op">=</span><span class="va">None</span>)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>filepath</code> là đường dẫn đến file trong máy hoặc đường link URL</p></li>
<li><p><code>sep</code> dùng để nhận diện cách chia thành cột, nếu không truyền tham số này thì <code>pandas</code> tự hiểu là chia theo <code>','</code>, ngoài ra có thể chia theo <code>';'</code> đối với macOS và <code>'\t'</code> với file có định dạng <code>.tsv</code></p></li>
<li><p><code>names</code> là tên các cột của bảng. Nếu bảng đã có tên cột thì nên bỏ qua tham số này, <code>pandas</code> sẽ lấy dòng đầu tiên của file làm tên cột.</p></li>
<li><p><code>index_col</code> dùng để chỉ định vị trí các cột dùng để làm index cho bảng.</p></li>
<li><p><code>usecols</code> dùng để chỉ định vị trí hoặc tên các cột cần đọc.</p></li>
<li><p><code>dtype</code> dùng để định dạng kiểu dữ liệu của các cột.</p></li>
<li><p><code>skiprows</code> được dùng khi muốn bỏ qua một số dòng đầu của bảng.</p></li>
<li><p><code>skipfooter</code> tương tự như <code>skiprows</code> nhưng sẽ bỏ qua các dòng cuối cùng của bảng.</p></li>
<li><p><code>nrows</code> dùng để chỉ định số lượng dòng của bạn mà bạn sẽ đọc bằng <code>pandas</code></p></li>
</ul>
<p><strong>Ví dụ</strong></p>
<p>Đọc file dữ liệu sale được cho tại <a href="https://raw.githubusercontent.com/lhduc94/kungfupandas/master/data/sales_subset.csv">đây</a>. Giả sử ta chỉ lấy các cột <code>date</code>, <code>weekly_sales</code> và <code>is_holiday</code> và lấy cột <code>date</code> làm <code>index</code> và chỉ lấy 6 dòng đầu</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;https://raw.githubusercontent.com/lhduc94/kungfupandas/master/data/sales_subset.csv&#39;</span>, index_col<span class="op">=</span>[<span class="st">&#39;date&#39;</span>], usecols<span class="op">=</span>[<span class="st">&#39;date&#39;</span>,<span class="st">&#39;weekly_sales&#39;</span>,<span class="st">&#39;is_holiday&#39;</span>], nrows<span class="op">=</span><span class="dv">6</span>)</span>
<span id="cb170-2"><a href="#cb170-2" tabindex="-1"></a>df</span></code></pre></div>
<pre class="python_output"><code>            weekly_sales  is_holiday
date                                
2010-02-05      24924.50       False
2010-03-05      21827.90       False
2010-04-02      57258.43       False
2010-05-07      17413.94       False
2010-06-04      17558.09       False
2010-07-02      16333.14       False</code></pre>
</div>
<div id="xuất-file-csv-tsv-1" class="section level3 hasAnchor" number="6.1.2">
<h3 class="hasAnchor"><span class="header-section-number">6.1.2</span> Xuất file csv, tsv<a href="#xu%E1%BA%A5t-file-csv-tsv-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Để lưu <code>DataFrame</code> dưới dạng file ta có thể dùng câu lệnh <code>.to_csv()</code> theo cú pháp sau</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" tabindex="-1"></a>df.to_csv(filename, sep<span class="op">=</span><span class="st">&#39;,&#39;</span>, columns<span class="op">=</span><span class="va">None</span>, header<span class="op">=</span><span class="va">True</span>, index<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>filename</code> là địa chỉ file mà bạn muốn lưu lại</p></li>
<li><p><code>sep</code> tương tự như lúc đọc file</p></li>
<li><p><code>columns</code> là tên các cột bạn muốn lưu xuống, nếu muốn lưu tất cả các cột thì
bạn có thể bỏ qua tham số này.</p></li>
<li><p><code>header</code> mặc định là <code>True</code> nếu bạn muốn lưu tên cột</p></li>
<li><p><code>index</code> mặc định là <code>True</code> nếu bạn muốn lưu index của bảng.</p></li>
</ul>
<p>Ví dụ</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" tabindex="-1"></a>df.to_csv(<span class="st">&#39;sales.csv&#39;</span>, columns<span class="op">=</span><span class="st">&#39;weekly_sales&#39;</span>, index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<!--chapter:end:posts/02-IO/01-CSV_TSV.Rmd-->
</div>
</div>
<div id="excel-1" class="section level2 hasAnchor" number="6.2">
<h2 class="hasAnchor"><span class="header-section-number">6.2</span> Excel<a href="#excel-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="đọc-file-excel-1" class="section level3 hasAnchor" number="6.2.1">
<h3 class="hasAnchor"><span class="header-section-number">6.2.1</span> Đọc file Excel<a href="#%C4%91%E1%BB%8Dc-file-excel-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Để đọc file Excel ta dùng cú pháp sau</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb174-1"><a href="#cb174-1" tabindex="-1"></a>x <span class="op">=</span> pd.ExcelFile(filename)</span></code></pre></div>
<p>Với <code>filename</code> là đường dẫn đến file</p>
<p>Để xem tên các sheets của <code>x</code> ta có thể dùng <code>x.sheet_names</code>. Sau đó để đọc từng sheet của <code>x</code> ta có thể dùng <code>.parse()</code></p>
<div class="sourceCode" id="cb175"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" tabindex="-1"></a>df <span class="op">=</span> x.parse(sheet_name, header<span class="op">=</span><span class="dv">0</span>, names<span class="op">=</span><span class="va">None</span>, index_col<span class="op">=</span><span class="va">None</span>, usecols<span class="op">=</span><span class="va">None</span>, skiprows<span class="op">=</span><span class="va">None</span>, skipfooter<span class="op">=</span><span class="dv">0</span>, nrows<span class="op">=</span><span class="va">None</span>)</span></code></pre></div>
<p>Trong đó <code>sheet_name</code> là tên sheet cần đọc, các thông số còn lại tương tự như phần đọc file <code>csv</code> và <code>tsv</code>. Một cách khác để đọc file excel là dùng hàm <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_excel.html">pandas.read_excel</a> với tham số <code>io</code> là tên file.</p>
</div>
<div id="xuất-file-excel-1" class="section level3 hasAnchor" number="6.2.2">
<h3 class="hasAnchor"><span class="header-section-number">6.2.2</span> Xuất file Excel<a href="#xu%E1%BA%A5t-file-excel-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Giả sử ta có các <code>DataFrame</code> df1, df2, df3 cần được lưu vào 1 file Excel duy nhất</p>
<div class="sourceCode" id="cb176"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb176-1"><a href="#cb176-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb176-2"><a href="#cb176-2" tabindex="-1"></a></span>
<span id="cb176-3"><a href="#cb176-3" tabindex="-1"></a>df1 <span class="op">=</span> pd.DataFrame({<span class="st">&#39;col_1&#39;</span>: [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]})</span>
<span id="cb176-4"><a href="#cb176-4" tabindex="-1"></a>df2 <span class="op">=</span> pd.DataFrame({<span class="st">&#39;col_1&#39;</span>: [<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>, <span class="st">&#39;d&#39;</span>]})</span>
<span id="cb176-5"><a href="#cb176-5" tabindex="-1"></a>df3 <span class="op">=</span> pd.DataFrame({<span class="st">&#39;col_1&#39;</span>: [<span class="va">True</span>, <span class="va">True</span>, <span class="va">False</span>, <span class="va">False</span>]})</span></code></pre></div>
<p>Để ghi các bảng vào file Excel, bước đầu tiên là khởi tạo biến <code>writer</code> theo cú pháp</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" tabindex="-1"></a>writer <span class="op">=</span> pd.ExcelWriter(<span class="st">&#39;pandas_multiple.xlsx&#39;</span>, mode<span class="op">=</span><span class="st">&#39;w&#39;</span>,  if_sheet_exists<span class="op">=</span><span class="va">None</span>, engine<span class="op">=</span><span class="va">None</span>)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>filename</code> là tên file excel</p></li>
<li><p><code>mode</code> là phương thức ghi file với <code>w</code> là viết file mới và <code>a</code> là viết thêm vào file. Mặc định là <code>w</code></p></li>
<li><p><code>if_sheet_exists</code> là phương thức ghi file nếu file hoặc sheet đã tồn tại, bao gồm các phương thức dưới đây (mặc định là error)</p>
<ul>
<li><p><code>error</code>: hiện ValueError nếu đã tồn tại sheet</p></li>
<li><p><code>new</code>: Tạo sheet mới với tên phụ thuộc vào <code>engine</code></p></li>
<li><p><code>replace</code>: Xóa nội dung của sheet trước khi viết.</p></li>
<li><p><code>overlay</code>: Viết lên sheet đã tồn tại mà không xóa các sheet cũ</p></li>
</ul></li>
<li><p><code>engine</code>: Một số kiểu hỗ trợ ghi file như <code>xlsxwriter</code>, <code>openpyxl</code>, <code>openpyxl</code>, <code>odswriter</code></p></li>
</ul>

<div class="rmdnote">
<p><strong><em>Lưu ý</em>:</strong>
<code>mode='w'</code> không được sử dụng với engine <code>xlsxwriter</code>, khi khai báo engine này sẽ báo lỗi.</p>
<p><code>if_sheet_exists</code> chỉ sử dụng với <code>mode='a'</code></p>
<code>overlay</code> chỉ hỗ trợ với phiên bản <code>1.4.0</code> trở lên.
</div>
<p>Để ghi từng sheet bạn dùng lệnh <code>.to_excel()</code>. Sau khi ghi tất cả các sheet bạn kết thúc với <code>writer.save()</code> để lưu file</p>
<div class="sourceCode" id="cb178"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb178-1"><a href="#cb178-1" tabindex="-1"></a>writer <span class="op">=</span> pd.ExcelWriter(<span class="st">&#39;mul_sheets.xlsx&#39;</span>, mode<span class="op">=</span><span class="st">&#39;w&#39;</span>, engine<span class="op">=</span><span class="st">&#39;openpyxl&#39;</span>)</span>
<span id="cb178-2"><a href="#cb178-2" tabindex="-1"></a>df1.to_excel(writer, sheet_name<span class="op">=</span><span class="st">&#39;Sheet1&#39;</span>)</span>
<span id="cb178-3"><a href="#cb178-3" tabindex="-1"></a>df2.to_excel(writer, sheet_name<span class="op">=</span><span class="st">&#39;Sheet2&#39;</span>)</span>
<span id="cb178-4"><a href="#cb178-4" tabindex="-1"></a>df3.to_excel(writer, sheet_name<span class="op">=</span><span class="st">&#39;Sheet3&#39;</span>)</span>
<span id="cb178-5"><a href="#cb178-5" tabindex="-1"></a>writer.save()</span></code></pre></div>

<div class="rmdtip">
<strong><em>Mẹo:</em></strong>
Có thể dùng <code>with</code> để mở file để tránh trường hợp quên gọi lệnh <code>.save()</code>, lệnh <code>with</code> sẽ tự động lưu file sau khi kết thúc các lệnh con trong nó
</div>
<div class="sourceCode" id="cb179"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb179-2"><a href="#cb179-2" tabindex="-1"></a>df1 <span class="op">=</span> pd.DataFrame({<span class="st">&#39;col_1&#39;</span>: [<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>]})</span>
<span id="cb179-3"><a href="#cb179-3" tabindex="-1"></a>df2 <span class="op">=</span> pd.DataFrame({<span class="st">&#39;col_1&#39;</span>: [<span class="st">&#39;a&#39;</span>, <span class="st">&#39;b&#39;</span>, <span class="st">&#39;c&#39;</span>, <span class="st">&#39;d&#39;</span>]})</span>
<span id="cb179-4"><a href="#cb179-4" tabindex="-1"></a>df3 <span class="op">=</span> pd.DataFrame({<span class="st">&#39;col_1&#39;</span>: [<span class="va">True</span>, <span class="va">True</span>, <span class="va">False</span>, <span class="va">False</span>]})</span>
<span id="cb179-5"><a href="#cb179-5" tabindex="-1"></a>sheet_names <span class="op">=</span> [<span class="st">&#39;Sheet1&#39;</span>,<span class="st">&#39;Sheet2&#39;</span>, <span class="st">&#39;Sheet3&#39;</span>]</span>
<span id="cb179-6"><a href="#cb179-6" tabindex="-1"></a></span>
<span id="cb179-7"><a href="#cb179-7" tabindex="-1"></a><span class="cf">with</span> pd.ExcelWriter(<span class="st">&#39;mul_sheets.xlsx&#39;</span>, mode<span class="op">=</span><span class="st">&#39;a&#39;</span>, if_sheet_exists<span class="op">=</span><span class="st">&#39;new&#39;</span>, engine<span class="op">=</span><span class="st">&#39;openpyxl&#39;</span>) <span class="im">as</span> writer:</span>
<span id="cb179-8"><a href="#cb179-8" tabindex="-1"></a>    <span class="cf">for</span> df, sheet_name <span class="kw">in</span> <span class="bu">zip</span>([df1, df2, df3], sheet_names):</span>
<span id="cb179-9"><a href="#cb179-9" tabindex="-1"></a>        df.to_excel(writer, sheet_name)</span></code></pre></div>
<!--chapter:end:posts/02-IO/02-Excel.Rmd-->
</div>
</div>
<div id="json-1" class="section level2 hasAnchor" number="6.3">
<h2 class="hasAnchor"><span class="header-section-number">6.3</span> JSON<a href="#json-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="đọc-file-json-1" class="section level3 hasAnchor" number="6.3.1">
<h3 class="hasAnchor"><span class="header-section-number">6.3.1</span> Đọc file JSON<a href="#%C4%91%E1%BB%8Dc-file-json-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>JSON</code> là 1 dạng dữ liệu khá phổ biến trong thực tế. <code>Pandas</code> hỗ trợ đọc file <code>JSON</code> theo phương thức sau</p>
<div class="sourceCode" id="cb180"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" tabindex="-1"></a>pd.read_json(path_or_buf<span class="op">=</span><span class="va">None</span>, orient<span class="op">=</span><span class="va">None</span>,...)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>path_or_buf</code>: là đường dẫn đến file json hoặc Object cho trước</p></li>
<li><p><code>orient</code>: Kiểu cấu trúc của json</p>
<ul>
<li><code>split</code>: Dữ liệu có dạng dictionary theo cấu trúc <code>{index -&gt; [index], columns - [columns], data -&gt; [values]}</code></li>
<li><code>records</code>: Dữ liệu có dạng danh sách các dictionary theo cấu trúc <code>[{column -&gt; value}, ... , {column -&gt; value}]</code></li>
<li><code>index</code>: Dữ liệu dạng dictionary theo cấu trúc <code>{"index" -&gt; {"column" -&gt; "value"}}</code></li>
<li><code>columns</code>: Dữ liệu dạng dictionary theo cấu trúc <code>{column -&gt; {index -&gt; value}}</code></li>
<li><code>values</code>: danh sách các giá trị</li>
</ul></li>
<li><p>Ngoài ra còn các tham số khác nữa như <code>chunksize</code>, <code>nrow</code>, các bạn có thể tham khảo tại <a href="https://pandas.pydata.org/docs/reference/api/pandas.read_json.html">pd.read_json()</a></p></li>
</ul>
<p>Dưới đây là file <code>sample_pokemon.json</code> với các cấu trúc như sau</p>
<p>Cấu trúc <code>records</code></p>
<div class="sourceCode" id="cb181"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb181-1"><a href="#cb181-1" tabindex="-1"></a><span class="ot">[</span><span class="fu">{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;Bulbasaur&quot;</span><span class="fu">,</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;height&quot;</span><span class="fu">:</span><span class="st">&quot;0.71 m&quot;</span><span class="fu">,</span><span class="dt">&quot;weight&quot;</span><span class="fu">:</span><span class="st">&quot;6.9 kg&quot;</span><span class="fu">}</span><span class="ot">,</span></span>
<span id="cb181-2"><a href="#cb181-2" tabindex="-1"></a> <span class="fu">{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;Ivysaur&quot;</span><span class="fu">,</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;height&quot;</span><span class="fu">:</span><span class="st">&quot;0.99 m&quot;</span><span class="fu">,</span><span class="dt">&quot;weight&quot;</span><span class="fu">:</span><span class="st">&quot;13.0 kg&quot;</span><span class="fu">}</span><span class="ot">,</span></span>
<span id="cb181-3"><a href="#cb181-3" tabindex="-1"></a> <span class="fu">{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;Venusaur&quot;</span><span class="fu">,</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;height&quot;</span><span class="fu">:</span><span class="st">&quot;2.01 m&quot;</span><span class="fu">,</span><span class="dt">&quot;weight&quot;</span><span class="fu">:</span><span class="st">&quot;100.0 kg&quot;</span><span class="fu">}</span><span class="ot">,</span></span>
<span id="cb181-4"><a href="#cb181-4" tabindex="-1"></a> <span class="fu">{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;Charmander&quot;</span><span class="fu">,</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Fire&quot;</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;height&quot;</span><span class="fu">:</span><span class="st">&quot;0.61 m&quot;</span><span class="fu">,</span><span class="dt">&quot;weight&quot;</span><span class="fu">:</span><span class="st">&quot;8.5 kg&quot;</span><span class="fu">}</span><span class="ot">,</span></span>
<span id="cb181-5"><a href="#cb181-5" tabindex="-1"></a> <span class="fu">{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;Charmeleon&quot;</span><span class="fu">,</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Fire&quot;</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;height&quot;</span><span class="fu">:</span><span class="st">&quot;1.09 m&quot;</span><span class="fu">,</span><span class="dt">&quot;weight&quot;</span><span class="fu">:</span><span class="st">&quot;19.0 kg&quot;</span><span class="fu">}</span><span class="ot">]</span></span></code></pre></div>
<p>ta có thể gọi</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb182-1"><a href="#cb182-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_json(<span class="st">&#39;sample_pokemon.json&#39;</span>, orient<span class="op">=</span><span class="st">&#39;records&#39;</span>)</span>
<span id="cb182-2"><a href="#cb182-2" tabindex="-1"></a>df.head()</span></code></pre></div>
<pre class="python_output"><code>         name             type  height    weight
0   Bulbasaur  [Grass, Poison]  0.71 m    6.9 kg
1     Ivysaur  [Grass, Poison]  0.99 m   13.0 kg
2    Venusaur  [Grass, Poison]  2.01 m  100.0 kg
3  Charmander           [Fire]  0.61 m    8.5 kg
4  Charmeleon           [Fire]  1.09 m   19.0 kg</code></pre>
<p>Tương tự với cấu trúc <code>split</code></p>
<div class="sourceCode" id="cb184"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb184-1"><a href="#cb184-1" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;index&quot;</span><span class="fu">:</span>   <span class="ot">[</span><span class="dv">0</span><span class="ot">,</span><span class="dv">1</span><span class="ot">,</span><span class="dv">2</span><span class="ot">,</span><span class="dv">3</span><span class="ot">,</span><span class="dv">4</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb184-2"><a href="#cb184-2" tabindex="-1"></a> <span class="dt">&quot;columns&quot;</span><span class="fu">:</span> <span class="ot">[</span><span class="st">&quot;name&quot;</span><span class="ot">,</span><span class="st">&quot;type&quot;</span><span class="ot">,</span><span class="st">&quot;height&quot;</span><span class="ot">,</span><span class="st">&quot;weight&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb184-3"><a href="#cb184-3" tabindex="-1"></a> <span class="dt">&quot;data&quot;</span><span class="fu">:</span>    <span class="ot">[[</span><span class="st">&quot;Bulbasaur&quot;</span><span class="ot">,[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">],</span><span class="st">&quot;0.71 m&quot;</span><span class="ot">,</span><span class="st">&quot;6.9 kg&quot;</span><span class="ot">],</span></span>
<span id="cb184-4"><a href="#cb184-4" tabindex="-1"></a>             <span class="ot">[</span><span class="st">&quot;Ivysaur&quot;</span><span class="ot">,[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">],</span><span class="st">&quot;0.99 m&quot;</span><span class="ot">,</span><span class="st">&quot;13.0 kg&quot;</span><span class="ot">],</span></span>
<span id="cb184-5"><a href="#cb184-5" tabindex="-1"></a>             <span class="ot">[</span><span class="st">&quot;Venusaur&quot;</span><span class="ot">,[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">],</span><span class="st">&quot;2.01 m&quot;</span><span class="ot">,</span><span class="st">&quot;100.0 kg&quot;</span><span class="ot">],</span></span>
<span id="cb184-6"><a href="#cb184-6" tabindex="-1"></a>             <span class="ot">[</span><span class="st">&quot;Charmander&quot;</span><span class="ot">,[</span><span class="st">&quot;Fire&quot;</span><span class="ot">],</span><span class="st">&quot;0.61 m&quot;</span><span class="ot">,</span><span class="st">&quot;8.5 kg&quot;</span><span class="ot">],</span></span>
<span id="cb184-7"><a href="#cb184-7" tabindex="-1"></a>             <span class="ot">[</span><span class="st">&quot;Charmeleon&quot;</span><span class="ot">,[</span><span class="st">&quot;Fire&quot;</span><span class="ot">],</span><span class="st">&quot;1.09 m&quot;</span><span class="ot">,</span><span class="st">&quot;19.0 kg&quot;</span><span class="ot">]]</span><span class="fu">}</span></span></code></pre></div>
<p>ta có thể gọi</p>
<div class="sourceCode" id="cb185"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_json(<span class="st">&#39;sample_pokemon.json&#39;</span>, orient<span class="op">=</span><span class="st">&#39;split&#39;</span>)</span>
<span id="cb185-2"><a href="#cb185-2" tabindex="-1"></a>df.head()</span></code></pre></div>
<p>Các cấu trúc còn lại</p>
<p><code>index</code></p>
<div class="sourceCode" id="cb186"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb186-1"><a href="#cb186-1" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;0&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;Bulbasaur&quot;</span><span class="fu">,</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;height&quot;</span><span class="fu">:</span><span class="st">&quot;0.71 m&quot;</span><span class="fu">,</span><span class="dt">&quot;weight&quot;</span><span class="fu">:</span><span class="st">&quot;6.9 kg&quot;</span><span class="fu">},</span></span>
<span id="cb186-2"><a href="#cb186-2" tabindex="-1"></a><span class="dt">&quot;1&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;Ivysaur&quot;</span><span class="fu">,</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;height&quot;</span><span class="fu">:</span><span class="st">&quot;0.99 m&quot;</span><span class="fu">,</span><span class="dt">&quot;weight&quot;</span><span class="fu">:</span><span class="st">&quot;13.0 kg&quot;</span><span class="fu">},</span></span>
<span id="cb186-3"><a href="#cb186-3" tabindex="-1"></a><span class="dt">&quot;2&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;Venusaur&quot;</span><span class="fu">,</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;height&quot;</span><span class="fu">:</span><span class="st">&quot;2.01 m&quot;</span><span class="fu">,</span><span class="dt">&quot;weight&quot;</span><span class="fu">:</span><span class="st">&quot;100.0 kg&quot;</span><span class="fu">},</span></span>
<span id="cb186-4"><a href="#cb186-4" tabindex="-1"></a><span class="dt">&quot;3&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;Charmander&quot;</span><span class="fu">,</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Fire&quot;</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;height&quot;</span><span class="fu">:</span><span class="st">&quot;0.61 m&quot;</span><span class="fu">,</span><span class="dt">&quot;weight&quot;</span><span class="fu">:</span><span class="st">&quot;8.5 kg&quot;</span><span class="fu">},</span></span>
<span id="cb186-5"><a href="#cb186-5" tabindex="-1"></a><span class="dt">&quot;4&quot;</span><span class="fu">:{</span><span class="dt">&quot;name&quot;</span><span class="fu">:</span><span class="st">&quot;Charmeleon&quot;</span><span class="fu">,</span><span class="dt">&quot;type&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Fire&quot;</span><span class="ot">]</span><span class="fu">,</span><span class="dt">&quot;height&quot;</span><span class="fu">:</span><span class="st">&quot;1.09 m&quot;</span><span class="fu">,</span><span class="dt">&quot;weight&quot;</span><span class="fu">:</span><span class="st">&quot;19.0 kg&quot;</span><span class="fu">}}</span></span></code></pre></div>
<p><code>columns</code></p>
<div class="sourceCode" id="cb187"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb187-1"><a href="#cb187-1" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;name&quot;</span><span class="fu">:{</span><span class="dt">&quot;0&quot;</span><span class="fu">:</span><span class="st">&quot;Bulbasaur&quot;</span><span class="fu">,</span></span>
<span id="cb187-2"><a href="#cb187-2" tabindex="-1"></a>         <span class="dt">&quot;1&quot;</span><span class="fu">:</span><span class="st">&quot;Ivysaur&quot;</span><span class="fu">,</span></span>
<span id="cb187-3"><a href="#cb187-3" tabindex="-1"></a>         <span class="dt">&quot;2&quot;</span><span class="fu">:</span><span class="st">&quot;Venusaur&quot;</span><span class="fu">,</span></span>
<span id="cb187-4"><a href="#cb187-4" tabindex="-1"></a>         <span class="dt">&quot;3&quot;</span><span class="fu">:</span><span class="st">&quot;Charmander&quot;</span></span>
<span id="cb187-5"><a href="#cb187-5" tabindex="-1"></a>         <span class="st">&quot;4&quot;</span><span class="er">:</span><span class="st">&quot;Charmeleon&quot;</span><span class="fu">},</span></span>
<span id="cb187-6"><a href="#cb187-6" tabindex="-1"></a> <span class="dt">&quot;type&quot;</span><span class="fu">:{</span><span class="dt">&quot;0&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb187-7"><a href="#cb187-7" tabindex="-1"></a>         <span class="dt">&quot;1&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb187-8"><a href="#cb187-8" tabindex="-1"></a>         <span class="dt">&quot;2&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb187-9"><a href="#cb187-9" tabindex="-1"></a>         <span class="dt">&quot;3&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Fire&quot;</span><span class="ot">]</span><span class="fu">,</span></span>
<span id="cb187-10"><a href="#cb187-10" tabindex="-1"></a>         <span class="dt">&quot;4&quot;</span><span class="fu">:</span><span class="ot">[</span><span class="st">&quot;Fire&quot;</span><span class="ot">]</span><span class="fu">},</span></span>
<span id="cb187-11"><a href="#cb187-11" tabindex="-1"></a> <span class="dt">&quot;height&quot;</span><span class="fu">:{</span><span class="dt">&quot;0&quot;</span><span class="fu">:</span><span class="st">&quot;0.71 m&quot;</span><span class="fu">,</span></span>
<span id="cb187-12"><a href="#cb187-12" tabindex="-1"></a>           <span class="dt">&quot;1&quot;</span><span class="fu">:</span><span class="st">&quot;0.99 m&quot;</span><span class="fu">,</span></span>
<span id="cb187-13"><a href="#cb187-13" tabindex="-1"></a>           <span class="dt">&quot;2&quot;</span><span class="fu">:</span><span class="st">&quot;2.01 m&quot;</span><span class="fu">,</span></span>
<span id="cb187-14"><a href="#cb187-14" tabindex="-1"></a>           <span class="dt">&quot;3&quot;</span><span class="fu">:</span><span class="st">&quot;0.61 m&quot;</span><span class="fu">,</span></span>
<span id="cb187-15"><a href="#cb187-15" tabindex="-1"></a>           <span class="dt">&quot;4&quot;</span><span class="fu">:</span><span class="st">&quot;1.09 m&quot;</span><span class="fu">},</span></span>
<span id="cb187-16"><a href="#cb187-16" tabindex="-1"></a> <span class="dt">&quot;weight&quot;</span><span class="fu">:{</span><span class="dt">&quot;0&quot;</span><span class="fu">:</span><span class="st">&quot;6.9 kg&quot;</span><span class="fu">,</span></span>
<span id="cb187-17"><a href="#cb187-17" tabindex="-1"></a>           <span class="dt">&quot;1&quot;</span><span class="fu">:</span><span class="st">&quot;13.0 kg&quot;</span><span class="fu">,</span></span>
<span id="cb187-18"><a href="#cb187-18" tabindex="-1"></a>           <span class="dt">&quot;2&quot;</span><span class="fu">:</span><span class="st">&quot;100.0 kg&quot;</span><span class="fu">,</span></span>
<span id="cb187-19"><a href="#cb187-19" tabindex="-1"></a>           <span class="dt">&quot;3&quot;</span><span class="fu">:</span><span class="st">&quot;8.5 kg&quot;</span><span class="fu">,</span></span>
<span id="cb187-20"><a href="#cb187-20" tabindex="-1"></a>           <span class="dt">&quot;4&quot;</span><span class="fu">:</span><span class="st">&quot;19.0 kg&quot;</span><span class="fu">}}</span></span></code></pre></div>
<p><code>values</code></p>
<div class="sourceCode" id="cb188"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb188-1"><a href="#cb188-1" tabindex="-1"></a><span class="ot">[[</span><span class="st">&quot;Bulbasaur&quot;</span><span class="ot">,[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">],</span><span class="st">&quot;0.71 m&quot;</span><span class="ot">,</span><span class="st">&quot;6.9 kg&quot;</span><span class="ot">],</span></span>
<span id="cb188-2"><a href="#cb188-2" tabindex="-1"></a> <span class="ot">[</span><span class="st">&quot;Ivysaur&quot;</span><span class="ot">,[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">],</span><span class="st">&quot;0.99 m&quot;</span><span class="ot">,</span><span class="st">&quot;13.0 kg&quot;</span><span class="ot">],</span></span>
<span id="cb188-3"><a href="#cb188-3" tabindex="-1"></a> <span class="ot">[</span><span class="st">&quot;Venusaur&quot;</span><span class="ot">,[</span><span class="st">&quot;Grass&quot;</span><span class="ot">,</span><span class="st">&quot;Poison&quot;</span><span class="ot">],</span><span class="st">&quot;2.01 m&quot;</span><span class="ot">,</span><span class="st">&quot;100.0 kg&quot;</span><span class="ot">],</span></span>
<span id="cb188-4"><a href="#cb188-4" tabindex="-1"></a> <span class="ot">[</span><span class="st">&quot;Charmander&quot;</span><span class="ot">,[</span><span class="st">&quot;Fire&quot;</span><span class="ot">],</span><span class="st">&quot;0.61 m&quot;</span><span class="ot">,</span><span class="st">&quot;8.5 kg&quot;</span><span class="ot">],</span></span>
<span id="cb188-5"><a href="#cb188-5" tabindex="-1"></a> <span class="ot">[</span><span class="st">&quot;Charmeleon&quot;</span><span class="ot">,[</span><span class="st">&quot;Fire&quot;</span><span class="ot">],</span><span class="st">&quot;1.09 m&quot;</span><span class="ot">,</span><span class="st">&quot;19.0 kg&quot;</span><span class="ot">]]</span></span></code></pre></div>

<div class="rmdnote">
<p><strong><em>Lưu ý</em>:</strong></p>
<ul>
<li><p><code>pd.read_json()</code> mặc định <code>orient='records'</code>. Các cấu trúc <code>records</code> và <code>index</code> là các cấu trúc JSON thường gặp.</p></li>
<li><p><code>values</code> không phải cấu trúc JSON.</p></li>
<li><p>có thể truyền link file thay vì file được lưu ở máy.</p></li>
</ul>
</div>
</div>
<div id="xuất-file-json-1" class="section level3 hasAnchor" number="6.3.2">
<h3 class="hasAnchor"><span class="header-section-number">6.3.2</span> Xuất file JSON<a href="#xu%E1%BA%A5t-file-json-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!--chapter:end:posts/02-IO/03-JSON.Rmd-->
</div>
</div>
<div id="parquet" class="section level2 hasAnchor" number="6.4">
<h2 class="hasAnchor"><span class="header-section-number">6.4</span> Parquet<a href="#parquet" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="đọc-file-parquet" class="section level3 hasAnchor" number="6.4.1">
<h3 class="hasAnchor"><span class="header-section-number">6.4.1</span> Đọc file Parquet<a href="#%C4%91%E1%BB%8Dc-file-parquet" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="xuất-file-parquet" class="section level3 hasAnchor" number="6.4.2">
<h3 class="hasAnchor"><span class="header-section-number">6.4.2</span> Xuất file Parquet<a href="#xu%E1%BA%A5t-file-parquet" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!--chapter:end:posts/02-IO/04-Parquet.Rmd-->
</div>
</div>
<div id="pickle-1" class="section level2 hasAnchor" number="6.5">
<h2 class="hasAnchor"><span class="header-section-number">6.5</span> Pickle<a href="#pickle-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="đọc-file-pickle-1" class="section level3 hasAnchor" number="6.5.1">
<h3 class="hasAnchor"><span class="header-section-number">6.5.1</span> Đọc file Pickle<a href="#%C4%91%E1%BB%8Dc-file-pickle-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="xuất-file-pickle-1" class="section level3 hasAnchor" number="6.5.2">
<h3 class="hasAnchor"><span class="header-section-number">6.5.2</span> Xuất file Pickle<a href="#xu%E1%BA%A5t-file-pickle-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!--chapter:end:posts/02-IO/05-Pickle.Rmd-->
</div>
</div>
</div>
<div id="Chuong-3" class="section level1 hasAnchor" number="7">
<h1 class="hasAnchor"><span class="header-section-number">7</span> Một số hàm cơ bản<a href="#Chuong-3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb189"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;https://raw.githubusercontent.com/lhduc94/kungfupandas/master/data/sales_subset.csv&#39;</span>,index_col<span class="op">=</span>[<span class="st">&#39;Unnamed: 0&#39;</span>])</span></code></pre></div>
<div id="head-và-.tail" class="section level2 hasAnchor" number="7.1">
<h2 class="hasAnchor"><span class="header-section-number">7.1</span> <code>.head()</code> và <code>.tail()</code><a href="#head-v%C3%A0-.tail" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.head(n=5)</code> hiển thị <code>n</code> dòng đầu tiên của <code>DataFrame</code>, ngược lại phương thức <code>.tail(n=5)</code> hiển thị <code>n</code> dòng cuối cùng của <code>DataFrame</code></p>
<div class="sourceCode" id="cb190"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb190-1"><a href="#cb190-1" tabindex="-1"></a>df.head()</span></code></pre></div>
<pre class="python_output"><code>        store type  department        date  weekly_sales  is_holiday  \
0      1    A           1  2010-02-05      24924.50       False   
1      1    A           1  2010-03-05      21827.90       False   
2      1    A           1  2010-04-02      57258.43       False   
3      1    A           1  2010-05-07      17413.94       False   
4      1    A           1  2010-06-04      17558.09       False 

   temperature_c  fuel_price_usd_per_l  unemployment  
0       5.727778              0.679451         8.106  
1       8.055556              0.693452         8.106  
2      16.816667              0.718284         7.808  
3      22.527778              0.748928         7.808  
4      27.050000              0.714586         7.808  </code></pre>
<div class="sourceCode" id="cb192"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb192-1"><a href="#cb192-1" tabindex="-1"></a>df.tail()</span></code></pre></div>
<pre class="python_output"><code>       store type  department        date  weekly_sales  is_holiday  \
10769     39    A          99  2011-12-09        895.00       False   
10770     39    A          99  2012-02-03        350.00       False   
10771     39    A          99  2012-06-08        450.00       False   
10772     39    A          99  2012-07-13          0.06       False   
10773     39    A          99  2012-10-05        915.00       False   

       temperature_c  fuel_price_usd_per_l  unemployment  
10769       9.644444              0.834256         7.716  
10770      15.938889              0.887619         7.244  
10771      27.288889              0.911922         6.989  
10772      25.644444              0.860145         6.623  
10773      22.250000              0.955511         6.228 
</code></pre>
</div>
<div id="shape-và-.size" class="section level2 hasAnchor" number="7.2">
<h2 class="hasAnchor"><span class="header-section-number">7.2</span> <code>.shape</code> và <code>.size</code><a href="#shape-v%C3%A0-.size" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.shape</code> cho biết số lượng dòng và cột của bảng</p>
<div class="sourceCode" id="cb194"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb194-1"><a href="#cb194-1" tabindex="-1"></a>df.shape</span></code></pre></div>
<pre class="python_output"><code>(10774, 9)</code></pre>
<p>Trong dó <code>10774</code> là số lượng dòng của bảng và <code>9</code> là số lượng cột của bảng</p>
<p>Phương thức <code>.size</code> cho biết số lượng phần từ của bảng</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb196-1"><a href="#cb196-1" tabindex="-1"></a>df.size</span></code></pre></div>
<pre class="python_output"><code>96966</code></pre>
</div>
<div id="info" class="section level2 hasAnchor" number="7.3">
<h2 class="hasAnchor"><span class="header-section-number">7.3</span> <code>.info()</code><a href="#info" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.info()</code> dùng để xem một số thông tin cơ bản như</p>
<ul>
<li>Index của bảng</li>
<li>Tên các cột, số lượng các phần tử Null trong cột và kiểu dữ liệu của chúng</li>
<li>Số lượng các kiểu dữ liệu</li>
<li>Dung lượng của bảng</li>
</ul>
<p>Ví dụ</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" tabindex="-1"></a>df.info()</span></code></pre></div>
<pre class="python_output"><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 10774 entries, 0 to 10773
Data columns (total 9 columns):
 #   Column                Non-Null Count  Dtype  
---  ------                --------------  -----  
 0   store                 10774 non-null  int64  
 1   type                  10774 non-null  object 
 2   department            10774 non-null  int64  
 3   date                  10774 non-null  object 
 4   weekly_sales          10774 non-null  float64
 5   is_holiday            10774 non-null  bool   
 6   temperature_c         10774 non-null  float64
 7   fuel_price_usd_per_l  10774 non-null  float64
 8   unemployment          10774 non-null  float64
dtypes: bool(1), float64(4), int64(2), object(2)
memory usage: 768.1+ KB</code></pre>

<div class="rmdtip">
<strong><em>Mẹo:</em></strong>
Phương thức <code>.info()</code> có các tham số để tùy chỉnh các thông tin có thể xem. Bạn có thể giới hạn các thông tin theo các tham số dưới đây
<code>info(verbose=None, buf=None, max_cols=None, memory_usage=None, show_counts=None, null_counts=None)</code>
</div>
</div>
<div id="describe" class="section level2 hasAnchor" number="7.4">
<h2 class="hasAnchor"><span class="header-section-number">7.4</span> <code>.describe()</code><a href="#describe" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.describe()</code> đưa ra một số thống kê đơn giản như <code>count</code>, <code>mean</code>, <code>std</code>, <code>min</code>, <code>max</code> và <code>percentiles = [0.25, 0.5, 0.75]</code>. Phương thức này chỉ áp dụng cho các cột ở dạng <code>numerical</code>.</p>
<div class="sourceCode" id="cb200"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" tabindex="-1"></a>df.describe()</span></code></pre></div>
<pre class="python_output"><code>              store    department   weekly_sales  temperature_c  \
count  10774.000000  10774.000000   10774.000000   10774.000000   
mean      15.441897     45.218118   23843.950149      15.731978   
std       11.534511     29.867779   30220.387557       9.922446   
min        1.000000      1.000000   -1098.000000      -8.366667   
25%        4.000000     20.000000    3867.115000       7.583333   
50%       13.000000     40.000000   12049.065000      16.966667   
75%       20.000000     72.000000   32349.850000      24.166667   
max       39.000000     99.000000  293966.050000      33.827778   

       fuel_price_usd_per_l  unemployment  
count          10774.000000  10774.000000  
mean               0.749746      8.082009  
std                0.059494      0.624355  
min                0.664129      3.879000  
25%                0.708246      7.795000  
50%                0.743381      8.099000  
75%                0.781421      8.360000  
max                1.107674      9.765000  </code></pre>

<div class="rmdtip">
<strong><em>Mẹo:</em></strong>
Bạn có thể thay đổi thông số percentiles bằng cách truyền tham số này vào trong <code>.describe()</code>
</div>
<p><strong>Ví dụ</strong></p>
<div class="sourceCode" id="cb202"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb202-1"><a href="#cb202-1" tabindex="-1"></a>df.describe(percentiles<span class="op">=</span>[<span class="fl">0.1</span>, <span class="fl">0.99</span>])</span></code></pre></div>
<pre class="python_output"><code>              store    department   weekly_sales  temperature_c  \
count  10774.000000  10774.000000   10774.000000   10774.000000   
mean      15.441897     45.218118   23843.950149      15.731978   
std       11.534511     29.867779   30220.387557       9.922446   
min        1.000000      1.000000   -1098.000000      -8.366667   
10%        2.000000      8.000000     607.695000       2.577778   
50%       13.000000     40.000000   12049.065000      16.966667   
99%       39.000000     99.000000  142193.400300      32.388889   
max       39.000000     99.000000  293966.050000      33.827778   

       fuel_price_usd_per_l  unemployment  
count          10774.000000  10774.000000  
mean               0.749746      8.082009  
std                0.059494      0.624355  
min                0.664129      3.879000  
10%                0.687640      7.127000  
50%                0.743381      8.099000  
99%                0.978565      9.765000  
max                1.107674      9.765000   </code></pre>

<div class="rmdnote">
<strong><em>Lưu ý:</em></strong>
<code>pandas</code> mặc định tính thêm percentile tại <code>0.5</code> dù không truyền vào
</div>
</div>
<div id="index" class="section level2 hasAnchor" number="7.5">
<h2 class="hasAnchor"><span class="header-section-number">7.5</span> <code>.index</code><a href="#index" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Thuộc tính <code>.index</code> để lấy index của <code>DataFrame</code> hoặc <code>Series</code>.</p>
<p>Ví dụ</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb204-1"><a href="#cb204-1" tabindex="-1"></a>df.index</span></code></pre></div>
<pre class="python_output"><code>Int64Index([    0,     1,     2,     3,     4,     5,     6,     7,     8,
                9,
            ...
            10764, 10765, 10766, 10767, 10768, 10769, 10770, 10771, 10772,
            10773],
           dtype=&#39;int64&#39;, length=10774)</code></pre>
</div>
<div id="memory_usage" class="section level2 hasAnchor" number="7.6">
<h2 class="hasAnchor"><span class="header-section-number">7.6</span> <code>.memory_usage()</code><a href="#memory_usage" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.memory_usage(index=True, deep=False)</code> giúp thông kê dung lượng của từng cột. Trong đó <code>index</code> trả về dung lượng của phần đánh index và <code>deep</code> nếu đặt giá trị <code>True</code> sẽ trả về cách tính toán sâu hơn về bộ nhớ cho kiểu <code>object</code></p>
<p>Ví dụ</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" tabindex="-1"></a>df.memory_usage(index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<pre class="python_output"><code>store                   86192
type                    86192
department              86192
date                    86192
weekly_sales            86192
is_holiday              10774
temperature_c           86192
fuel_price_usd_per_l    86192
unemployment            86192
dtype: int64</code></pre>
<div class="sourceCode" id="cb208"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" tabindex="-1"></a>df.memory_usage(deep<span class="op">=</span><span class="va">True</span>) </span></code></pre></div>
<pre class="python_output"><code>Index                    86192
store                    86192
type                    624892
department               86192
date                    721858
weekly_sales             86192
is_holiday               10774
temperature_c            86192
fuel_price_usd_per_l     86192
unemployment             86192
dtype: int64</code></pre>
</div>
<div id="lấy-series-trong-pandas" class="section level2 hasAnchor" number="7.7">
<h2 class="hasAnchor"><span class="header-section-number">7.7</span> Lấy Series trong pandas<a href="#l%E1%BA%A5y-series-trong-pandas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Sử dụng <code>[&lt;tên cột&gt;]</code> để lấy 1 Series của bảng. Ví dụ để lấy Series của cột <code>department</code> ta làm như sau</p>
<div class="sourceCode" id="cb210"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" tabindex="-1"></a>df[<span class="st">&#39;department&#39;</span>]</span></code></pre></div>
<pre class="python_output"><code>0         1
1         1
2         1
3         1
4         1
         ..
10769    99
10770    99
10771    99
10772    99
10773    99
Name: department, Length: 10774, dtype: int64</code></pre>
<p>những Series này cũng có thế áp dụng các phương thức tương tự của <code>DataFrame</code> như <code>.head()</code>, <code>.tail()</code>….</p>
</div>
<div id="astype" class="section level2 hasAnchor" number="7.8">
<h2 class="hasAnchor"><span class="header-section-number">7.8</span> <code>.astype()</code><a href="#astype" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Với phương thức <code>.astype()</code> ta có thể ép kiểu dữ liệu của cột về dạng khác. Việc ép kiểu này giúp thay đổi kiểu dữ liệu để tiện các thao tác như nối 2 cột có 2 kiểu <code>str</code> và <code>int</code>, ngoài ra việc ép kiểu cũng giúp giảm được dung lượng bộ nhớ dành cho bảng.</p>
<p>Ở ví dụ trên, ta thấy cột <code>department</code> có giá trị max là <code>99</code> nhưng được mặc định là <code>int64</code> khá lãng phí, do đó ép kiểu về <code>int8</code></p>
<p><strong>Trước khi ép kiểu</strong></p>
<div class="sourceCode" id="cb212"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" tabindex="-1"></a>df[<span class="st">&#39;department&#39;</span>].dtypes</span></code></pre></div>
<pre class="python_output"><code>dtype(&#39;int64&#39;)</code></pre>
<div class="sourceCode" id="cb214"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb214-1"><a href="#cb214-1" tabindex="-1"></a>df[<span class="st">&#39;department&#39;</span>].memory_usage() <span class="op">-</span> df[<span class="st">&#39;department&#39;</span>].index.memory_usage()</span></code></pre></div>
<pre class="python_output"><code>86192</code></pre>
<p><strong>Sau khi ép kiểu</strong></p>
<div class="sourceCode" id="cb216"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb216-1"><a href="#cb216-1" tabindex="-1"></a>df[<span class="st">&#39;department&#39;</span>].astype(<span class="st">&#39;int8&#39;</span>).memory_usage() <span class="op">-</span> df[<span class="st">&#39;department&#39;</span>].index.memory_usage()</span></code></pre></div>
<pre class="python_output"><code>10774</code></pre>
<p>Ta thấy sau khi ép kiểu thì bộ nhớ lưu trữ của cột <code>department</code> giảm đi <code>8</code> lần.</p>

<div class="rmdnote">
<strong><em>Lưu ý:</em></strong>
<code>df['department'].memory_usage()</code> trả về dung lượng lưu trữ của cột <code>department</code> và dung lượng lưu trữ của <code>index</code>
</div>
</div>
<div id="drop_duplicates" class="section level2 hasAnchor" number="7.9">
<h2 class="hasAnchor"><span class="header-section-number">7.9</span> <code>.drop_duplicates()</code><a href="#drop_duplicates" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức này trả về <code>DataFrame</code> đã được loại bỏ các hàng trùng nhau.
Lệnh thực hiện</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb218-1"><a href="#cb218-1" tabindex="-1"></a>DataFrame.drop_duplicates(subset<span class="op">=</span><span class="va">None</span>, keep<span class="op">=</span><span class="st">&#39;first&#39;</span>, inplace<span class="op">=</span><span class="va">False</span>, ignore_index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>subset</code>: tên cột hoặc danh sách các cột cần lọc giá trị trùng lặp, nếu không truyền vào sẽ mặc định chọn tất cả các cột</p></li>
<li><p><code>keep</code>: các kiểu lọc <code>duplicate</code> bao gồm các lựa chọn sau:</p>
<ul>
<li><code>'first'</code>: loại bỏ các dòng bản sao, chỉ giữ lại dòng đầu tiên</li>
<li><code>'last'</code>: loại bỏ các dòng bản sao, chỉ giữ lại dòng cuối cùng</li>
<li><code>False</code>: loại tất cả các dòng trùng lặp</li>
</ul></li>
<li><p><code>inplace</code>: thao tác trực tiếp trên bảng nếu để giá trị <code>True</code> hoặc tạo 1 bản sao với giá trị <code>False</code></p></li>
<li><p><code>ignore_index</code>: Nếu <code>True</code> trả về index đánh số lại từ <code>0</code> đến <code>n-1</code></p></li>
</ul>
<p><strong>Ví dụ</strong></p>
<div class="sourceCode" id="cb219"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb219-1"><a href="#cb219-1" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb219-2"><a href="#cb219-2" tabindex="-1"></a>    <span class="st">&#39;action&#39;</span>: [<span class="st">&#39;view&#39;</span>, <span class="st">&#39;view&#39;</span>, <span class="st">&#39;add to cart&#39;</span>, <span class="st">&#39;add to cart&#39;</span>, <span class="st">&#39;add to cart&#39;</span>,],</span>
<span id="cb219-3"><a href="#cb219-3" tabindex="-1"></a>    <span class="st">&#39;fruit&#39;</span>: [<span class="st">&#39;orange&#39;</span>, <span class="st">&#39;orange&#39;</span>, <span class="st">&#39;orange&#39;</span>, <span class="st">&#39;apple&#39;</span>, <span class="st">&#39;apple&#39;</span>],</span>
<span id="cb219-4"><a href="#cb219-4" tabindex="-1"></a>    <span class="st">&#39;times&#39;</span>:   [ <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>]</span>
<span id="cb219-5"><a href="#cb219-5" tabindex="-1"></a>})</span>
<span id="cb219-6"><a href="#cb219-6" tabindex="-1"></a>df</span></code></pre></div>
<pre class="python_output"><code>        action  fruit   times
0         view  orange      1
1         view  orange      1
2  add to cart  orange      3
3  add to cart   apple      2
4  add to cart   apple      4</code></pre>
<div class="sourceCode" id="cb221"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb221-1"><a href="#cb221-1" tabindex="-1"></a>df.drop_duplicates()</span></code></pre></div>
<pre class="python_output"><code>        action  fruit   times
0         view  orange      1
2  add to cart  orange      3
3  add to cart   apple      2
4  add to cart   apple      4</code></pre>
<div class="sourceCode" id="cb223"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb223-1"><a href="#cb223-1" tabindex="-1"></a>df.drop_duplicates(subset<span class="op">=</span>[<span class="st">&#39;action&#39;</span>])</span></code></pre></div>
<pre class="python_output"><code>        action  fruit   times
0         view  orange      1
2  add to cart  orange      3</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb225-1"><a href="#cb225-1" tabindex="-1"></a>df.drop_duplicates(subset<span class="op">=</span>[<span class="st">&#39;action&#39;</span>,<span class="st">&#39;fruit&#39;</span>], keep<span class="op">=</span><span class="st">&#39;last&#39;</span>, ignore_index<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<pre class="python_output"><code>        action   fruit  times
0         view  orange      1
1  add to cart  orange      3
2  add to cart   apple      4
</code></pre>
</div>
<div id="value_counts" class="section level2 hasAnchor" number="7.10">
<h2 class="hasAnchor"><span class="header-section-number">7.10</span> <code>.value_counts()</code><a href="#value_counts" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức này trả số lần xuất hiện của các phần tử trong <code>Series</code>. Kết quả trả về mặc định sẽ sắp xếp theo số lần xuất hiện giảm dần và mặc định bỏ qua các giá trị null</p>
<div class="sourceCode" id="cb227"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb227-1"><a href="#cb227-1" tabindex="-1"></a>Series.value_counts(normalize<span class="op">=</span><span class="va">False</span>, sort<span class="op">=</span><span class="va">True</span>, ascending<span class="op">=</span><span class="va">False</span>, bins<span class="op">=</span><span class="va">None</span>, dropna<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>normalize</code>: <code>True</code> sẽ trả về tỉ lệ xuất hiện của các phần tử</p></li>
<li><p><code>sort</code>: <code>True</code> sẽ trả về kết quả sắp xếp theo số lần xuất hiện, <code>False</code> sẽ trả về kết quả sắp xếp theo trình tự xuất hiện của phần tử</p></li>
<li><p><code>ascending</code>: <code>True</code> sẽ trả về kết quả sắp xếp theo số lần xuất hiện tăng dần.</p></li>
<li><p><code>bins</code>: gom nhóm các phần tử, tương tự <code>pd.cut</code></p></li>
<li><p><code>dropna</code>: <code>False</code> sẽ đếm tất cả các phần tử kể cả null</p></li>
</ul>
<p><strong>Ví dụ</strong></p>
<div class="sourceCode" id="cb228"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb228-1"><a href="#cb228-1" tabindex="-1"></a>s <span class="op">=</span> pd.Series([<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>,  np.nan, <span class="dv">4</span>, np.nan])</span>
<span id="cb228-2"><a href="#cb228-2" tabindex="-1"></a>s.value_counts()</span></code></pre></div>
<pre class="python_output"><code>3.0    2
1.0    1
2.0    1
4.0    1
dtype: int64</code></pre>
<div class="sourceCode" id="cb230"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb230-1"><a href="#cb230-1" tabindex="-1"></a>s.value_counts(normalize<span class="op">=</span><span class="va">True</span>, sort<span class="op">=</span><span class="va">False</span>, dropna<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<pre class="python_output"><code>3.0    0.285714
1.0    0.142857
2.0    0.142857
NaN    0.285714
4.0    0.142857
dtype: float64</code></pre>
<div class="sourceCode" id="cb232"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb232-1"><a href="#cb232-1" tabindex="-1"></a>s.value_counts(bins<span class="op">=</span><span class="dv">3</span>)</span></code></pre></div>
<pre class="python_output"><code>(0.996, 2.0]    2
(2.0, 3.0]      2
(3.0, 4.0]      1
dtype: int64</code></pre>
</div>
<div id="unique-và-.nunique" class="section level2 hasAnchor" number="7.11">
<h2 class="hasAnchor"><span class="header-section-number">7.11</span> <code>.unique()</code> và <code>.nunique()</code><a href="#unique-v%C3%A0-.nunique" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.unique()</code> trả về các giá trị khác nhau của <code>Series</code> và <code>.nunique()</code> trả về số lượng các giá trị khác nhau của <code>Series</code>. Kết quả trả về của <code>.unique()</code> là danh sách các phần tử được sắp xếp theo thứ tự đầu vào của bảng. Để loại bỏ giá trị <code>NA</code> trong lúc đếm có thể gọi <code>.nunique(dropna=False)</code></p>
<p>Cách sử dụng</p>
<div class="sourceCode" id="cb234"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb234-1"><a href="#cb234-1" tabindex="-1"></a>s <span class="op">=</span> pd.Series([<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span> ,<span class="dv">2</span>, np.nan], name<span class="op">=</span><span class="st">&#39;col_0&#39;</span>)</span>
<span id="cb234-2"><a href="#cb234-2" tabindex="-1"></a>s</span></code></pre></div>
<pre class="python_output"><code>0    2.0
1    3.0
2    1.0
3    2.0
4    NaN
Name: col_0, dtype: float64</code></pre>
<div class="sourceCode" id="cb236"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb236-1"><a href="#cb236-1" tabindex="-1"></a>s.unique()</span></code></pre></div>
<pre class="python_output"><code>array([ 2.,  3.,  1., nan])</code></pre>
<div class="sourceCode" id="cb238"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb238-1"><a href="#cb238-1" tabindex="-1"></a>s.nunique(dropna<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<pre class="python_output"><code>4</code></pre>
</div>
<div id="drop" class="section level2 hasAnchor" number="7.12">
<h2 class="hasAnchor"><span class="header-section-number">7.12</span> <code>.drop()</code><a href="#drop" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.drop()</code> dùng để loại bỏ các dòng hoặc cột theo chỉ định.
Cú pháp của <code>.drop()</code> như sau</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb240-1"><a href="#cb240-1" tabindex="-1"></a>DataFrame.drop(labels<span class="op">=</span><span class="va">None</span>, axis<span class="op">=</span><span class="dv">0</span>, index<span class="op">=</span><span class="va">None</span>, columns<span class="op">=</span><span class="va">None</span>, level<span class="op">=</span><span class="va">None</span>, inplace<span class="op">=</span><span class="va">False</span>, errors<span class="op">=</span><span class="st">&#39;raise&#39;</span>)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>labels</code>: Tên cột hoặc dòng cần loại bỏ.</p></li>
<li><p><code>axis</code>: Mặc đinh giá trị <code>0</code> loại bỏ theo dòng và <code>1</code> loại bỏ theo cột.</p></li>
<li><p><code>index</code>: Chỉ định index của dòng cần loại bỏ, tương đương <code>labels, axis=0</code></p></li>
<li><p><code>columns</code>: Chỉ định cột cần loại bỏ, tương đương <code>labels, axis=1</code></p></li>
<li><p><code>level</code>: Dành cho MultiIndex, khi đó chỉ định cấp độ index cần loại bỏ</p></li>
<li><p><code>inplace</code>: Thực hiện trên chính bảng hay tạo ra một bảng sao</p></li>
<li><p><code>errors</code>: mặc định <code>raise</code> sẽ trả ra lỗi và <code>ignore</code> nếu muốn bỏ qua lỗi.</p></li>
</ul>
<p><strong>Ví dụ</strong></p>
<div class="sourceCode" id="cb241"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb241-1"><a href="#cb241-1" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(np.arange(<span class="dv">16</span>).reshape(<span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb241-2"><a href="#cb241-2" tabindex="-1"></a>                  columns<span class="op">=</span>[<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>, <span class="st">&#39;C&#39;</span>, <span class="st">&#39;D&#39;</span>],</span>
<span id="cb241-3"><a href="#cb241-3" tabindex="-1"></a>                  index<span class="op">=</span>[<span class="st">&#39;A&#39;</span>, <span class="st">&#39;1A&#39;</span>, <span class="st">&#39;2A&#39;</span>, <span class="st">&#39;3A&#39;</span>])</span>
<span id="cb241-4"><a href="#cb241-4" tabindex="-1"></a>df</span></code></pre></div>
<pre class="python_output"><code>     A   B   C   D
A    0   1   2   3
1A   4   5   6   7
2A   8   9  10  11
3A  12  13  14  15</code></pre>
<div class="sourceCode" id="cb243"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb243-1"><a href="#cb243-1" tabindex="-1"></a>df.drop(<span class="st">&#39;A&#39;</span>)</span></code></pre></div>
<pre class="python_output"><code>    A   B   C   D
1A  4   5   6   7
2A  8   9   10  11
3A  12  13  14  15</code></pre>
<div class="sourceCode" id="cb245"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb245-1"><a href="#cb245-1" tabindex="-1"></a>df.drop(columns<span class="op">=</span>[<span class="st">&#39;A&#39;</span>, <span class="st">&#39;C&#39;</span>])</span></code></pre></div>
<pre class="python_output"><code>     B   D
A    1   3
1A   5   7
2A   9  11
3A  13  15</code></pre>
<div class="sourceCode" id="cb247"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb247-1"><a href="#cb247-1" tabindex="-1"></a>df.drop(index<span class="op">=</span>[<span class="st">&#39;A&#39;</span>, <span class="st">&#39;2A&#39;</span>])</span></code></pre></div>
<pre class="python_output"><code>     A   B   C   D
1A   4   5   6   7
3A  12  13  14  15</code></pre>

<div class="rmdnote">
<strong><em>Lưu ý:</em></strong>
Thực tế hay dùng các params <code>columns</code> và <code>index</code> để chỉ định các dòng hay cột cần được loại bỏ hơn là dùng <code>labels</code> và <code>axis</code>
</div>
</div>
<div id="rename" class="section level2 hasAnchor" number="7.13">
<h2 class="hasAnchor"><span class="header-section-number">7.13</span> <code>.rename()</code><a href="#rename" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.rename()</code> dùng để đổi tên nhãn của cột hoặc dòng. Cú pháp như sau</p>
<div class="sourceCode" id="cb249"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb249-1"><a href="#cb249-1" tabindex="-1"></a>DataFrame.rename(mapper<span class="op">=</span><span class="va">None</span>, <span class="op">*</span>, index<span class="op">=</span><span class="va">None</span>, columns<span class="op">=</span><span class="va">None</span>, axis<span class="op">=</span><span class="va">None</span>, copy<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">False</span>, level<span class="op">=</span><span class="va">None</span>, errors<span class="op">=</span><span class="st">&#39;ignore&#39;</span>)[source]</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>mapper</code>: là một danh sách dạng dictionary chứa key là tên cần đổi và value là tên mới.</p></li>
<li><p><code>axis</code>: Mặc đinh giá trị <code>0</code> thay đổi theo index và <code>1</code> thay đổi theo cột.</p></li>
<li><p><code>index</code>: Chỉ định index của dòng cần thay đổi, tương đương <code>mapper, axis=0</code>, thay thế bằng <code>index=mapper</code></p></li>
<li><p><code>columns</code>: Chỉ định cột cần thay đổi, tương đương <code>mapper, axis=1</code>, thay thế bằng <code>columns=mapper</code></p></li>
<li><p><code>copy</code>: <code>True</code>, mặc định sao chép dữ liệu</p></li>
<li><p><code>level</code>: Dành cho MultiIndex, khi đó chỉ định cấp độ index cần đổi tên</p></li>
<li><p><code>inplace</code>: Thực hiện trên chính bảng hay tạo ra một bảng sao</p></li>
<li><p><code>errors</code>: mặc định <code>raise</code> sẽ trả ra lỗi và <code>ignore</code> nếu muốn bỏ qua lỗi.</p></li>
</ul>
<p><strong>Ví dụ</strong></p>
<div class="sourceCode" id="cb250"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb250-1"><a href="#cb250-1" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(np.arange(<span class="dv">16</span>).reshape(<span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb250-2"><a href="#cb250-2" tabindex="-1"></a>                        columns<span class="op">=</span>[<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>, <span class="st">&#39;C&#39;</span>, <span class="st">&#39;D&#39;</span>],</span>
<span id="cb250-3"><a href="#cb250-3" tabindex="-1"></a>                        index<span class="op">=</span>[<span class="st">&#39;A&#39;</span>, <span class="st">&#39;1A&#39;</span>, <span class="st">&#39;2A&#39;</span>, <span class="st">&#39;3A&#39;</span>])</span>
<span id="cb250-4"><a href="#cb250-4" tabindex="-1"></a>df.rename(mapper<span class="op">=</span>{<span class="st">&#39;A&#39;</span>:<span class="st">&#39;aA&#39;</span>})</span></code></pre></div>
<pre class="python_output"><code>     A   B   C   D
aA   0   1   2   3
1A   4   5   6   7
2A   8   9  10  11
3A  12  13  14  15</code></pre>
<div class="sourceCode" id="cb252"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb252-1"><a href="#cb252-1" tabindex="-1"></a>df.rename(mapper<span class="op">=</span>{<span class="st">&#39;A&#39;</span>:<span class="st">&#39;aA&#39;</span>}, axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<pre class="python_output"><code>    aA   B   C   D
A    0   1   2   3
1A   4   5   6   7
2A   8   9  10  11
3A  12  13  14  15</code></pre>
<div class="sourceCode" id="cb254"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb254-1"><a href="#cb254-1" tabindex="-1"></a>df.rename(columns<span class="op">=</span>{<span class="st">&#39;A&#39;</span>:<span class="st">&#39;aA&#39;</span>, <span class="st">&#39;B&#39;</span>:<span class="st">&#39;Bb&#39;</span>}, index<span class="op">=</span>{<span class="st">&#39;A&#39;</span>: <span class="st">&#39;OA&#39;</span>,<span class="st">&#39;3A&#39;</span>:<span class="st">&#39;3a&#39;</span>})</span></code></pre></div>
<pre class="python_output"><code>    aA  Bb   C   D
OA   0   1   2   3
1A   4   5   6   7
2A   8   9  10  11
3a  12  13  14  15</code></pre>

<div class="rmdnote">
<p><strong><em>Lưu ý:</em></strong>
Tương tự như <code>.drop()</code> thì <code>columns</code> và <code>index</code> thường được sử dụng hơn là <code>mapper</code> và <code>axis</code>.</p>
Vẫn chưa rõ <code>copy</code> dùng để làm gì.
</div>
</div>
<div id="set_index" class="section level2 hasAnchor" number="7.14">
<h2 class="hasAnchor"><span class="header-section-number">7.14</span> <code>.set_index()</code><a href="#set_index" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.set_index()</code> dùng để chuyển đổi một cột của bảng thành index. Index này có thể thay thể index cũ hoặc thêm vào để thành <code>MultiIndex</code>. Cách sử dụng như sau:</p>
<div class="sourceCode" id="cb256"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb256-1"><a href="#cb256-1" tabindex="-1"></a>DataFrame.set_index(keys, drop<span class="op">=</span><span class="va">True</span>, append<span class="op">=</span><span class="va">False</span>, inplace<span class="op">=</span><span class="va">False</span>, verify_integrity<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>keys</code>: Có thể truyền vào một cột duy nhất hoặc danh sách các cột. Ngoài ra còn có thể là 1 danh sách dạng <code>pd.Index</code>, <code>Series</code>, <code>np.array</code>, <code>iterator</code></p></li>
<li><p><code>drop</code>: loại bỏ cột trong bảng nếu đã đưa vào index, mặc định là <code>True</code></p></li>
<li><p><code>append</code>: mặc định là <code>False</code> ghi đè lên index đã có. Giá trị <code>True</code> sẽ thêm vào index sẵn có.</p></li>
<li><p><code>inplace</code>: Thực hiện trực tiếp trên bảng hoặc tạo ra một bản sao</p></li>
<li><p><code>verify_integrity</code>: Kiểm tra xem cột đánh index có chứa các phần tử trùng lặp hay không.</p></li>
</ul>
<p><strong>Ví dụ</strong></p>
<div class="sourceCode" id="cb257"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb257-1"><a href="#cb257-1" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(np.arange(<span class="dv">16</span>).reshape(<span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb257-2"><a href="#cb257-2" tabindex="-1"></a>                  columns<span class="op">=</span>[<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>, <span class="st">&#39;C&#39;</span>, <span class="st">&#39;D&#39;</span>],</span>
<span id="cb257-3"><a href="#cb257-3" tabindex="-1"></a>                  index<span class="op">=</span>[<span class="st">&#39;A&#39;</span>, <span class="st">&#39;1A&#39;</span>, <span class="st">&#39;2A&#39;</span>, <span class="st">&#39;3A&#39;</span>])</span>
<span id="cb257-4"><a href="#cb257-4" tabindex="-1"></a>df.index.name <span class="op">=</span> <span class="st">&#39;index1&#39;</span></span>
<span id="cb257-5"><a href="#cb257-5" tabindex="-1"></a>df</span></code></pre></div>
<pre class="python_output"><code>         A   B   C   D
index1                
A        0   1   2   3
1A       4   5   6   7
2A       8   9  10  11
3A      12  13  14  15</code></pre>
<div class="sourceCode" id="cb259"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb259-1"><a href="#cb259-1" tabindex="-1"></a>df.set_index(<span class="st">&#39;A&#39;</span>)</span></code></pre></div>
<pre class="python_output"><code>     B   C   D
A             
0    1   2   3
4    5   6   7
8    9  10  11
12  13  14  15</code></pre>
<div class="sourceCode" id="cb261"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb261-1"><a href="#cb261-1" tabindex="-1"></a>df.set_index([<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>], append<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<pre class="python_output"><code>               C   D
index1 A  B         
A      0  1    2   3
1A     4  5    6   7
2A     8  9   10  11
3A     12 13  14  15</code></pre>
<div class="sourceCode" id="cb263"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb263-1"><a href="#cb263-1" tabindex="-1"></a>df.set_index([pd.Index([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>], name<span class="op">=</span><span class="st">&#39;new_index&#39;</span>)])</span></code></pre></div>
<pre class="python_output"><code>            A   B   C   D
new_index                
1           0   1   2   3
2           4   5   6   7
3           8   9  10  11
4          12  13  14  15</code></pre>

<div class="rmdnote">
<strong><em>Lưu ý:</em></strong>
<code>keys</code> không áp dụng cho kiểu <code>list</code>, <code>tuple</code> nhưng Iterator của nó thì được.
</div>
<p><strong>Ví dụ</strong> khi đưa list vào sẽ báo lỗi</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb265-1"><a href="#cb265-1" tabindex="-1"></a>df.set_index([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</span></code></pre></div>
<pre class="python_output"><code>---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
~\AppData\Local\Temp/ipykernel_1380/3577861036.py in &lt;module&gt;
----&gt; 1 df.set_index([1, 2, 3, 4])

D:\Vendors\anaconda\lib\site-packages\pandas\util\_decorators.py in wrapper(*args, **kwargs)
    309                     stacklevel=stacklevel,
    310                 )
--&gt; 311             return func(*args, **kwargs)
    312 
    313         return wrapper

D:\Vendors\anaconda\lib\site-packages\pandas\core\frame.py in set_index(self, keys, drop, append, inplace, verify_integrity)
   5492 
   5493         if missing:
-&gt; 5494             raise KeyError(f&quot;None of {missing} are in the columns&quot;)
   5495 
   5496         if inplace:

KeyError: &#39;None of [1, 2, 3, 4] are in the columns&#39;</code></pre>
<p>Trong khi đưa vào <code>Iterator</code> thì hoạt động.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb267-1"><a href="#cb267-1" tabindex="-1"></a>df.set_index(<span class="bu">iter</span>([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]))</span></code></pre></div>
<pre class="python_output"><code>    A   B   C   D
1   0   1   2   3
2   4   5   6   7
3   8   9  10  11
4  12  13  14  15</code></pre>
</div>
<div id="sort_index" class="section level2 hasAnchor" number="7.15">
<h2 class="hasAnchor"><span class="header-section-number">7.15</span> <code>.sort_index</code><a href="#sort_index" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="sort_values" class="section level2 hasAnchor" number="7.16">
<h2 class="hasAnchor"><span class="header-section-number">7.16</span> <code>.sort_values</code><a href="#sort_values" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.sort_values</code> dùng để sắp xếp dữ liệu trong DataFrame hoặc Series</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb269-1"><a href="#cb269-1" tabindex="-1"></a>DataFrame.sort_values(by, axis<span class="op">=</span><span class="dv">0</span>, ascending<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">False</span>, kind<span class="op">=</span><span class="st">&#39;quicksort&#39;</span>, na_position<span class="op">=</span><span class="st">&#39;last&#39;</span>, ignore_index<span class="op">=</span><span class="va">False</span>, key<span class="op">=</span><span class="va">None</span>)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>by</code> : nhãn hoặc danh sách nhãn cần sắp xếp</p></li>
<li><p><code>axis</code>: chỉ định chiều sắp xếp {<code>0</code> hoặc <code>index</code>, <code>1</code> hoặc <code>columns</code>}</p></li>
<li><p><code>ascending</code>: Sắp xếp tăng dần hoặc giảm dần, có thể là một giá trị hoặc danh sách các giá trị boolean</p></li>
<li><p><code>inplace</code>: Thực hiện trên chính bảng đó hoặc tạo ra một bản sao</p></li>
<li><p><code>kind</code>: Thuật toán sắp xếp</p></li>
<li><p><code>na_postion</code>: chỉ định các giá trị <code>NA</code> được xếp đầu hoặc cuôi</p></li>
<li><p><code>ignore_index</code>: Nếu để giá trị <code>True</code> sẽ thực hiện đánh index lại từ 0</p></li>
<li><p><code>key</code>: key function</p></li>
</ul>
<div class="sourceCode" id="cb270"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb270-1"><a href="#cb270-1" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb270-2"><a href="#cb270-2" tabindex="-1"></a>    <span class="st">&#39;col1&#39;</span>: [<span class="st">&#39;A&#39;</span>, <span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>, np.nan, <span class="st">&#39;D&#39;</span>, <span class="st">&#39;C&#39;</span>],</span>
<span id="cb270-3"><a href="#cb270-3" tabindex="-1"></a>    <span class="st">&#39;col2&#39;</span>: [<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">2</span>, <span class="dv">4</span>],</span>
<span id="cb270-4"><a href="#cb270-4" tabindex="-1"></a>    <span class="st">&#39;col3&#39;</span>: [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb270-5"><a href="#cb270-5" tabindex="-1"></a>    <span class="st">&#39;col4&#39;</span>: [<span class="st">&#39;a&#39;</span>, <span class="st">&#39;B&#39;</span>, <span class="st">&#39;c&#39;</span>, <span class="st">&#39;D&#39;</span>, <span class="st">&#39;e&#39;</span>, <span class="st">&#39;F&#39;</span>]</span>
<span id="cb270-6"><a href="#cb270-6" tabindex="-1"></a>})</span>
<span id="cb270-7"><a href="#cb270-7" tabindex="-1"></a>df</span></code></pre></div>
<pre class="python_output"><code>  col1  col2  col3 col4
0    A     2     0    a
1    A     1     1    B
2    B     9     9    c
3  NaN     8     4    D
4    D     2     2    e
5    C     4     3    F</code></pre>
<p>Sắp xếp theo <code>col1</code></p>
<div class="sourceCode" id="cb272"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb272-1"><a href="#cb272-1" tabindex="-1"></a>df.sort_values(by<span class="op">=</span>[<span class="st">&#39;col1&#39;</span>])</span></code></pre></div>
<pre class="python_output"><code>  col1  col2  col3 col4
0    A     2     0    a
1    A     1     1    B
2    B     9     9    c
5    C     4     3    F
4    D     2     2    e
3  NaN     8     4    D</code></pre>
<p>Sắp xếp theo nhiều cột</p>
<div class="sourceCode" id="cb274"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb274-1"><a href="#cb274-1" tabindex="-1"></a>df.sort_values(by<span class="op">=</span>[<span class="st">&#39;col1&#39;</span>, <span class="st">&#39;col2&#39;</span>])</span></code></pre></div>
<pre class="python_output"><code>  col1  col2  col3 col4
1    A     1     1    B
0    A     2     0    a
2    B     9     9    c
5    C     4     3    F
4    D     7     2    e
3  NaN     8     4    D</code></pre>
<p>Sắp xếp theo tăng giảm</p>
<div class="sourceCode" id="cb276"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb276-1"><a href="#cb276-1" tabindex="-1"></a>df.sort_values(by<span class="op">=</span>[<span class="st">&#39;col1&#39;</span>, <span class="st">&#39;col2&#39;</span>], ascending<span class="op">=</span>[<span class="va">False</span>, <span class="va">True</span>])</span></code></pre></div>
<pre class="python_output"><code>  col1  col2  col3 col4
4    D     2     2    e
5    C     4     3    F
2    B     9     9    c
1    A     1     1    B
0    A     2     0    a
3  NaN     8     4    D</code></pre>
<p>Thay đổi vị trí của <code>NaN</code></p>
<div class="sourceCode" id="cb278"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb278-1"><a href="#cb278-1" tabindex="-1"></a>df.sort_values(by<span class="op">=</span><span class="st">&#39;col1&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>, na_position<span class="op">=</span><span class="st">&#39;first&#39;</span>)</span></code></pre></div>
<pre class="python_output"><code>  col1  col2  col3 col4
3  NaN     8     4    D
4    D     2     2    e
5    C     4     3    F
2    B     9     9    c
0    A     2     0    a
1    A     1     1    B</code></pre>
<p>Sắp xếp với key function</p>
<div class="sourceCode" id="cb280"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb280-1"><a href="#cb280-1" tabindex="-1"></a>df.sort_values(by<span class="op">=</span><span class="st">&#39;col4&#39;</span>, key<span class="op">=</span><span class="kw">lambda</span> col: col.<span class="bu">str</span>.lower())</span></code></pre></div>
<pre class="python_output"><code>  col1  col2  col3 col4
0    A     2     0    a
1    A     1     1    B
2    B     9     9    c
3  NaN     8     4    D
4    D     2     2    e
5    C     4     3    F</code></pre>
<!--chapter:end:posts/03-Funda_Function.Rmd-->
</div>
</div>
<div id="Chuong-3" class="section level1 hasAnchor" number="8">
<h1 class="hasAnchor"><span class="header-section-number">8</span> Một số hàm cơ bản<a href="#Chuong-3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb282"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb282-1"><a href="#cb282-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;https://raw.githubusercontent.com/lhduc94/kungfupandas/master/data/sales_subset.csv&#39;</span>,index_col<span class="op">=</span>[<span class="st">&#39;Unnamed: 0&#39;</span>])</span></code></pre></div>
<!--chapter:end:posts/03-Fundamental_Function/00-Introduction.Rmd-->
<div id="head-và-.tail-1" class="section level2 hasAnchor" number="8.1">
<h2 class="hasAnchor"><span class="header-section-number">8.1</span> <code>.head()</code> và <code>.tail()</code><a href="#head-v%C3%A0-.tail-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.head(n=5)</code> hiển thị <code>n</code> dòng đầu tiên của <code>DataFrame</code>, ngược lại phương thức <code>.tail(n=5)</code> hiển thị <code>n</code> dòng cuối cùng của <code>DataFrame</code></p>
<div class="sourceCode" id="cb283"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb283-1"><a href="#cb283-1" tabindex="-1"></a>df.head()</span></code></pre></div>
<pre class="python_output"><code>        store type  department        date  weekly_sales  is_holiday  \
0      1    A           1  2010-02-05      24924.50       False   
1      1    A           1  2010-03-05      21827.90       False   
2      1    A           1  2010-04-02      57258.43       False   
3      1    A           1  2010-05-07      17413.94       False   
4      1    A           1  2010-06-04      17558.09       False 

   temperature_c  fuel_price_usd_per_l  unemployment  
0       5.727778              0.679451         8.106  
1       8.055556              0.693452         8.106  
2      16.816667              0.718284         7.808  
3      22.527778              0.748928         7.808  
4      27.050000              0.714586         7.808  </code></pre>
<div class="sourceCode" id="cb285"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb285-1"><a href="#cb285-1" tabindex="-1"></a>df.tail()</span></code></pre></div>
<pre class="python_output"><code>       store type  department        date  weekly_sales  is_holiday  \
10769     39    A          99  2011-12-09        895.00       False   
10770     39    A          99  2012-02-03        350.00       False   
10771     39    A          99  2012-06-08        450.00       False   
10772     39    A          99  2012-07-13          0.06       False   
10773     39    A          99  2012-10-05        915.00       False   

       temperature_c  fuel_price_usd_per_l  unemployment  
10769       9.644444              0.834256         7.716  
10770      15.938889              0.887619         7.244  
10771      27.288889              0.911922         6.989  
10772      25.644444              0.860145         6.623  
10773      22.250000              0.955511         6.228 
</code></pre>
<!--chapter:end:posts/03-Fundamental_Function/01-Head_Tail.Rmd-->
</div>
<div id="shape-và-.size-1" class="section level2 hasAnchor" number="8.2">
<h2 class="hasAnchor"><span class="header-section-number">8.2</span> <code>.shape</code> và <code>.size</code><a href="#shape-v%C3%A0-.size-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.shape</code> cho biết số lượng dòng và cột của bảng</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb287-1"><a href="#cb287-1" tabindex="-1"></a>df.shape</span></code></pre></div>
<pre class="python_output"><code>(10774, 9)</code></pre>
<p>Trong dó <code>10774</code> là số lượng dòng của bảng và <code>9</code> là số lượng cột của bảng</p>
<p>Phương thức <code>.size</code> cho biết số lượng phần từ của bảng</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb289-1"><a href="#cb289-1" tabindex="-1"></a>df.size</span></code></pre></div>
<pre class="python_output"><code>96966</code></pre>
<!--chapter:end:posts/03-Fundamental_Function/02-Shape_Size.Rmd-->
</div>
<div id="info-1" class="section level2 hasAnchor" number="8.3">
<h2 class="hasAnchor"><span class="header-section-number">8.3</span> <code>.info()</code><a href="#info-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.info()</code> dùng để xem một số thông tin cơ bản như</p>
<ul>
<li>Index của bảng</li>
<li>Tên các cột, số lượng các phần tử Null trong cột và kiểu dữ liệu của chúng</li>
<li>Số lượng các kiểu dữ liệu</li>
<li>Dung lượng của bảng</li>
</ul>
<p>Ví dụ</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb291-1"><a href="#cb291-1" tabindex="-1"></a>df.info()</span></code></pre></div>
<pre class="python_output"><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 10774 entries, 0 to 10773
Data columns (total 9 columns):
 #   Column                Non-Null Count  Dtype  
---  ------                --------------  -----  
 0   store                 10774 non-null  int64  
 1   type                  10774 non-null  object 
 2   department            10774 non-null  int64  
 3   date                  10774 non-null  object 
 4   weekly_sales          10774 non-null  float64
 5   is_holiday            10774 non-null  bool   
 6   temperature_c         10774 non-null  float64
 7   fuel_price_usd_per_l  10774 non-null  float64
 8   unemployment          10774 non-null  float64
dtypes: bool(1), float64(4), int64(2), object(2)
memory usage: 768.1+ KB</code></pre>

<div class="rmdtip">
<strong><em>Mẹo:</em></strong>
Phương thức <code>.info()</code> có các tham số để tùy chỉnh các thông tin có thể xem. Bạn có thể giới hạn các thông tin theo các tham số dưới đây
<code>info(verbose=None, buf=None, max_cols=None, memory_usage=None, show_counts=None, null_counts=None)</code>
</div>
<!--chapter:end:posts/03-Fundamental_Function/03-Info.Rmd-->
</div>
<div id="describe-1" class="section level2 hasAnchor" number="8.4">
<h2 class="hasAnchor"><span class="header-section-number">8.4</span> <code>.describe()</code><a href="#describe-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.describe()</code> đưa ra một số thống kê đơn giản như <code>count</code>, <code>mean</code>, <code>std</code>, <code>min</code>, <code>max</code> và <code>percentiles = [0.25, 0.5, 0.75]</code>. Phương thức này chỉ áp dụng cho các cột ở dạng <code>numerical</code>.</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb293-1"><a href="#cb293-1" tabindex="-1"></a>df.describe()</span></code></pre></div>
<pre class="python_output"><code>              store    department   weekly_sales  temperature_c  \
count  10774.000000  10774.000000   10774.000000   10774.000000   
mean      15.441897     45.218118   23843.950149      15.731978   
std       11.534511     29.867779   30220.387557       9.922446   
min        1.000000      1.000000   -1098.000000      -8.366667   
25%        4.000000     20.000000    3867.115000       7.583333   
50%       13.000000     40.000000   12049.065000      16.966667   
75%       20.000000     72.000000   32349.850000      24.166667   
max       39.000000     99.000000  293966.050000      33.827778   

       fuel_price_usd_per_l  unemployment  
count          10774.000000  10774.000000  
mean               0.749746      8.082009  
std                0.059494      0.624355  
min                0.664129      3.879000  
25%                0.708246      7.795000  
50%                0.743381      8.099000  
75%                0.781421      8.360000  
max                1.107674      9.765000  </code></pre>

<div class="rmdtip">
<strong><em>Mẹo:</em></strong>
Bạn có thể thay đổi thông số percentiles bằng cách truyền tham số này vào trong <code>.describe()</code>
</div>
<p><strong>Ví dụ</strong></p>
<div class="sourceCode" id="cb295"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb295-1"><a href="#cb295-1" tabindex="-1"></a>df.describe(percentiles<span class="op">=</span>[<span class="fl">0.1</span>, <span class="fl">0.99</span>])</span></code></pre></div>
<pre class="python_output"><code>              store    department   weekly_sales  temperature_c  \
count  10774.000000  10774.000000   10774.000000   10774.000000   
mean      15.441897     45.218118   23843.950149      15.731978   
std       11.534511     29.867779   30220.387557       9.922446   
min        1.000000      1.000000   -1098.000000      -8.366667   
10%        2.000000      8.000000     607.695000       2.577778   
50%       13.000000     40.000000   12049.065000      16.966667   
99%       39.000000     99.000000  142193.400300      32.388889   
max       39.000000     99.000000  293966.050000      33.827778   

       fuel_price_usd_per_l  unemployment  
count          10774.000000  10774.000000  
mean               0.749746      8.082009  
std                0.059494      0.624355  
min                0.664129      3.879000  
10%                0.687640      7.127000  
50%                0.743381      8.099000  
99%                0.978565      9.765000  
max                1.107674      9.765000   </code></pre>

<div class="rmdnote">
<strong><em>Lưu ý:</em></strong>
<code>pandas</code> mặc định tính thêm percentile tại <code>0.5</code> dù không truyền vào
</div>
<!--chapter:end:posts/03-Fundamental_Function/04-Describe.Rmd-->
</div>
<div id="index-1" class="section level2 hasAnchor" number="8.5">
<h2 class="hasAnchor"><span class="header-section-number">8.5</span> <code>.index</code><a href="#index-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Thuộc tính <code>.index</code> để lấy index của <code>DataFrame</code> hoặc <code>Series</code>.</p>
<p>Ví dụ</p>
<div class="sourceCode" id="cb297"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb297-1"><a href="#cb297-1" tabindex="-1"></a>df.index</span></code></pre></div>
<pre class="python_output"><code>Int64Index([    0,     1,     2,     3,     4,     5,     6,     7,     8,
                9,
            ...
            10764, 10765, 10766, 10767, 10768, 10769, 10770, 10771, 10772,
            10773],
           dtype=&#39;int64&#39;, length=10774)</code></pre>
<!--chapter:end:posts/03-Fundamental_Function/05-Index.Rmd-->
</div>
<div id="memory_usage-1" class="section level2 hasAnchor" number="8.6">
<h2 class="hasAnchor"><span class="header-section-number">8.6</span> <code>.memory_usage()</code><a href="#memory_usage-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.memory_usage(index=True, deep=False)</code> giúp thông kê dung lượng của từng cột. Trong đó <code>index</code> trả về dung lượng của phần đánh index và <code>deep</code> nếu đặt giá trị <code>True</code> sẽ trả về cách tính toán sâu hơn về bộ nhớ cho kiểu <code>object</code></p>
<p>Ví dụ</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb299-1"><a href="#cb299-1" tabindex="-1"></a>df.memory_usage(index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<pre class="python_output"><code>store                   86192
type                    86192
department              86192
date                    86192
weekly_sales            86192
is_holiday              10774
temperature_c           86192
fuel_price_usd_per_l    86192
unemployment            86192
dtype: int64</code></pre>
<div class="sourceCode" id="cb301"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb301-1"><a href="#cb301-1" tabindex="-1"></a>df.memory_usage(deep<span class="op">=</span><span class="va">True</span>) </span></code></pre></div>
<pre class="python_output"><code>Index                    86192
store                    86192
type                    624892
department               86192
date                    721858
weekly_sales             86192
is_holiday               10774
temperature_c            86192
fuel_price_usd_per_l     86192
unemployment             86192
dtype: int64</code></pre>
<!--chapter:end:posts/03-Fundamental_Function/06-Memory_Usage.Rmd-->
</div>
<div id="truy-cập-series-trong-pandas" class="section level2 hasAnchor" number="8.7">
<h2 class="hasAnchor"><span class="header-section-number">8.7</span> Truy cập Series trong pandas<a href="#truy-c%E1%BA%ADp-series-trong-pandas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Sử dụng <code>[&lt;tên cột&gt;]</code> để lấy 1 Series của bảng. Ví dụ để lấy Series của cột <code>department</code> ta làm như sau</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb303-1"><a href="#cb303-1" tabindex="-1"></a>df[<span class="st">&#39;department&#39;</span>]</span></code></pre></div>
<pre class="python_output"><code>0         1
1         1
2         1
3         1
4         1
         ..
10769    99
10770    99
10771    99
10772    99
10773    99
Name: department, Length: 10774, dtype: int64</code></pre>
<p>những Series này cũng có thế áp dụng các phương thức tương tự của <code>DataFrame</code> như <code>.head()</code>, <code>.tail()</code>….</p>
<!--chapter:end:posts/03-Fundamental_Function/07-Select_Series.Rmd-->
</div>
<div id="astype-1" class="section level2 hasAnchor" number="8.8">
<h2 class="hasAnchor"><span class="header-section-number">8.8</span> <code>.astype()</code><a href="#astype-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Với phương thức <code>.astype()</code> ta có thể ép kiểu dữ liệu của cột về dạng khác. Việc ép kiểu này giúp thay đổi kiểu dữ liệu để tiện các thao tác như nối 2 cột có 2 kiểu <code>str</code> và <code>int</code>, ngoài ra việc ép kiểu cũng giúp giảm được dung lượng bộ nhớ dành cho bảng.</p>
<p>Ở ví dụ trên, ta thấy cột <code>department</code> có giá trị max là <code>99</code> nhưng được mặc định là <code>int64</code> khá lãng phí, do đó ép kiểu về <code>int8</code></p>
<p><strong>Trước khi ép kiểu</strong></p>
<div class="sourceCode" id="cb305"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb305-1"><a href="#cb305-1" tabindex="-1"></a>df[<span class="st">&#39;department&#39;</span>].dtypes</span></code></pre></div>
<pre class="python_output"><code>dtype(&#39;int64&#39;)</code></pre>
<div class="sourceCode" id="cb307"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb307-1"><a href="#cb307-1" tabindex="-1"></a>df[<span class="st">&#39;department&#39;</span>].memory_usage() <span class="op">-</span> df[<span class="st">&#39;department&#39;</span>].index.memory_usage()</span></code></pre></div>
<pre class="python_output"><code>86192</code></pre>
<p><strong>Sau khi ép kiểu</strong></p>
<div class="sourceCode" id="cb309"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb309-1"><a href="#cb309-1" tabindex="-1"></a>df[<span class="st">&#39;department&#39;</span>].astype(<span class="st">&#39;int8&#39;</span>).memory_usage() <span class="op">-</span> df[<span class="st">&#39;department&#39;</span>].index.memory_usage()</span></code></pre></div>
<pre class="python_output"><code>10774</code></pre>
<p>Ta thấy sau khi ép kiểu thì bộ nhớ lưu trữ của cột <code>department</code> giảm đi <code>8</code> lần.</p>

<div class="rmdnote">
<strong><em>Lưu ý:</em></strong>
<code>df['department'].memory_usage()</code> trả về dung lượng lưu trữ của cột <code>department</code> và dung lượng lưu trữ của <code>index</code>
</div>
<!--chapter:end:posts/03-Fundamental_Function/08-Astype.Rmd-->
</div>
<div id="drop_duplicates-1" class="section level2 hasAnchor" number="8.9">
<h2 class="hasAnchor"><span class="header-section-number">8.9</span> <code>.drop_duplicates()</code><a href="#drop_duplicates-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức này trả về <code>DataFrame</code> đã được loại bỏ các hàng trùng nhau.
Lệnh thực hiện</p>
<div class="sourceCode" id="cb311"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb311-1"><a href="#cb311-1" tabindex="-1"></a>DataFrame.drop_duplicates(subset<span class="op">=</span><span class="va">None</span>, keep<span class="op">=</span><span class="st">&#39;first&#39;</span>, inplace<span class="op">=</span><span class="va">False</span>, ignore_index<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>subset</code>: tên cột hoặc danh sách các cột cần lọc giá trị trùng lặp, nếu không truyền vào sẽ mặc định chọn tất cả các cột</p></li>
<li><p><code>keep</code>: các kiểu lọc <code>duplicate</code> bao gồm các lựa chọn sau:</p>
<ul>
<li><code>'first'</code>: loại bỏ các dòng bản sao, chỉ giữ lại dòng đầu tiên</li>
<li><code>'last'</code>: loại bỏ các dòng bản sao, chỉ giữ lại dòng cuối cùng</li>
<li><code>False</code>: loại tất cả các dòng trùng lặp</li>
</ul></li>
<li><p><code>inplace</code>: thao tác trực tiếp trên bảng nếu để giá trị <code>True</code> hoặc tạo 1 bản sao với giá trị <code>False</code></p></li>
<li><p><code>ignore_index</code>: Nếu <code>True</code> trả về index đánh số lại từ <code>0</code> đến <code>n-1</code></p></li>
</ul>
<p><strong>Ví dụ</strong></p>
<div class="sourceCode" id="cb312"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb312-1"><a href="#cb312-1" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb312-2"><a href="#cb312-2" tabindex="-1"></a>    <span class="st">&#39;action&#39;</span>: [<span class="st">&#39;view&#39;</span>, <span class="st">&#39;view&#39;</span>, <span class="st">&#39;add to cart&#39;</span>, <span class="st">&#39;add to cart&#39;</span>, <span class="st">&#39;add to cart&#39;</span>,],</span>
<span id="cb312-3"><a href="#cb312-3" tabindex="-1"></a>    <span class="st">&#39;fruit&#39;</span>: [<span class="st">&#39;orange&#39;</span>, <span class="st">&#39;orange&#39;</span>, <span class="st">&#39;orange&#39;</span>, <span class="st">&#39;apple&#39;</span>, <span class="st">&#39;apple&#39;</span>],</span>
<span id="cb312-4"><a href="#cb312-4" tabindex="-1"></a>    <span class="st">&#39;times&#39;</span>:   [ <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">4</span>]</span>
<span id="cb312-5"><a href="#cb312-5" tabindex="-1"></a>})</span>
<span id="cb312-6"><a href="#cb312-6" tabindex="-1"></a>df</span></code></pre></div>
<pre class="python_output"><code>        action  fruit   times
0         view  orange      1
1         view  orange      1
2  add to cart  orange      3
3  add to cart   apple      2
4  add to cart   apple      4</code></pre>
<div class="sourceCode" id="cb314"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb314-1"><a href="#cb314-1" tabindex="-1"></a>df.drop_duplicates()</span></code></pre></div>
<pre class="python_output"><code>        action  fruit   times
0         view  orange      1
2  add to cart  orange      3
3  add to cart   apple      2
4  add to cart   apple      4</code></pre>
<div class="sourceCode" id="cb316"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb316-1"><a href="#cb316-1" tabindex="-1"></a>df.drop_duplicates(subset<span class="op">=</span>[<span class="st">&#39;action&#39;</span>])</span></code></pre></div>
<pre class="python_output"><code>        action  fruit   times
0         view  orange      1
2  add to cart  orange      3</code></pre>
<div class="sourceCode" id="cb318"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb318-1"><a href="#cb318-1" tabindex="-1"></a>df.drop_duplicates(subset<span class="op">=</span>[<span class="st">&#39;action&#39;</span>,<span class="st">&#39;fruit&#39;</span>], keep<span class="op">=</span><span class="st">&#39;last&#39;</span>, ignore_index<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<pre class="python_output"><code>        action   fruit  times
0         view  orange      1
1  add to cart  orange      3
2  add to cart   apple      4
</code></pre>
<!--chapter:end:posts/03-Fundamental_Function/09-Drop_duplicates.Rmd-->
</div>
<div id="value_counts-1" class="section level2 hasAnchor" number="8.10">
<h2 class="hasAnchor"><span class="header-section-number">8.10</span> <code>.value_counts()</code><a href="#value_counts-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức này trả số lần xuất hiện của các phần tử trong <code>Series</code>. Kết quả trả về mặc định sẽ sắp xếp theo số lần xuất hiện giảm dần và mặc định bỏ qua các giá trị null</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb320-1"><a href="#cb320-1" tabindex="-1"></a>Series.value_counts(normalize<span class="op">=</span><span class="va">False</span>, sort<span class="op">=</span><span class="va">True</span>, ascending<span class="op">=</span><span class="va">False</span>, bins<span class="op">=</span><span class="va">None</span>, dropna<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>normalize</code>: <code>True</code> sẽ trả về tỉ lệ xuất hiện của các phần tử</p></li>
<li><p><code>sort</code>: <code>True</code> sẽ trả về kết quả sắp xếp theo số lần xuất hiện, <code>False</code> sẽ trả về kết quả sắp xếp theo trình tự xuất hiện của phần tử</p></li>
<li><p><code>ascending</code>: <code>True</code> sẽ trả về kết quả sắp xếp theo số lần xuất hiện tăng dần.</p></li>
<li><p><code>bins</code>: gom nhóm các phần tử, tương tự <code>pd.cut</code></p></li>
<li><p><code>dropna</code>: <code>False</code> sẽ đếm tất cả các phần tử kể cả null</p></li>
</ul>
<p><strong>Ví dụ</strong></p>
<div class="sourceCode" id="cb321"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb321-1"><a href="#cb321-1" tabindex="-1"></a>s <span class="op">=</span> pd.Series([<span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>,  np.nan, <span class="dv">4</span>, np.nan])</span>
<span id="cb321-2"><a href="#cb321-2" tabindex="-1"></a>s.value_counts()</span></code></pre></div>
<pre class="python_output"><code>3.0    2
1.0    1
2.0    1
4.0    1
dtype: int64</code></pre>
<div class="sourceCode" id="cb323"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb323-1"><a href="#cb323-1" tabindex="-1"></a>s.value_counts(normalize<span class="op">=</span><span class="va">True</span>, sort<span class="op">=</span><span class="va">False</span>, dropna<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<pre class="python_output"><code>3.0    0.285714
1.0    0.142857
2.0    0.142857
NaN    0.285714
4.0    0.142857
dtype: float64</code></pre>
<div class="sourceCode" id="cb325"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb325-1"><a href="#cb325-1" tabindex="-1"></a>s.value_counts(bins<span class="op">=</span><span class="dv">3</span>)</span></code></pre></div>
<pre class="python_output"><code>(0.996, 2.0]    2
(2.0, 3.0]      2
(3.0, 4.0]      1
dtype: int64</code></pre>
<!--chapter:end:posts/03-Fundamental_Function/10-Value_counts.Rmd-->
</div>
<div id="unique-và-.nunique-1" class="section level2 hasAnchor" number="8.11">
<h2 class="hasAnchor"><span class="header-section-number">8.11</span> <code>.unique()</code> và <code>.nunique()</code><a href="#unique-v%C3%A0-.nunique-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.unique()</code> trả về các giá trị khác nhau của <code>Series</code> và <code>.nunique()</code> trả về số lượng các giá trị khác nhau của <code>Series</code>. Kết quả trả về của <code>.unique()</code> là danh sách các phần tử được sắp xếp theo thứ tự đầu vào của bảng. Để loại bỏ giá trị <code>NA</code> trong lúc đếm có thể gọi <code>.nunique(dropna=False)</code></p>
<p>Cách sử dụng</p>
<div class="sourceCode" id="cb327"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb327-1"><a href="#cb327-1" tabindex="-1"></a>s <span class="op">=</span> pd.Series([<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span> ,<span class="dv">2</span>, np.nan], name<span class="op">=</span><span class="st">&#39;col_0&#39;</span>)</span>
<span id="cb327-2"><a href="#cb327-2" tabindex="-1"></a>s</span></code></pre></div>
<pre class="python_output"><code>0    2.0
1    3.0
2    1.0
3    2.0
4    NaN
Name: col_0, dtype: float64</code></pre>
<div class="sourceCode" id="cb329"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb329-1"><a href="#cb329-1" tabindex="-1"></a>s.unique()</span></code></pre></div>
<pre class="python_output"><code>array([ 2.,  3.,  1., nan])</code></pre>
<div class="sourceCode" id="cb331"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb331-1"><a href="#cb331-1" tabindex="-1"></a>s.nunique(dropna<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<pre class="python_output"><code>4</code></pre>
<!--chapter:end:posts/03-Fundamental_Function/11-Unique_Nunique.Rmd-->
</div>
<div id="drop-1" class="section level2 hasAnchor" number="8.12">
<h2 class="hasAnchor"><span class="header-section-number">8.12</span> <code>.drop()</code><a href="#drop-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.drop()</code> dùng để loại bỏ các dòng hoặc cột theo chỉ định.
Cú pháp của <code>.drop()</code> như sau</p>
<div class="sourceCode" id="cb333"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb333-1"><a href="#cb333-1" tabindex="-1"></a>DataFrame.drop(labels<span class="op">=</span><span class="va">None</span>, axis<span class="op">=</span><span class="dv">0</span>, index<span class="op">=</span><span class="va">None</span>, columns<span class="op">=</span><span class="va">None</span>, level<span class="op">=</span><span class="va">None</span>, inplace<span class="op">=</span><span class="va">False</span>, errors<span class="op">=</span><span class="st">&#39;raise&#39;</span>)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>labels</code>: Tên cột hoặc dòng cần loại bỏ.</p></li>
<li><p><code>axis</code>: Mặc đinh giá trị <code>0</code> loại bỏ theo dòng và <code>1</code> loại bỏ theo cột.</p></li>
<li><p><code>index</code>: Chỉ định index của dòng cần loại bỏ, tương đương <code>labels, axis=0</code></p></li>
<li><p><code>columns</code>: Chỉ định cột cần loại bỏ, tương đương <code>labels, axis=1</code></p></li>
<li><p><code>level</code>: Dành cho MultiIndex, khi đó chỉ định cấp độ index cần loại bỏ</p></li>
<li><p><code>inplace</code>: Thực hiện trên chính bảng hay tạo ra một bảng sao</p></li>
<li><p><code>errors</code>: mặc định <code>raise</code> sẽ trả ra lỗi và <code>ignore</code> nếu muốn bỏ qua lỗi.</p></li>
</ul>
<p><strong>Ví dụ</strong></p>
<div class="sourceCode" id="cb334"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb334-1"><a href="#cb334-1" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(np.arange(<span class="dv">16</span>).reshape(<span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb334-2"><a href="#cb334-2" tabindex="-1"></a>                  columns<span class="op">=</span>[<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>, <span class="st">&#39;C&#39;</span>, <span class="st">&#39;D&#39;</span>],</span>
<span id="cb334-3"><a href="#cb334-3" tabindex="-1"></a>                  index<span class="op">=</span>[<span class="st">&#39;A&#39;</span>, <span class="st">&#39;1A&#39;</span>, <span class="st">&#39;2A&#39;</span>, <span class="st">&#39;3A&#39;</span>])</span>
<span id="cb334-4"><a href="#cb334-4" tabindex="-1"></a>df</span></code></pre></div>
<pre class="python_output"><code>     A   B   C   D
A    0   1   2   3
1A   4   5   6   7
2A   8   9  10  11
3A  12  13  14  15</code></pre>
<div class="sourceCode" id="cb336"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb336-1"><a href="#cb336-1" tabindex="-1"></a>df.drop(<span class="st">&#39;A&#39;</span>)</span></code></pre></div>
<pre class="python_output"><code>    A   B   C   D
1A  4   5   6   7
2A  8   9   10  11
3A  12  13  14  15</code></pre>
<div class="sourceCode" id="cb338"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb338-1"><a href="#cb338-1" tabindex="-1"></a>df.drop(columns<span class="op">=</span>[<span class="st">&#39;A&#39;</span>, <span class="st">&#39;C&#39;</span>])</span></code></pre></div>
<pre class="python_output"><code>     B   D
A    1   3
1A   5   7
2A   9  11
3A  13  15</code></pre>
<div class="sourceCode" id="cb340"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb340-1"><a href="#cb340-1" tabindex="-1"></a>df.drop(index<span class="op">=</span>[<span class="st">&#39;A&#39;</span>, <span class="st">&#39;2A&#39;</span>])</span></code></pre></div>
<pre class="python_output"><code>     A   B   C   D
1A   4   5   6   7
3A  12  13  14  15</code></pre>

<div class="rmdnote">
<strong><em>Lưu ý:</em></strong>
Thực tế hay dùng các params <code>columns</code> và <code>index</code> để chỉ định các dòng hay cột cần được loại bỏ hơn là dùng <code>labels</code> và <code>axis</code>
</div>
<!--chapter:end:posts/03-Fundamental_Function/12-Drop.Rmd-->
</div>
<div id="rename-1" class="section level2 hasAnchor" number="8.13">
<h2 class="hasAnchor"><span class="header-section-number">8.13</span> <code>.rename()</code><a href="#rename-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.rename()</code> dùng để đổi tên nhãn của cột hoặc dòng. Cú pháp như sau</p>
<div class="sourceCode" id="cb342"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb342-1"><a href="#cb342-1" tabindex="-1"></a>DataFrame.rename(mapper<span class="op">=</span><span class="va">None</span>, <span class="op">*</span>, index<span class="op">=</span><span class="va">None</span>, columns<span class="op">=</span><span class="va">None</span>, axis<span class="op">=</span><span class="va">None</span>, copy<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">False</span>, level<span class="op">=</span><span class="va">None</span>, errors<span class="op">=</span><span class="st">&#39;ignore&#39;</span>)[source]</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>mapper</code>: là một danh sách dạng dictionary chứa key là tên cần đổi và value là tên mới.</p></li>
<li><p><code>axis</code>: Mặc đinh giá trị <code>0</code> thay đổi theo index và <code>1</code> thay đổi theo cột.</p></li>
<li><p><code>index</code>: Chỉ định index của dòng cần thay đổi, tương đương <code>mapper, axis=0</code>, thay thế bằng <code>index=mapper</code></p></li>
<li><p><code>columns</code>: Chỉ định cột cần thay đổi, tương đương <code>mapper, axis=1</code>, thay thế bằng <code>columns=mapper</code></p></li>
<li><p><code>copy</code>: <code>True</code>, mặc định sao chép dữ liệu</p></li>
<li><p><code>level</code>: Dành cho MultiIndex, khi đó chỉ định cấp độ index cần đổi tên</p></li>
<li><p><code>inplace</code>: Thực hiện trên chính bảng hay tạo ra một bảng sao</p></li>
<li><p><code>errors</code>: mặc định <code>raise</code> sẽ trả ra lỗi và <code>ignore</code> nếu muốn bỏ qua lỗi.</p></li>
</ul>
<p><strong>Ví dụ</strong></p>
<div class="sourceCode" id="cb343"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb343-1"><a href="#cb343-1" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(np.arange(<span class="dv">16</span>).reshape(<span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb343-2"><a href="#cb343-2" tabindex="-1"></a>                        columns<span class="op">=</span>[<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>, <span class="st">&#39;C&#39;</span>, <span class="st">&#39;D&#39;</span>],</span>
<span id="cb343-3"><a href="#cb343-3" tabindex="-1"></a>                        index<span class="op">=</span>[<span class="st">&#39;A&#39;</span>, <span class="st">&#39;1A&#39;</span>, <span class="st">&#39;2A&#39;</span>, <span class="st">&#39;3A&#39;</span>])</span>
<span id="cb343-4"><a href="#cb343-4" tabindex="-1"></a>df.rename(mapper<span class="op">=</span>{<span class="st">&#39;A&#39;</span>:<span class="st">&#39;aA&#39;</span>})</span></code></pre></div>
<pre class="python_output"><code>     A   B   C   D
aA   0   1   2   3
1A   4   5   6   7
2A   8   9  10  11
3A  12  13  14  15</code></pre>
<div class="sourceCode" id="cb345"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb345-1"><a href="#cb345-1" tabindex="-1"></a>df.rename(mapper<span class="op">=</span>{<span class="st">&#39;A&#39;</span>:<span class="st">&#39;aA&#39;</span>}, axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<pre class="python_output"><code>    aA   B   C   D
A    0   1   2   3
1A   4   5   6   7
2A   8   9  10  11
3A  12  13  14  15</code></pre>
<div class="sourceCode" id="cb347"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb347-1"><a href="#cb347-1" tabindex="-1"></a>df.rename(columns<span class="op">=</span>{<span class="st">&#39;A&#39;</span>:<span class="st">&#39;aA&#39;</span>, <span class="st">&#39;B&#39;</span>:<span class="st">&#39;Bb&#39;</span>}, index<span class="op">=</span>{<span class="st">&#39;A&#39;</span>: <span class="st">&#39;OA&#39;</span>,<span class="st">&#39;3A&#39;</span>:<span class="st">&#39;3a&#39;</span>})</span></code></pre></div>
<pre class="python_output"><code>    aA  Bb   C   D
OA   0   1   2   3
1A   4   5   6   7
2A   8   9  10  11
3a  12  13  14  15</code></pre>

<div class="rmdnote">
<p><strong><em>Lưu ý:</em></strong>
Tương tự như <code>.drop()</code> thì <code>columns</code> và <code>index</code> thường được sử dụng hơn là <code>mapper</code> và <code>axis</code>.</p>
Vẫn chưa rõ <code>copy</code> dùng để làm gì.
</div>
<!--chapter:end:posts/03-Fundamental_Function/13-Rename.Rmd-->
</div>
<div id="set_index-1" class="section level2 hasAnchor" number="8.14">
<h2 class="hasAnchor"><span class="header-section-number">8.14</span> <code>.set_index()</code><a href="#set_index-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.set_index()</code> dùng để chuyển đổi một cột của bảng thành index. Index này có thể thay thể index cũ hoặc thêm vào để thành <code>MultiIndex</code>. Cách sử dụng như sau:</p>
<div class="sourceCode" id="cb349"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb349-1"><a href="#cb349-1" tabindex="-1"></a>DataFrame.set_index(keys, drop<span class="op">=</span><span class="va">True</span>, append<span class="op">=</span><span class="va">False</span>, inplace<span class="op">=</span><span class="va">False</span>, verify_integrity<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>keys</code>: Có thể truyền vào một cột duy nhất hoặc danh sách các cột. Ngoài ra còn có thể là 1 danh sách dạng <code>pd.Index</code>, <code>Series</code>, <code>np.array</code>, <code>iterator</code></p></li>
<li><p><code>drop</code>: loại bỏ cột trong bảng nếu đã đưa vào index, mặc định là <code>True</code></p></li>
<li><p><code>append</code>: mặc định là <code>False</code> ghi đè lên index đã có. Giá trị <code>True</code> sẽ thêm vào index sẵn có.</p></li>
<li><p><code>inplace</code>: Thực hiện trực tiếp trên bảng hoặc tạo ra một bản sao</p></li>
<li><p><code>verify_integrity</code>: Kiểm tra xem cột đánh index có chứa các phần tử trùng lặp hay không.</p></li>
</ul>
<p><strong>Ví dụ</strong></p>
<div class="sourceCode" id="cb350"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb350-1"><a href="#cb350-1" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame(np.arange(<span class="dv">16</span>).reshape(<span class="dv">4</span>, <span class="dv">4</span>),</span>
<span id="cb350-2"><a href="#cb350-2" tabindex="-1"></a>                  columns<span class="op">=</span>[<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>, <span class="st">&#39;C&#39;</span>, <span class="st">&#39;D&#39;</span>],</span>
<span id="cb350-3"><a href="#cb350-3" tabindex="-1"></a>                  index<span class="op">=</span>[<span class="st">&#39;A&#39;</span>, <span class="st">&#39;1A&#39;</span>, <span class="st">&#39;2A&#39;</span>, <span class="st">&#39;3A&#39;</span>])</span>
<span id="cb350-4"><a href="#cb350-4" tabindex="-1"></a>df.index.name <span class="op">=</span> <span class="st">&#39;index1&#39;</span></span>
<span id="cb350-5"><a href="#cb350-5" tabindex="-1"></a>df</span></code></pre></div>
<pre class="python_output"><code>         A   B   C   D
index1                
A        0   1   2   3
1A       4   5   6   7
2A       8   9  10  11
3A      12  13  14  15</code></pre>
<div class="sourceCode" id="cb352"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb352-1"><a href="#cb352-1" tabindex="-1"></a>df.set_index(<span class="st">&#39;A&#39;</span>)</span></code></pre></div>
<pre class="python_output"><code>     B   C   D
A             
0    1   2   3
4    5   6   7
8    9  10  11
12  13  14  15</code></pre>
<div class="sourceCode" id="cb354"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb354-1"><a href="#cb354-1" tabindex="-1"></a>df.set_index([<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>], append<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<pre class="python_output"><code>               C   D
index1 A  B         
A      0  1    2   3
1A     4  5    6   7
2A     8  9   10  11
3A     12 13  14  15</code></pre>
<div class="sourceCode" id="cb356"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb356-1"><a href="#cb356-1" tabindex="-1"></a>df.set_index([pd.Index([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>], name<span class="op">=</span><span class="st">&#39;new_index&#39;</span>)])</span></code></pre></div>
<pre class="python_output"><code>            A   B   C   D
new_index                
1           0   1   2   3
2           4   5   6   7
3           8   9  10  11
4          12  13  14  15</code></pre>

<div class="rmdnote">
<strong><em>Lưu ý:</em></strong>
<code>keys</code> không áp dụng cho kiểu <code>list</code>, <code>tuple</code> nhưng Iterator của nó thì được.
</div>
<p><strong>Ví dụ</strong> khi đưa list vào sẽ báo lỗi</p>
<div class="sourceCode" id="cb358"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb358-1"><a href="#cb358-1" tabindex="-1"></a>df.set_index([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>])</span></code></pre></div>
<pre class="python_output"><code>---------------------------------------------------------------------------
KeyError                                  Traceback (most recent call last)
~\AppData\Local\Temp/ipykernel_1380/3577861036.py in &lt;module&gt;
----&gt; 1 df.set_index([1, 2, 3, 4])

D:\Vendors\anaconda\lib\site-packages\pandas\util\_decorators.py in wrapper(*args, **kwargs)
    309                     stacklevel=stacklevel,
    310                 )
--&gt; 311             return func(*args, **kwargs)
    312 
    313         return wrapper

D:\Vendors\anaconda\lib\site-packages\pandas\core\frame.py in set_index(self, keys, drop, append, inplace, verify_integrity)
   5492 
   5493         if missing:
-&gt; 5494             raise KeyError(f&quot;None of {missing} are in the columns&quot;)
   5495 
   5496         if inplace:

KeyError: &#39;None of [1, 2, 3, 4] are in the columns&#39;</code></pre>
<p>Trong khi đưa vào <code>Iterator</code> thì hoạt động.</p>
<div class="sourceCode" id="cb360"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb360-1"><a href="#cb360-1" tabindex="-1"></a>df.set_index(<span class="bu">iter</span>([<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]))</span></code></pre></div>
<pre class="python_output"><code>    A   B   C   D
1   0   1   2   3
2   4   5   6   7
3   8   9  10  11
4  12  13  14  15</code></pre>
<!--chapter:end:posts/03-Fundamental_Function/14-Set_index.Rmd-->
</div>
<div id="sort_values-1" class="section level2 hasAnchor" number="8.15">
<h2 class="hasAnchor"><span class="header-section-number">8.15</span> <code>.sort_values</code><a href="#sort_values-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.sort_values</code> dùng để sắp xếp dữ liệu trong DataFrame hoặc Series</p>
<div class="sourceCode" id="cb362"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb362-1"><a href="#cb362-1" tabindex="-1"></a>DataFrame.sort_values(by, axis<span class="op">=</span><span class="dv">0</span>, ascending<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">False</span>, kind<span class="op">=</span><span class="st">&#39;quicksort&#39;</span>, na_position<span class="op">=</span><span class="st">&#39;last&#39;</span>, ignore_index<span class="op">=</span><span class="va">False</span>, key<span class="op">=</span><span class="va">None</span>)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>by</code> : nhãn hoặc danh sách nhãn cần sắp xếp</p></li>
<li><p><code>axis</code>: chỉ định chiều sắp xếp {<code>0</code> hoặc <code>index</code>, <code>1</code> hoặc <code>columns</code>}</p></li>
<li><p><code>ascending</code>: Sắp xếp tăng dần hoặc giảm dần, có thể là một giá trị hoặc danh sách các giá trị boolean</p></li>
<li><p><code>inplace</code>: Thực hiện trên chính bảng đó hoặc tạo ra một bản sao</p></li>
<li><p><code>kind</code>: Thuật toán sắp xếp</p></li>
<li><p><code>na_postion</code>: chỉ định các giá trị <code>NA</code> được xếp đầu hoặc cuôi</p></li>
<li><p><code>ignore_index</code>: Nếu để giá trị <code>True</code> sẽ thực hiện đánh index lại từ 0</p></li>
<li><p><code>key</code>: key function</p></li>
</ul>
<div class="sourceCode" id="cb363"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb363-1"><a href="#cb363-1" tabindex="-1"></a>df <span class="op">=</span> pd.DataFrame({</span>
<span id="cb363-2"><a href="#cb363-2" tabindex="-1"></a>    <span class="st">&#39;col1&#39;</span>: [<span class="st">&#39;A&#39;</span>, <span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>, np.nan, <span class="st">&#39;D&#39;</span>, <span class="st">&#39;C&#39;</span>],</span>
<span id="cb363-3"><a href="#cb363-3" tabindex="-1"></a>    <span class="st">&#39;col2&#39;</span>: [<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">2</span>, <span class="dv">4</span>],</span>
<span id="cb363-4"><a href="#cb363-4" tabindex="-1"></a>    <span class="st">&#39;col3&#39;</span>: [<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb363-5"><a href="#cb363-5" tabindex="-1"></a>    <span class="st">&#39;col4&#39;</span>: [<span class="st">&#39;a&#39;</span>, <span class="st">&#39;B&#39;</span>, <span class="st">&#39;c&#39;</span>, <span class="st">&#39;D&#39;</span>, <span class="st">&#39;e&#39;</span>, <span class="st">&#39;F&#39;</span>]</span>
<span id="cb363-6"><a href="#cb363-6" tabindex="-1"></a>})</span>
<span id="cb363-7"><a href="#cb363-7" tabindex="-1"></a>df</span></code></pre></div>
<pre class="python_output"><code>  col1  col2  col3 col4
0    A     2     0    a
1    A     1     1    B
2    B     9     9    c
3  NaN     8     4    D
4    D     2     2    e
5    C     4     3    F</code></pre>
<p>Sắp xếp theo <code>col1</code></p>
<div class="sourceCode" id="cb365"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb365-1"><a href="#cb365-1" tabindex="-1"></a>df.sort_values(by<span class="op">=</span>[<span class="st">&#39;col1&#39;</span>])</span></code></pre></div>
<pre class="python_output"><code>  col1  col2  col3 col4
0    A     2     0    a
1    A     1     1    B
2    B     9     9    c
5    C     4     3    F
4    D     2     2    e
3  NaN     8     4    D</code></pre>
<p>Sắp xếp theo nhiều cột</p>
<div class="sourceCode" id="cb367"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb367-1"><a href="#cb367-1" tabindex="-1"></a>df.sort_values(by<span class="op">=</span>[<span class="st">&#39;col1&#39;</span>, <span class="st">&#39;col2&#39;</span>])</span></code></pre></div>
<pre class="python_output"><code>  col1  col2  col3 col4
1    A     1     1    B
0    A     2     0    a
2    B     9     9    c
5    C     4     3    F
4    D     7     2    e
3  NaN     8     4    D</code></pre>
<p>Sắp xếp theo tăng giảm</p>
<div class="sourceCode" id="cb369"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb369-1"><a href="#cb369-1" tabindex="-1"></a>df.sort_values(by<span class="op">=</span>[<span class="st">&#39;col1&#39;</span>, <span class="st">&#39;col2&#39;</span>], ascending<span class="op">=</span>[<span class="va">False</span>, <span class="va">True</span>])</span></code></pre></div>
<pre class="python_output"><code>  col1  col2  col3 col4
4    D     2     2    e
5    C     4     3    F
2    B     9     9    c
1    A     1     1    B
0    A     2     0    a
3  NaN     8     4    D</code></pre>
<p>Thay đổi vị trí của <code>NaN</code></p>
<div class="sourceCode" id="cb371"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb371-1"><a href="#cb371-1" tabindex="-1"></a>df.sort_values(by<span class="op">=</span><span class="st">&#39;col1&#39;</span>, ascending<span class="op">=</span><span class="va">False</span>, na_position<span class="op">=</span><span class="st">&#39;first&#39;</span>)</span></code></pre></div>
<pre class="python_output"><code>  col1  col2  col3 col4
3  NaN     8     4    D
4    D     2     2    e
5    C     4     3    F
2    B     9     9    c
0    A     2     0    a
1    A     1     1    B</code></pre>
<p>Sắp xếp với key function</p>
<div class="sourceCode" id="cb373"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb373-1"><a href="#cb373-1" tabindex="-1"></a>df.sort_values(by<span class="op">=</span><span class="st">&#39;col4&#39;</span>, key<span class="op">=</span><span class="kw">lambda</span> col: col.<span class="bu">str</span>.lower())</span></code></pre></div>
<pre class="python_output"><code>  col1  col2  col3 col4
0    A     2     0    a
1    A     1     1    B
2    B     9     9    c
3  NaN     8     4    D
4    D     2     2    e
5    C     4     3    F</code></pre>
<!--chapter:end:posts/03-Fundamental_Function/15-Sort_values.Rmd-->
</div>
<div id="sort_index-1" class="section level2 hasAnchor" number="8.16">
<h2 class="hasAnchor"><span class="header-section-number">8.16</span> <code>.sort_index</code><a href="#sort_index-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:posts/03-Fundamental_Function/16-Sort_index.Rmd-->
</div>
</div>
<div id="selecting-và-filtering" class="section level1 hasAnchor" number="9">
<h1 class="hasAnchor"><span class="header-section-number">9</span> Selecting và Filtering<a href="#selecting-v%C3%A0-filtering" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="sử-dụng" class="section level2 hasAnchor" number="9.1">
<h2 class="hasAnchor"><span class="header-section-number">9.1</span> Sử dụng <code>[]</code><a href="#s%E1%BB%AD-d%E1%BB%A5ng" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Cú pháp <code>[]</code> là cú pháp đơn giản nhất để lấy bảng con của 1 bảng cho trước.
Với 1 <code>df</code> là 1 <code>DataFrame</code> có index là <code>region</code> và dữ liệu như sau</p>
<div class="sourceCode" id="cb375"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb375-1"><a href="#cb375-1" tabindex="-1"></a>                         state  individuals  family_members  state_pop</span>
<span id="cb375-2"><a href="#cb375-2" tabindex="-1"></a>region                                                                </span>
<span id="cb375-3"><a href="#cb375-3" tabindex="-1"></a>East South Central     Alabama       <span class="fl">2570.0</span>           <span class="fl">864.0</span>    <span class="dv">4887681</span></span>
<span id="cb375-4"><a href="#cb375-4" tabindex="-1"></a>Pacific                 Alaska       <span class="fl">1434.0</span>           <span class="fl">582.0</span>     <span class="dv">735139</span></span>
<span id="cb375-5"><a href="#cb375-5" tabindex="-1"></a>Mountain               Arizona       <span class="fl">7259.0</span>          <span class="fl">2606.0</span>    <span class="dv">7158024</span></span>
<span id="cb375-6"><a href="#cb375-6" tabindex="-1"></a>West South Central    Arkansas       <span class="fl">2280.0</span>           <span class="fl">432.0</span>    <span class="dv">3009733</span></span>
<span id="cb375-7"><a href="#cb375-7" tabindex="-1"></a>Pacific             California     <span class="fl">109008.0</span>         <span class="fl">20964.0</span>   <span class="dv">39461588</span></span>
<span id="cb375-8"><a href="#cb375-8" tabindex="-1"></a>Mountain              Colorado       <span class="fl">7607.0</span>          <span class="fl">3250.0</span>    <span class="dv">5691287</span></span></code></pre></div>
<p>Để chọn 1 bảng con có 2 cột <code>['state', 'family_members']</code> ta làm như sau</p>
<div class="sourceCode" id="cb376"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb376-1"><a href="#cb376-1" tabindex="-1"></a>df[[<span class="st">&#39;state&#39;</span>, <span class="st">&#39;family_members&#39;</span>]]</span></code></pre></div>
<pre class="python_output"><code>                         state  family_members
region                                        
East South Central     Alabama           864.0
Pacific                 Alaska           582.0
Mountain               Arizona          2606.0
West South Central    Arkansas           432.0
Pacific             California         20964.0
Mountain              Colorado          3250.0</code></pre>
<p>Để lấy theo dòng ta dùng tương tự <code>Series</code></p>
<div class="sourceCode" id="cb378"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb378-1"><a href="#cb378-1" tabindex="-1"></a>df[:<span class="dv">3</span>]</span></code></pre></div>
<pre class="python_output"><code>                      state  individuals  family_members  state_pop
region                                                             
East South Central  Alabama       2570.0           864.0    4887681
Pacific              Alaska       1434.0           582.0     735139
Mountain            Arizona       7259.0          2606.0    7158024
</code></pre>
<div class="sourceCode" id="cb380"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb380-1"><a href="#cb380-1" tabindex="-1"></a>df[<span class="dv">2</span>:<span class="dv">5</span>]</span></code></pre></div>
<pre class="python_output"><code>                         state  individuals  family_members  state_pop
region                                                                
Mountain               Arizona       7259.0          2606.0    7158024
West South Central    Arkansas       2280.0           432.0    3009733
Pacific             California     109008.0         20964.0   39461588</code></pre>

<div class="rmdnote">
<p><strong><em>Lưu ý:</em></strong></p>
<ul>
<li><p><code>df[['state']]</code> sẽ trả về <code>DataFrame</code> trong khi <code>df['state']</code> trả về <code>Series</code>.</p></li>
<li><p>Đối với lấy theo dòng, <code>[]</code> không lấy được theo dòng riêng biệt.</p></li>
<li><p><code>[]</code> chỉ lấy dữ liệu theo dòng hoặc cột, không thực hiện được cùng lúc cả hai thao tác.</p>
</div>
<p>Ví dụ khi gọi <code>df[3]</code> hay <code>df[[1, 2, 3]]</code> sẽ báo lỗi <code>KeyError</code></p></li>
</ul>
<div id="loc-và-.iloc" class="section level2 hasAnchor" number="9.2">
<h2 class="hasAnchor"><span class="header-section-number">9.2</span> .loc và .iloc<a href="#loc-v%C3%A0-.iloc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="loc" class="section level3 hasAnchor" number="9.2.1">
<h3 class="hasAnchor"><span class="header-section-number">9.2.1</span> .loc<a href="#loc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Phương thức <code>.loc</code> dùng để lấy dữ liệu theo cột hoặc hàng dựa theo nhãn định sẵn (Tên hàng, tên cột), ngoài ra <code>.loc</code> còn nhận các giá trị boolean.</p>
<p>Đầu vào của <code>.loc</code> có thể gồm:</p>
<ul>
<li><p>Nhãn đơn: là 1 số <code>3</code> hoặc dạng chữ <code>a</code>, lưu ý rằng số này là nhãn của <code>index</code> chứ không phải vị trí của dòng.</p></li>
<li><p>Danh sách các nhãn : <code>['a', 'b', 'c']</code></p></li>
<li><p>Đối tượng dạng slice ví dụ <code>'a':'e'</code></p></li>
<li><p>Danh sách kiểu <code>bool</code> có độ dài bằng với số lượng dòng</p></li>
<li><p><code>Series</code> dạng <code>bool</code></p></li>
<li><p><code>pd.Index</code></p></li>
</ul>
<p>Sử dụng nhãn đơn, kết quả trả về là các dòng có nhãn giống như nhãn trong <code>.loc</code></p>
<div class="sourceCode" id="cb382"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb382-1"><a href="#cb382-1" tabindex="-1"></a>df.loc[<span class="st">&#39;Pacific&#39;</span>]</span></code></pre></div>
<pre class="python_output"><code>              state  individuals  family_members  state_pop
region                                                     
Pacific      Alaska       1434.0           582.0     735139
Pacific  California     109008.0         20964.0   39461588</code></pre>

<div class="rmdnote">
<p><strong><em>Lưu ý:</em></strong></p>
Khi kết quả là nhiều dòng thì dữ liệu trả về có kiểu <code>DataFrame</code>, trong khi nếu chỉ có 1 dòng duy nhất thì kết quả trả về sẽ theo kiểu <code>Series</code>
</div>
<div class="sourceCode" id="cb384"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb384-1"><a href="#cb384-1" tabindex="-1"></a><span class="bu">type</span>(df.loc[<span class="st">&#39;Pacific&#39;</span>])</span></code></pre></div>
<pre class="python_output"><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</code></pre>
<div class="sourceCode" id="cb386"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb386-1"><a href="#cb386-1" tabindex="-1"></a><span class="bu">type</span>(df.loc[<span class="st">&#39;West South Central&#39;</span>])</span></code></pre></div>
<pre class="python_output"><code>&lt;class &#39;pandas.core.series.Series&#39;&gt;</code></pre>
<p>Khi đưa danh sách các nhãn dùng <code>.loc[[]]</code> thì nhãn đưa vào là nhãn của <code>index</code>. Nếu đưa tên các cột sẽ bị báo lỗi <code>KeyError</code></p>
<div class="sourceCode" id="cb388"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb388-1"><a href="#cb388-1" tabindex="-1"></a>df.loc[[<span class="st">&#39;Pacific&#39;</span>, <span class="st">&#39;Mountain&#39;</span>]]</span></code></pre></div>
<pre class="python_output"><code>               state  individuals  family_members  state_pop
region                                                      
Pacific       Alaska       1434.0           582.0     735139
Pacific   California     109008.0         20964.0   39461588
Mountain     Arizona       7259.0          2606.0    7158024
Mountain    Colorado       7607.0          3250.0    5691287</code></pre>
<p>Để lấy nhãn đơn theo nhãn của <code>index</code> và tên <code>column</code> ta truyền vào phần nhãn của <code>index</code> trước và nhãn của <code>column</code> sau và phân biệt bởi dấu phẩy</p>
<div class="sourceCode" id="cb390"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb390-1"><a href="#cb390-1" tabindex="-1"></a>df.loc[<span class="st">&#39;Pacific&#39;</span>, <span class="st">&#39;state&#39;</span>]</span></code></pre></div>
<pre class="python_output"><code>region
Pacific        Alaska
Pacific    California
Name: state, dtype: object</code></pre>
<p>Để lấy nhiều hơn 1 nhãn của <code>index</code> hoặc nhiều hơn 1 nhãn của <code>column</code> ta chỉ cần thay thế nhãn đơn của <code>index</code> thành danh sách hoặc slice, tương tự ta có thế thay thế nhãn đơn thành danh sách hoặc slice của <code>column</code></p>
<div class="sourceCode" id="cb392"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb392-1"><a href="#cb392-1" tabindex="-1"></a>df.loc[<span class="st">&#39;Pacific&#39;</span>, [<span class="st">&#39;individuals&#39;</span>, <span class="st">&#39;family_members&#39;</span>]])</span></code></pre></div>
<pre class="python_output"><code>         individuals  family_members
region                              
Pacific       1434.0           582.0
Pacific     109008.0         20964.0</code></pre>
<div class="sourceCode" id="cb394"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb394-1"><a href="#cb394-1" tabindex="-1"></a>df.loc[<span class="st">&#39;Pacific&#39;</span>, <span class="st">&#39;individuals&#39;</span>:<span class="st">&#39;state_pop&#39;</span>]</span></code></pre></div>
<pre class="python_output"><code>         individuals  family_members  state_pop
region                                         
Pacific       1434.0           582.0     735139
Pacific     109008.0         20964.0   39461588</code></pre>

<div class="rmdnote">
<p><strong><em>Lưu ý:</em></strong></p>
<ul>
<li><p>Dùng slice sẽ lấy theo thứ tự xuất hiện chứ không lấy theo thứ tự sắp xếp từ điển, như ví dụ trên thì mặc dù <code>family_members</code> &gt; <code>individuals</code> nhưng vẫn xếp sau.</p></li>
<li><p>Slice không áp dụng được cho <code>index</code> có nhãn trùng nhau, nếu dùng sẽ báo lỗi <code>KeyError: "Cannot get right slice bound for non-unique label:</code></p>
</div></li>
</ul>
<p>Danh sách dạng <code>boolean</code>, chỉ sử dụng cho <code>index</code>, không dùng cho <code>column</code></p>
<div class="sourceCode" id="cb396"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb396-1"><a href="#cb396-1" tabindex="-1"></a>df.loc[[<span class="va">False</span>, <span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>, <span class="va">False</span>, <span class="va">False</span>]]</span></code></pre></div>
<pre class="python_output"><code>                       state  individuals  family_members  state_pop
region                                                              
Pacific               Alaska       1434.0           582.0     735139
West South Central  Arkansas       2280.0           432.0    3009733</code></pre>
<p>Series boolean</p>
<div class="sourceCode" id="cb398"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb398-1"><a href="#cb398-1" tabindex="-1"></a>s <span class="op">=</span> pd.Series([<span class="va">False</span>, <span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>, <span class="va">False</span>, <span class="va">False</span>],</span>
<span id="cb398-2"><a href="#cb398-2" tabindex="-1"></a>              index<span class="op">=</span>[<span class="st">&#39;East South Central&#39;</span>, <span class="st">&#39;Pacific&#39;</span>, <span class="st">&#39;Mountain&#39;</span>, <span class="st">&#39;West South Central&#39;</span>, <span class="st">&#39;Pacific&#39;</span>, <span class="st">&#39;Mountain&#39;</span>])</span>
<span id="cb398-3"><a href="#cb398-3" tabindex="-1"></a>df.loc[s]</span></code></pre></div>
<pre class="python_output"><code>                       state  individuals  family_members  state_pop
region                                                              
Pacific               Alaska       1434.0           582.0     735139
West South Central  Arkansas       2280.0           432.0    3009733</code></pre>
<p><code>pd.Index</code></p>
<div class="sourceCode" id="cb400"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb400-1"><a href="#cb400-1" tabindex="-1"></a>df.loc[pd.Index([<span class="st">&quot;Pacific&quot;</span>, <span class="st">&quot;East South Central&quot;</span>], name<span class="op">=</span><span class="st">&quot;meow&quot;</span>)]</span></code></pre></div>
<pre class="python_output"><code>                         state  individuals  family_members  state_pop
meow                                                                   
Pacific                 Alaska       1434.0           582.0     735139
Pacific             California     109008.0         20964.0   39461588
East South Central     Alabama       2570.0           864.0    4887681</code></pre>
<p><strong>Select với <code>MultiIndex</code></strong></p>
<div class="sourceCode" id="cb402"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb402-1"><a href="#cb402-1" tabindex="-1"></a>                     individuals  family_members  state_pop</span>
<span id="cb402-2"><a href="#cb402-2" tabindex="-1"></a>region   state                                             </span>
<span id="cb402-3"><a href="#cb402-3" tabindex="-1"></a>Mountain Arizona          <span class="fl">7259.0</span>          <span class="fl">2606.0</span>    <span class="dv">7158024</span></span>
<span id="cb402-4"><a href="#cb402-4" tabindex="-1"></a>         Colorado         <span class="fl">7607.0</span>          <span class="fl">3250.0</span>    <span class="dv">5691287</span></span>
<span id="cb402-5"><a href="#cb402-5" tabindex="-1"></a>         Idaho            <span class="fl">1297.0</span>           <span class="fl">715.0</span>    <span class="dv">1750536</span></span>
<span id="cb402-6"><a href="#cb402-6" tabindex="-1"></a>Pacific  Alaska           <span class="fl">1434.0</span>           <span class="fl">582.0</span>     <span class="dv">735139</span></span>
<span id="cb402-7"><a href="#cb402-7" tabindex="-1"></a>         California     <span class="fl">109008.0</span>         <span class="fl">20964.0</span>   <span class="dv">39461588</span></span>
<span id="cb402-8"><a href="#cb402-8" tabindex="-1"></a>         Hawaii           <span class="fl">4131.0</span>          <span class="fl">2399.0</span>    <span class="dv">1420593</span></span></code></pre></div>
<p>Với nhãn đơn</p>
<div class="sourceCode" id="cb403"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb403-1"><a href="#cb403-1" tabindex="-1"></a>df.loc[<span class="st">&#39;Mountain&#39;</span>]</span></code></pre></div>
<pre class="python_output"><code>          individuals  family_members  state_pop
state                                           
Arizona        7259.0          2606.0    7158024
Colorado       7607.0          3250.0    5691287
Idaho          1297.0           715.0    1750536</code></pre>

<div class="rmdnote">
<strong><em>Lưu ý:</em></strong>
Với <code>MultiIndex</code>,các index sẽ xếp theo thứ tự từ level 0 đến n (<code>level 0</code> cao hơn <code>level 1</code> …), với nhãn đơn là nhãn của 1 <code>index</code> thì chỉ thực hiện được index level đầu tiên, các index level sau sẽ báo lỗi.
Theo như ví dụ trên thì <code>region</code> có level cao hơn ‘state’ nên chỉ gọi được <code>.loc['Mountain']</code> còn <code>.loc['Arizona']</code> sẽ báo lỗi
</div>
<p>Để select nhiều index cùng lúc, ta truyền vào <code>tuple(label1, label2...)</code> theo thứ tự index có level từ cao đến thấp</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb405-1"><a href="#cb405-1" tabindex="-1"></a>df.loc[(<span class="st">&#39;Mountain&#39;</span>, <span class="st">&#39;Colorado&#39;</span>)]</span></code></pre></div>
<pre class="python_output"><code>individuals          7607.0
family_members       3250.0
state_pop         5691287.0
Name: (Mountain, Colorado), dtype: float64</code></pre>
<p>Tương tự ta cùng có select theo các column cho trước</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb407-1"><a href="#cb407-1" tabindex="-1"></a>df.loc[(<span class="st">&#39;Mountain&#39;</span>, <span class="st">&#39;Colorado&#39;</span>), [<span class="st">&#39;individuals&#39;</span>, <span class="st">&#39;family_members&#39;</span>]]</span></code></pre></div>
<pre class="python_output"><code>individuals       7607.0
family_members    3250.0
Name: (Mountain, Colorado), dtype: float64</code></pre>

<div class="rmdtip">
<p><strong><em>Mẹo:</em></strong>
Có thể select <code>index</code> ở các level sau bằng cách dùng <code>slice</code></p>
</div>
<div class="sourceCode" id="cb409"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb409-1"><a href="#cb409-1" tabindex="-1"></a>df.loc[(<span class="bu">slice</span>(<span class="va">None</span>), <span class="st">&#39;Arizona&#39;</span>), :]</span></code></pre></div>
<pre class="python_output"><code>                  individuals  family_members  state_pop
region   state                                          
Mountain Arizona       7259.0          2606.0    7158024</code></pre>
<p><strong>Slice cho MultiIndex</strong></p>
<p>Slice từ 1 tuple nhãn đến một nhãn đơn</p>
<div class="sourceCode" id="cb411"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb411-1"><a href="#cb411-1" tabindex="-1"></a>df.loc[(<span class="st">&#39;Mountain&#39;</span>, <span class="st">&#39;Colorado&#39;</span>):<span class="st">&#39;Pacific&#39;</span>]</span></code></pre></div>
<pre class="python_output"><code>                     individuals  family_members  state_pop
region   state                                             
Mountain Colorado         7607.0          3250.0    5691287
         Idaho            1297.0           715.0    1750536
Pacific  Alaska           1434.0           582.0     735139
         California     109008.0         20964.0   39461588
         Hawaii           4131.0          2399.0    1420593</code></pre>

<div class="rmdnote">
<strong><em>Lưu ý:</em></strong>
Nhãn đơn phía sau phải có cùng level với nhãn đầu tiên trong tuple. Trong ví dụ trên nếu thay <code>Pacific</code> thành <code>Hawaii</code> sẽ trả về rỗng. Nhưng khi truyền nhãn không nằm trong các nhãn của index thì vẫn có kết quả trả về
</div>
<div class="sourceCode" id="cb413"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb413-1"><a href="#cb413-1" tabindex="-1"></a>df.loc[(<span class="st">&#39;Mountain&#39;</span>, <span class="st">&#39;Colorado&#39;</span>): <span class="st">&#39;meow&#39;</span>]</span></code></pre></div>
<pre class="python_output"><code>                     individuals  family_members  state_pop
region   state                                             
Mountain Colorado         7607.0          3250.0    5691287
         Idaho            1297.0           715.0    1750536
Pacific  Alaska           1434.0           582.0     735139
         California     109008.0         20964.0   39461588
         Hawaii           4131.0          2399.0    1420593</code></pre>
<p>Slice từ 1 tuple nhãn đến một tuple nhãn</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb415-1"><a href="#cb415-1" tabindex="-1"></a>df.loc[(<span class="st">&#39;Mountain&#39;</span>, <span class="st">&#39;Colorado&#39;</span>):(<span class="st">&#39;Pacific&#39;</span>, <span class="st">&#39;California&#39;</span>)]</span></code></pre></div>
<pre class="python_output"><code>                     individuals  family_members  state_pop
region   state                                             
Mountain Colorado         7607.0          3250.0    5691287
         Idaho            1297.0           715.0    1750536
Pacific  Alaska           1434.0           582.0     735139
         California     109008.0         20964.0   39461588</code></pre>
<div id="iloc" class="section level3 hasAnchor" number="9.2.2">
<h3 class="hasAnchor"><span class="header-section-number">9.2.2</span> <code>.iloc</code><a href="#iloc" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Phương thức <code>.iloc</code> dùng để lấy dữ liệu theo cột hoặc hàng dựa theo index của nó, ngoài ra <code>.iloc</code> còn nhận các giá trị boolean.</p>
<p>Đầu vào của <code>.iloc</code> có thể gồm:</p>
<ul>
<li><p>Nhãn đơn: là 1 số <code>3</code></p></li>
<li><p>Danh sách các số : <code>[1, 2, 3]</code></p></li>
<li><p>Đối tượng dạng slice ví dụ <code>1:5</code></p></li>
<li><p>Danh sách kiểu <code>bool</code> có độ dài bằng với số lượng dòng</p></li>
</ul>
<p>Ví dụ với DataFrame</p>
<div class="sourceCode" id="cb417"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb417-1"><a href="#cb417-1" tabindex="-1"></a>                         state  individuals  family_members  state_pop</span>
<span id="cb417-2"><a href="#cb417-2" tabindex="-1"></a>region                                                                </span>
<span id="cb417-3"><a href="#cb417-3" tabindex="-1"></a>East South Central     Alabama       <span class="fl">2570.0</span>           <span class="fl">864.0</span>    <span class="dv">4887681</span></span>
<span id="cb417-4"><a href="#cb417-4" tabindex="-1"></a>Pacific                 Alaska       <span class="fl">1434.0</span>           <span class="fl">582.0</span>     <span class="dv">735139</span></span>
<span id="cb417-5"><a href="#cb417-5" tabindex="-1"></a>Mountain               Arizona       <span class="fl">7259.0</span>          <span class="fl">2606.0</span>    <span class="dv">7158024</span></span>
<span id="cb417-6"><a href="#cb417-6" tabindex="-1"></a>West South Central    Arkansas       <span class="fl">2280.0</span>           <span class="fl">432.0</span>    <span class="dv">3009733</span></span>
<span id="cb417-7"><a href="#cb417-7" tabindex="-1"></a>Pacific             California     <span class="fl">109008.0</span>         <span class="fl">20964.0</span>   <span class="dv">39461588</span></span>
<span id="cb417-8"><a href="#cb417-8" tabindex="-1"></a>Mountain              Colorado       <span class="fl">7607.0</span>          <span class="fl">3250.0</span>    <span class="dv">5691287</span></span></code></pre></div>
<p>Khi truyền 1 giá trị nguyên, <code>.iloc</code> trả về giá trị của dòng tại vị trí truyền vào với kiểu <code>Series</code></p>
<div class="sourceCode" id="cb418"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb418-1"><a href="#cb418-1" tabindex="-1"></a>df.iloc[<span class="dv">0</span>]</span></code></pre></div>
<pre class="python_output"><code>state             Alabama
individuals        2570.0
family_members      864.0
state_pop         4887681
Name: East South Central, dtype: object</code></pre>

<div class="rmdnote">
<strong><em>Lưu ý:</em></strong>
<code>Series</code> trả về không chứa nhãn của index, ở đây là nhãn <code>East South Central</code> của index <code>region</code>
</div>
<p>Để lấy dữ liệu theo cột, ví dụ muốn lấy cột <code>family_members</code> thì sẽ truyền index cột là <code>2</code></p>
<div class="sourceCode" id="cb420"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb420-1"><a href="#cb420-1" tabindex="-1"></a>df.iloc[:, <span class="dv">2</span>]</span></code></pre></div>
<pre class="python_output"><code>region
East South Central      864.0
Pacific                 582.0
Mountain               2606.0
West South Central      432.0
Pacific               20964.0
Mountain               3250.0
Name: family_members, dtype: float64</code></pre>

<div class="rmdtip">
<p><strong><em>Mẹo:</em></strong></p>
<ul>
<li><p><code>.iloc</code> bắt buộc truyền vào vị trí của cột, không cho phép tên cột.</p></li>
<li><p>Sử dụng <code>.columns.get_loc(&lt;tên cột&gt;)</code> để lấy vị trí của cột</p>
</div></li>
</ul>
<div class="sourceCode" id="cb422"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb422-1"><a href="#cb422-1" tabindex="-1"></a>df.iloc[:, df.columns.get_loc(<span class="st">&#39;family_members&#39;</span>)]</span></code></pre></div>
<pre class="python_output"><code>region
East South Central      864.0
Pacific                 582.0
Mountain               2606.0
West South Central      432.0
Pacific               20964.0
Mountain               3250.0
Name: family_members, dtype: float64</code></pre>
<p>Select theo danh sách, mặc định đưa vào 1 danh sách <code>Pandas</code> sẽ hiểu là lấy theo các dòng</p>
<div class="sourceCode" id="cb424"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb424-1"><a href="#cb424-1" tabindex="-1"></a>df.iloc[[<span class="dv">1</span>, <span class="dv">3</span> ,<span class="dv">5</span>]]</span></code></pre></div>
<pre class="python_output"><code>                   individuals  family_members  state_pop
region   state                                           
Mountain Colorado       7607.0          3250.0    5691287
Pacific  Alaska         1434.0           582.0     735139
         Hawaii         4131.0          2399.0    1420593</code></pre>

<div class="rmdtip">
<strong><em>Mẹo:</em></strong>
Dòng lệnh trên cũng tương đương với <code>df.iloc[[1, 3 ,5], :]</code>, trong đó <code>:</code> dùng để lấy toàn bộ
</div>
<p>Tương tự để lấy theo danh sách index các cột</p>
<div class="sourceCode" id="cb426"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb426-1"><a href="#cb426-1" tabindex="-1"></a>df.iloc[:, [<span class="dv">0</span>, <span class="dv">2</span>]]</span></code></pre></div>
<pre class="python_output"><code>                     individuals  state_pop
region   state                             
Mountain Arizona          7259.0    7158024
         Colorado         7607.0    5691287
         Idaho            1297.0    1750536
Pacific  Alaska           1434.0     735139
         California     109008.0   39461588
         Hawaii           4131.0    1420593</code></pre>
<p>Slice cả 2 chiều</p>
<div class="sourceCode" id="cb428"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb428-1"><a href="#cb428-1" tabindex="-1"></a>df.iloc[<span class="dv">2</span>:<span class="dv">4</span>, <span class="dv">0</span>:<span class="dv">2</span>]</span></code></pre></div>
<pre class="python_output"><code>                 individuals  family_members
region   state                              
Mountain Idaho        1297.0           715.0
Pacific  Alaska       1434.0           582.0</code></pre>
<p>Sử dụng danh sách các boolean</p>
<div class="sourceCode" id="cb430"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb430-1"><a href="#cb430-1" tabindex="-1"></a><span class="co"># Theo dòng</span></span>
<span id="cb430-2"><a href="#cb430-2" tabindex="-1"></a>df.iloc[[<span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>, <span class="va">False</span>, <span class="va">False</span>, <span class="va">True</span>], :]</span></code></pre></div>
<pre class="python_output"><code>                  individuals  family_members  state_pop
region   state                                          
Mountain Arizona       7259.0          2606.0    7158024
         Idaho         1297.0           715.0    1750536
Pacific  Hawaii        4131.0          2399.0    1420593</code></pre>
<div class="sourceCode" id="cb432"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb432-1"><a href="#cb432-1" tabindex="-1"></a>df.iloc[:, [<span class="va">False</span>, <span class="va">True</span>,<span class="va">False</span>]]</span></code></pre></div>
<pre class="python_output"><code>                     family_members
region   state                     
Mountain Arizona             2606.0
         Colorado            3250.0
         Idaho                715.0
Pacific  Alaska               582.0
         California         20964.0
         Hawaii              2399.0</code></pre>
<div id="lọc-theo-điều-kiện" class="section level2 hasAnchor" number="9.3">
<h2 class="hasAnchor"><span class="header-section-number">9.3</span> Lọc theo điều kiện<a href="#l%E1%BB%8Dc-theo-%C4%91i%E1%BB%81u-ki%E1%BB%87n" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Các phương thức <code>[]</code>, <code>.loc</code> hay <code>.iloc</code> ngoài việc lấy dữ liệu theo hàng và cột còn có thể lấy ra những bảng con theo các điều kiện cho trước. Bản chất các câu điều kiện sẽ trả về một danh sách dạng bolean và các hàm trên thực hiện lọc theo danh sách đó.</p>
<p>Trước hết ta cần biết câu điều kiện trong Pandas như thế nào. Ví dụ ta có 1 <code>DataFrame</code> như sau</p>
<div class="sourceCode" id="cb434"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb434-1"><a href="#cb434-1" tabindex="-1"></a>               state  individuals  family_members  state_pop</span>
<span id="cb434-2"><a href="#cb434-2" tabindex="-1"></a>region                                                      </span>
<span id="cb434-3"><a href="#cb434-3" tabindex="-1"></a>Mountain     Arizona       <span class="fl">7259.0</span>          <span class="fl">2606.0</span>    <span class="dv">7158024</span></span>
<span id="cb434-4"><a href="#cb434-4" tabindex="-1"></a>Mountain    Colorado       <span class="fl">7607.0</span>          <span class="fl">3250.0</span>    <span class="dv">5691287</span></span>
<span id="cb434-5"><a href="#cb434-5" tabindex="-1"></a>Mountain       Idaho       <span class="fl">1297.0</span>           <span class="fl">715.0</span>    <span class="dv">1750536</span></span>
<span id="cb434-6"><a href="#cb434-6" tabindex="-1"></a>Pacific       Alaska       <span class="fl">1434.0</span>           <span class="fl">582.0</span>     <span class="dv">735139</span></span>
<span id="cb434-7"><a href="#cb434-7" tabindex="-1"></a>Pacific   California     <span class="fl">109008.0</span>         <span class="fl">20964.0</span>   <span class="dv">39461588</span></span>
<span id="cb434-8"><a href="#cb434-8" tabindex="-1"></a>Pacific       Hawaii       <span class="fl">4131.0</span>          <span class="fl">2399.0</span>    <span class="dv">1420593</span></span></code></pre></div>
<div id="toán-tử-điều-kiện" class="section level3 hasAnchor" number="9.3.1">
<h3 class="hasAnchor"><span class="header-section-number">9.3.1</span> Toán tử điều kiện<a href="#to%C3%A1n-t%E1%BB%AD-%C4%91i%E1%BB%81u-ki%E1%BB%87n" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Giả sử ta có một điều kiện rằng <code>df['individuals'] &gt; 5000</code>. Kết quả trả về là 1 <code>Series</code></p>
<div class="sourceCode" id="cb435"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb435-1"><a href="#cb435-1" tabindex="-1"></a>df[<span class="st">&#39;individuals&#39;</span>] <span class="op">&gt;</span> <span class="dv">5000</span></span></code></pre></div>
<pre class="python_output"><code>region
Mountain     True
Mountain     True
Mountain    False
Pacific     False
Pacific      True
Pacific     False
Name: individuals, dtype: bool</code></pre>
<p>Để lọc theo điều kiện này ta có các cách như sau</p>
<div class="sourceCode" id="cb437"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb437-1"><a href="#cb437-1" tabindex="-1"></a><span class="co">## Dùng []</span></span>
<span id="cb437-2"><a href="#cb437-2" tabindex="-1"></a>df[df[<span class="st">&#39;individuals&#39;</span>] <span class="op">&gt;</span> <span class="dv">5000</span>]</span></code></pre></div>
<pre class="python_output"><code>               state  individuals  family_members  state_pop
region                                                      
Mountain     Arizona       7259.0          2606.0    7158024
Mountain    Colorado       7607.0          3250.0    5691287
Pacific   California     109008.0         20964.0   39461588</code></pre>
<div class="sourceCode" id="cb439"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb439-1"><a href="#cb439-1" tabindex="-1"></a><span class="co">## Dùng .loc</span></span>
<span id="cb439-2"><a href="#cb439-2" tabindex="-1"></a>df.loc[df[<span class="st">&#39;individuals&#39;</span>] <span class="op">&gt;</span> <span class="dv">5000</span>]</span></code></pre></div>
<pre class="python_output"><code>               state  individuals  family_members  state_pop
region                                                      
Mountain     Arizona       7259.0          2606.0    7158024
Mountain    Colorado       7607.0          3250.0    5691287
Pacific   California     109008.0         20964.0   39461588</code></pre>

<div class="rmdnote">
<p><strong><em>Lưu ý:</em></strong>
<code>.iloc</code> không nhận <code>Series</code> boolean nhưng <code>array</code> thì có thể. Do đó ta có thể dùng <code>.values</code> để lấy kết quả của Câu điều kiện</p>
</div>
<div class="sourceCode" id="cb441"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb441-1"><a href="#cb441-1" tabindex="-1"></a><span class="co">## Dùng .iloc</span></span>
<span id="cb441-2"><a href="#cb441-2" tabindex="-1"></a>df.iloc[(df[<span class="st">&#39;individuals&#39;</span>] <span class="op">&gt;</span> <span class="dv">5000</span>).values]</span></code></pre></div>
<pre class="python_output"><code>               state  individuals  family_members  state_pop
region                                                      
Mountain     Arizona       7259.0          2606.0    7158024
Mountain    Colorado       7607.0          3250.0    5691287
Pacific   California     109008.0         20964.0   39461588</code></pre>
<p>Ta cũng có thể áp nhiều điều kiện cùng lúc, mỗi điều kiện phải nằm trong dấu ngoặc đơn <code>()</code> và giữa các kiều kiện là toán tử <code>&amp;</code> hoặc <code>|</code></p>
<div class="sourceCode" id="cb443"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb443-1"><a href="#cb443-1" tabindex="-1"></a><span class="co">## Nhiều câu điều kiện trên một cột</span></span>
<span id="cb443-2"><a href="#cb443-2" tabindex="-1"></a>df.loc[(df[<span class="st">&#39;individuals&#39;</span>] <span class="op">&gt;</span> <span class="dv">5000</span>) <span class="op">&amp;</span> (df[<span class="st">&#39;individuals&#39;</span>] <span class="op">&lt;</span> <span class="dv">10000</span>)]</span></code></pre></div>
<pre class="python_output"><code>             state  individuals  family_members  state_pop
region                                                    
Mountain   Arizona       7259.0          2606.0    7158024
Mountain  Colorado       7607.0          3250.0    5691287</code></pre>
<div class="sourceCode" id="cb445"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb445-1"><a href="#cb445-1" tabindex="-1"></a><span class="co">## Nhiều câu điều kiện ở nhiều cột</span></span>
<span id="cb445-2"><a href="#cb445-2" tabindex="-1"></a>df.loc[(df[<span class="st">&#39;individuals&#39;</span>] <span class="op">&gt;</span> <span class="dv">5000</span>) <span class="op">&amp;</span> (df[<span class="st">&#39;family_members&#39;</span>] <span class="op">&lt;</span> <span class="dv">10000</span>)]</span></code></pre></div>
<pre class="python_output"><code>             state  individuals  family_members  state_pop
region                                                    
Mountain   Arizona       7259.0          2606.0    7158024
Mountain  Colorado       7607.0          3250.0    5691287</code></pre>
<div class="sourceCode" id="cb447"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb447-1"><a href="#cb447-1" tabindex="-1"></a><span class="co">## Một câu điều kiện trên nhiều cột</span></span>
<span id="cb447-2"><a href="#cb447-2" tabindex="-1"></a>df[df[<span class="st">&#39;individuals&#39;</span>] <span class="op">&gt;</span> <span class="dv">5</span> <span class="op">*</span> df[<span class="st">&#39;family_members&#39;</span>]]</span></code></pre></div>
<pre class="python_output"><code>              state  individuals  family_members  state_pop
region                                                     
Pacific  California     109008.0         20964.0   39461588</code></pre>

<div class="rmdtip">
<strong><em>Mẹo:</em></strong>
Bạn cũng có thể dùng <code>loc</code> để vừa lọc các dòng thỏa điều kiện, vừa chọn các cột muốn lấy
</div>
<div class="sourceCode" id="cb449"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb449-1"><a href="#cb449-1" tabindex="-1"></a>df.loc[df[<span class="st">&#39;individuals&#39;</span>] <span class="op">&gt;</span> <span class="dv">5</span> <span class="op">*</span> df[<span class="st">&#39;family_members&#39;</span>], [<span class="st">&#39;individuals&#39;</span>, <span class="st">&#39;family_members&#39;</span>]]</span></code></pre></div>
<pre class="python_output"><code>         individuals  family_members
region                              
Pacific     109008.0         20964.0</code></pre>
<p>Ngoài ra, <code>pandas</code> còn cho phép bạn lọc với cấu trúc câu truy vấn bằng <code>.query</code> theo cú pháp</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb451-1"><a href="#cb451-1" tabindex="-1"></a>DataFrame.query(expr, inplace<span class="op">=</span><span class="va">False</span>, <span class="op">**</span>kwargs)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>expr</code>: là câu truy vấn</p></li>
<li><p><code>inplace</code>: thực hiện trên chính <code>DataFrame</code> đó hay tạo 1 bảng sao</p></li>
<li><p><code>**kwargs</code>: keyword arguments</p></li>
</ul>
<p>Theo ví dụ trên, để thực hiện lọc theo điều kiện <code>df['individuals'] &gt; 5000</code> và <code>df['family_members'] &lt; 10000</code> ta có thể làm như sau</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb452-1"><a href="#cb452-1" tabindex="-1"></a>df.query(<span class="st">&#39;individuals &gt; 500 and family_members &lt; 10000&#39;</span>)</span></code></pre></div>
<pre class="python_output"><code>             state  individuals  family_members  state_pop
region                                                    
Mountain   Arizona       7259.0          2606.0    7158024
Mountain  Colorado       7607.0          3250.0    5691287</code></pre>
</div>
<div id="isin" class="section level3 hasAnchor" number="9.3.2">
<h3 class="hasAnchor"><span class="header-section-number">9.3.2</span> <code>.isin()</code><a href="#isin" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Phương thức <code>.isin(values)</code> để kiểm tra các phần tử trong <code>DataFrame</code> hoặc <code>Series</code> có nằm trong values hay không.</p>
<p>Ví dụ:</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb454-1"><a href="#cb454-1" tabindex="-1"></a>df.isin([<span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Oklahoma&#39;</span>, <span class="st">&#39;Illinois&#39;</span>, <span class="st">&#39;Arizona&#39;</span>, <span class="dv">7259</span>, <span class="dv">582</span>, <span class="dv">300</span>])</span></code></pre></div>
<pre class="python_output"><code>          state  individuals  family_members  state_pop
region                                                 
Mountain   True         True           False      False
Mountain  False        False           False      False
Mountain  False        False           False      False
Pacific    True        False            True      False
Pacific   False        False           False      False
Pacific   False        False           False      False</code></pre>
<div class="sourceCode" id="cb456"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb456-1"><a href="#cb456-1" tabindex="-1"></a>df[<span class="st">&#39;state&#39;</span>].isin([<span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Oklahoma&#39;</span>, <span class="st">&#39;Illinois&#39;</span>, <span class="st">&#39;Arizona&#39;</span>])</span></code></pre></div>
<pre class="python_output"><code>region
Mountain     True
Mountain    False
Mountain    False
Pacific      True
Pacific     False
Pacific     False
Name: state, dtype: bool</code></pre>
<p>Ngoài ra bạn có thể truyền <code>values</code> là một <code>dictionary</code> để kiểm tra cho từng cột theo từng tập giá trị</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb458-1"><a href="#cb458-1" tabindex="-1"></a>df.isin({<span class="st">&#39;state&#39;</span>: [<span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Oklahoma&#39;</span>, <span class="st">&#39;Illinois&#39;</span>, <span class="st">&#39;Arizona&#39;</span>], </span>
<span id="cb458-2"><a href="#cb458-2" tabindex="-1"></a>         <span class="st">&#39;individuals&#39;</span>: [<span class="dv">7259</span>, <span class="dv">582</span>, <span class="dv">300</span>]})</span></code></pre></div>
<pre class="python_output"><code>          state  individuals  family_members  state_pop
region                                                 
Mountain   True         True           False      False
Mountain  False        False           False      False
Mountain  False        False           False      False
Pacific    True        False           False      False
Pacific   False        False           False      False
Pacific   False        False           False      False</code></pre>
<p>Lọc với <code>.isin()</code></p>
<div class="sourceCode" id="cb460"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb460-1"><a href="#cb460-1" tabindex="-1"></a>df[df[<span class="st">&#39;state&#39;</span>].isin([<span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Oklahoma&#39;</span>, <span class="st">&#39;Illinois&#39;</span>, <span class="st">&#39;Arizona&#39;</span>])]</span></code></pre></div>
<pre class="python_output"><code>            state  individuals  family_members  state_pop
region                                                   
Mountain  Arizona       7259.0          2606.0    7158024
Pacific    Alaska       1434.0           582.0     735139</code></pre>
<p>trong trường hợp sự dụng <code>.isin</code> với <code>DataFrame</code>, kết quả của lọc sẽ trả về một <code>DataFrame</code> với giá trị các phần tử mà phép <code>isin</code> trả về <code>True</code>, các phần tử còn lại trả giá trị <code>NaN</code></p>
<div class="sourceCode" id="cb462"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb462-1"><a href="#cb462-1" tabindex="-1"></a>df[df.isin([<span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Oklahoma&#39;</span>, <span class="st">&#39;Illinois&#39;</span>, <span class="st">&#39;Arizona&#39;</span>, <span class="dv">7259</span>, <span class="dv">582</span>, <span class="dv">300</span>])]</span></code></pre></div>
<pre class="python_outputs"><code>            state  individuals  family_members  state_pop
region                                                   
Mountain  Arizona       7259.0             NaN        NaN
Mountain      NaN          NaN             NaN        NaN
Mountain      NaN          NaN             NaN        NaN
Pacific    Alaska          NaN           582.0        NaN
Pacific       NaN          NaN             NaN        NaN
Pacific       NaN          NaN             NaN        NaN</code></pre>

<div class="rmdtip">
<p><strong><em>Mẹo:</em></strong></p>
<ul>
<li><p>Bạn có dùng <code>.any()</code> để tổng hợp điều kiện của 1 DataFrame với các phần tử <code>boolean</code></p></li>
<li><p><code>.any(axis=1)</code> : Chỉ cần tồn tại 1 cột giá trị True, trả về giá trị True cho dòng</p></li>
<li><p><code>.any(axis=0)</code>: Chỉ cần tồn tại 1 dòng có giá trị True, trả về giá trị True cho cột.</p></li>
<li><p>Phương thức <code>.any()</code> thường dùng để kiểm tra các dòng tồn tại 1 cột giá trị <code>NaN</code></p>
</div></li>
</ul>
<p>Lọc với <code>.isin()</code> và <code>any(axis=1)</code></p>
<div class="sourceCode" id="cb464"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb464-1"><a href="#cb464-1" tabindex="-1"></a>df.isin([<span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Oklahoma&#39;</span>, <span class="st">&#39;Illinois&#39;</span>, <span class="st">&#39;Arizona&#39;</span>, <span class="dv">7259</span>, <span class="dv">582</span>, <span class="dv">300</span>]).<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<pre class="python_output"><code>region
Mountain     True
Mountain    False
Mountain    False
Pacific      True
Pacific     False
Pacific     False
dtype: bool</code></pre>
<div class="sourceCode" id="cb466"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb466-1"><a href="#cb466-1" tabindex="-1"></a>df[df.isin([<span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Oklahoma&#39;</span>, <span class="st">&#39;Illinois&#39;</span>, <span class="st">&#39;Arizona&#39;</span>, <span class="dv">7259</span>, <span class="dv">582</span>, <span class="dv">300</span>]).<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span></code></pre></div>
<pre class="python_output"><code>            state  individuals  family_members  state_pop
region                                                   
Mountain  Arizona       7259.0          2606.0    7158024
Pacific    Alaska       1434.0           582.0     735139</code></pre>
<p>Lọc với <code>isin()</code> và <code>any(axis=0)</code></p>
<div class="sourceCode" id="cb468"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb468-1"><a href="#cb468-1" tabindex="-1"></a>df.isin([<span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Oklahoma&#39;</span>, <span class="st">&#39;Illinois&#39;</span>, <span class="st">&#39;Arizona&#39;</span>, <span class="dv">7259</span>, <span class="dv">582</span>, <span class="dv">300</span>]).<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">0</span>)</span></code></pre></div>
<pre class="python_output"><code>state              True
individuals        True
family_members     True
state_pop         False
dtype: bool</code></pre>
<div class="sourceCode" id="cb470"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb470-1"><a href="#cb470-1" tabindex="-1"></a>df.loc[:,df.isin([<span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Oklahoma&#39;</span>, <span class="st">&#39;Illinois&#39;</span>, <span class="st">&#39;Arizona&#39;</span>, <span class="dv">7259</span>, <span class="dv">582</span>, <span class="dv">300</span>]).<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">0</span>)]</span></code></pre></div>
<pre class="python_output"><code>               state  individuals  family_members
region                                           
Mountain     Arizona       7259.0          2606.0
Mountain    Colorado       7607.0          3250.0
Mountain       Idaho       1297.0           715.0
Pacific       Alaska       1434.0           582.0
Pacific   California     109008.0         20964.0
Pacific       Hawaii       4131.0          2399.0</code></pre>
<p>Lọc với <code>isin()</code> và <code>any(axis=0)</code> và <code>any(axis=1)</code></p>
<div class="sourceCode" id="cb472"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb472-1"><a href="#cb472-1" tabindex="-1"></a>bool_df <span class="op">=</span> df.isin([<span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Oklahoma&#39;</span>, <span class="st">&#39;Illinois&#39;</span>, <span class="st">&#39;Arizona&#39;</span>, <span class="dv">7259</span>, <span class="dv">582</span>, <span class="dv">300</span>])</span>
<span id="cb472-2"><a href="#cb472-2" tabindex="-1"></a>df.loc[bool_df.<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>), bool_df.<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">0</span>)]</span></code></pre></div>
<pre class="python_output"><code>            state  individuals  family_members
region                                        
Mountain  Arizona       7259.0          2606.0
Pacific    Alaska       1434.0           582.0</code></pre>
<div id="lọc-missing-value-với-.dropna" class="section level3 hasAnchor" number="9.3.3">
<h3 class="hasAnchor"><span class="header-section-number">9.3.3</span> Lọc missing value với <code>.dropna()</code><a href="#l%E1%BB%8Dc-missing-value-v%E1%BB%9Bi-.dropna" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Trong quá trình xử lý dữ liệu, chúng ta thường gặp những bảng có chứa giá trị missing value. Ví dụ bảng <code>missing_df</code></p>
<div class="sourceCode" id="cb474"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb474-1"><a href="#cb474-1" tabindex="-1"></a>               state  individuals  family_members   state_pop</span>
<span id="cb474-2"><a href="#cb474-2" tabindex="-1"></a>region                                                       </span>
<span id="cb474-3"><a href="#cb474-3" tabindex="-1"></a>Mountain     Arizona       <span class="fl">7259.0</span>             NaN         NaN</span>
<span id="cb474-4"><a href="#cb474-4" tabindex="-1"></a>Mountain    Colorado          NaN          <span class="fl">3250.0</span>   <span class="fl">5691287.0</span></span>
<span id="cb474-5"><a href="#cb474-5" tabindex="-1"></a>Mountain       Idaho       <span class="fl">1297.0</span>           <span class="fl">715.0</span>   <span class="fl">1750536.0</span></span>
<span id="cb474-6"><a href="#cb474-6" tabindex="-1"></a>Pacific       Alaska       <span class="fl">1434.0</span>             NaN    <span class="fl">735139.0</span></span>
<span id="cb474-7"><a href="#cb474-7" tabindex="-1"></a>Pacific   California     <span class="fl">109008.0</span>         <span class="fl">20964.0</span>  <span class="fl">39461588.0</span></span>
<span id="cb474-8"><a href="#cb474-8" tabindex="-1"></a>Pacific       Hawaii       <span class="fl">4131.0</span>          <span class="fl">2399.0</span>         NaN</span></code></pre></div>
<p>Để lọc dữ liệu chứa <code>NaN</code> ta dùng phương thức <code>.dropna()</code></p>
<div class="sourceCode" id="cb475"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb475-1"><a href="#cb475-1" tabindex="-1"></a>DataFrame.dropna(axis<span class="op">=</span><span class="dv">0</span>, how<span class="op">=</span><span class="st">&#39;any&#39;</span>, thresh<span class="op">=</span><span class="va">None</span>, subset<span class="op">=</span><span class="va">None</span>, inplace<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>axis</code>: Nhận diện lọc theo dòng <code>0</code>, <code>index</code>, hay cột <code>1</code>, <code>column</code></p></li>
<li><p><code>how</code>: Chỉ định cách lọc</p>
<ul>
<li><code>any</code>: Nếu có bất kì <code>NA</code>, loại bỏ dòng hoặc cột</li>
<li><code>all</code>: Nếu tất cả là <code>NA</code>, loại bỏ dòng hoặc cột</li>
</ul></li>
<li><p><code>thresh</code>: Số lượng <code>non-NA</code> yêu cầu</p></li>
<li><p><code>subset</code>: Chỉ định các cột cần lọc</p></li>
<li><p><code>inplace</code>: Thực hiện trên chính <code>DataFrame</code> hay tạo bản sao.</p></li>
</ul>
<p>Lọc bỏ các hàng nếu ít nhất một phần tử <code>NA</code></p>
<div class="sourceCode" id="cb476"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb476-1"><a href="#cb476-1" tabindex="-1"></a>missing_df.dropna(axis<span class="op">=</span><span class="dv">0</span>)</span></code></pre></div>
<pre class="python_output"><code>               state  individuals  family_members   state_pop
region                                                       
Mountain       Idaho       1297.0           715.0   1750536.0
Pacific   California     109008.0         20964.0  39461588.0</code></pre>
<p>Lọc bỏ các cột nếu ít nhất một phần tử <code>NA</code></p>
<div class="sourceCode" id="cb478"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb478-1"><a href="#cb478-1" tabindex="-1"></a>missing_df.dropna(axis<span class="op">=</span><span class="st">&#39;columns&#39;</span>)</span></code></pre></div>
<pre class="python_output"><code>               state
region              
Mountain     Arizona
Mountain    Colorado
Mountain       Idaho
Pacific       Alaska
Pacific   California
Pacific       Hawaii</code></pre>
<p>Lọc bỏ các dòng nếu tất cả phần tử trong các cột <code>['family_members', 'state_pop']</code> là <code>NA</code></p>
<div class="sourceCode" id="cb480"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb480-1"><a href="#cb480-1" tabindex="-1"></a>missing_df.dropna(axis<span class="op">=</span><span class="st">&#39;index&#39;</span>, how<span class="op">=</span><span class="st">&#39;all&#39;</span>, subset<span class="op">=</span>[<span class="st">&#39;family_members&#39;</span>, <span class="st">&#39;state_pop&#39;</span>])</span></code></pre></div>
<pre class="python_output"><code>               state  individuals  family_members   state_pop
region                                                       
Mountain    Colorado          NaN          3250.0   5691287.0
Mountain       Idaho       1297.0           715.0   1750536.0
Pacific       Alaska       1434.0             NaN    735139.0
Pacific   California     109008.0         20964.0  39461588.0
Pacific       Hawaii       4131.0          2399.0         NaN</code></pre>
<p>Giữ lại các dòng có ít nhất <code>3</code> phần tử <code>non-NA</code></p>
<div class="sourceCode" id="cb482"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb482-1"><a href="#cb482-1" tabindex="-1"></a>missing_df.dropna(thresh<span class="op">=</span><span class="dv">3</span>)</span></code></pre></div>
<pre class="python_output"><code>               state  individuals  family_members   state_pop
region                                                       
Mountain    Colorado          NaN          3250.0   5691287.0
Mountain       Idaho       1297.0           715.0   1750536.0
Pacific       Alaska       1434.0             NaN    735139.0
Pacific   California     109008.0         20964.0  39461588.0
Pacific       Hawaii       4131.0          2399.0         NaN</code></pre>
<!--chapter:end:posts/04-Select_Filter.Rmd-->
</div>
<div id="chọn-và-lọc-dữ-liệu-trong-datafame" class="section level1 hasAnchor" number="10">
<h1 class="hasAnchor"><span class="header-section-number">10</span> Chọn và lọc dữ liệu trong DataFame<a href="#ch%E1%BB%8Dn-v%C3%A0-l%E1%BB%8Dc-d%E1%BB%AF-li%E1%BB%87u-trong-datafame" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:posts/04-SelectingAndFiltering/00-Introduction.Rmd-->
<div id="sử-dụng-1" class="section level2 hasAnchor" number="10.1">
<h2 class="hasAnchor"><span class="header-section-number">10.1</span> Sử dụng <code>[]</code><a href="#s%E1%BB%AD-d%E1%BB%A5ng-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Cú pháp <code>[]</code> là cú pháp đơn giản nhất để lấy bảng con của 1 bảng cho trước.
Với 1 <code>df</code> là 1 <code>DataFrame</code> có index là <code>region</code> và dữ liệu như sau</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb484-1"><a href="#cb484-1" tabindex="-1"></a>                         state  individuals  family_members  state_pop</span>
<span id="cb484-2"><a href="#cb484-2" tabindex="-1"></a>region                                                                </span>
<span id="cb484-3"><a href="#cb484-3" tabindex="-1"></a>East South Central     Alabama       <span class="fl">2570.0</span>           <span class="fl">864.0</span>    <span class="dv">4887681</span></span>
<span id="cb484-4"><a href="#cb484-4" tabindex="-1"></a>Pacific                 Alaska       <span class="fl">1434.0</span>           <span class="fl">582.0</span>     <span class="dv">735139</span></span>
<span id="cb484-5"><a href="#cb484-5" tabindex="-1"></a>Mountain               Arizona       <span class="fl">7259.0</span>          <span class="fl">2606.0</span>    <span class="dv">7158024</span></span>
<span id="cb484-6"><a href="#cb484-6" tabindex="-1"></a>West South Central    Arkansas       <span class="fl">2280.0</span>           <span class="fl">432.0</span>    <span class="dv">3009733</span></span>
<span id="cb484-7"><a href="#cb484-7" tabindex="-1"></a>Pacific             California     <span class="fl">109008.0</span>         <span class="fl">20964.0</span>   <span class="dv">39461588</span></span>
<span id="cb484-8"><a href="#cb484-8" tabindex="-1"></a>Mountain              Colorado       <span class="fl">7607.0</span>          <span class="fl">3250.0</span>    <span class="dv">5691287</span></span></code></pre></div>
<p>Để chọn 1 bảng con có 2 cột <code>['state', 'family_members']</code> ta làm như sau</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb485-1"><a href="#cb485-1" tabindex="-1"></a>df[[<span class="st">&#39;state&#39;</span>, <span class="st">&#39;family_members&#39;</span>]]</span></code></pre></div>
<pre class="python_output"><code>                         state  family_members
region                                        
East South Central     Alabama           864.0
Pacific                 Alaska           582.0
Mountain               Arizona          2606.0
West South Central    Arkansas           432.0
Pacific             California         20964.0
Mountain              Colorado          3250.0</code></pre>
<p>Để lấy theo dòng ta dùng tương tự <code>Series</code></p>
<div class="sourceCode" id="cb487"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb487-1"><a href="#cb487-1" tabindex="-1"></a>df[:<span class="dv">3</span>]</span></code></pre></div>
<pre class="python_output"><code>                      state  individuals  family_members  state_pop
region                                                             
East South Central  Alabama       2570.0           864.0    4887681
Pacific              Alaska       1434.0           582.0     735139
Mountain            Arizona       7259.0          2606.0    7158024
</code></pre>
<div class="sourceCode" id="cb489"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb489-1"><a href="#cb489-1" tabindex="-1"></a>df[<span class="dv">2</span>:<span class="dv">5</span>]</span></code></pre></div>
<pre class="python_output"><code>                         state  individuals  family_members  state_pop
region                                                                
Mountain               Arizona       7259.0          2606.0    7158024
West South Central    Arkansas       2280.0           432.0    3009733
Pacific             California     109008.0         20964.0   39461588</code></pre>

<div class="rmdnote">
<p><strong><em>Lưu ý:</em></strong></p>
<ul>
<li><p><code>df[['state']]</code> sẽ trả về <code>DataFrame</code> trong khi <code>df['state']</code> trả về <code>Series</code>.</p></li>
<li><p>Đối với lấy theo dòng, <code>[]</code> không lấy được theo dòng riêng biệt.</p></li>
<li><p><code>[]</code> chỉ lấy dữ liệu theo dòng hoặc cột, không thực hiện được cùng lúc cả hai thao tác.</p>
</div>
<p>Ví dụ khi gọi <code>df[3]</code> hay <code>df[[1, 2, 3]]</code> sẽ báo lỗi <code>KeyError</code></p></li>
</ul>
<!--chapter:end:posts/04-SelectingAndFiltering/01-Select_Use_Bracket.Rmd-->
<div id="sử-dụng-.loc" class="section level2 hasAnchor" number="10.2">
<h2 class="hasAnchor"><span class="header-section-number">10.2</span> Sử dụng .loc<a href="#s%E1%BB%AD-d%E1%BB%A5ng-.loc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.loc</code> dùng để lấy dữ liệu theo cột hoặc hàng dựa theo nhãn định sẵn (Tên hàng, tên cột), ngoài ra <code>.loc</code> còn nhận các giá trị boolean.</p>
<p>Đầu vào của <code>.loc</code> có thể gồm:</p>
<ul>
<li><p>Nhãn đơn: là 1 số <code>3</code> hoặc dạng chữ <code>a</code>, lưu ý rằng số này là nhãn của <code>index</code> chứ không phải vị trí của dòng.</p></li>
<li><p>Danh sách các nhãn : <code>['a', 'b', 'c']</code></p></li>
<li><p>Đối tượng dạng slice ví dụ <code>'a':'e'</code></p></li>
<li><p>Danh sách kiểu <code>bool</code> có độ dài bằng với số lượng dòng</p></li>
<li><p><code>Series</code> dạng <code>bool</code></p></li>
<li><p><code>pd.Index</code></p></li>
</ul>
<p>Sử dụng nhãn đơn, kết quả trả về là các dòng có nhãn giống như nhãn trong <code>.loc</code></p>
<div class="sourceCode" id="cb491"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb491-1"><a href="#cb491-1" tabindex="-1"></a>df.loc[<span class="st">&#39;Pacific&#39;</span>]</span></code></pre></div>
<pre class="python_output"><code>              state  individuals  family_members  state_pop
region                                                     
Pacific      Alaska       1434.0           582.0     735139
Pacific  California     109008.0         20964.0   39461588</code></pre>

<div class="rmdnote">
<p><strong><em>Lưu ý:</em></strong></p>
Khi kết quả là nhiều dòng thì dữ liệu trả về có kiểu <code>DataFrame</code>, trong khi nếu chỉ có 1 dòng duy nhất thì kết quả trả về sẽ theo kiểu <code>Series</code>
</div>
<div class="sourceCode" id="cb493"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb493-1"><a href="#cb493-1" tabindex="-1"></a><span class="bu">type</span>(df.loc[<span class="st">&#39;Pacific&#39;</span>])</span></code></pre></div>
<pre class="python_output"><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;</code></pre>
<div class="sourceCode" id="cb495"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb495-1"><a href="#cb495-1" tabindex="-1"></a><span class="bu">type</span>(df.loc[<span class="st">&#39;West South Central&#39;</span>])</span></code></pre></div>
<pre class="python_output"><code>&lt;class &#39;pandas.core.series.Series&#39;&gt;</code></pre>
<p>Khi đưa danh sách các nhãn dùng <code>.loc[[]]</code> thì nhãn đưa vào là nhãn của <code>index</code>. Nếu đưa tên các cột sẽ bị báo lỗi <code>KeyError</code></p>
<div class="sourceCode" id="cb497"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb497-1"><a href="#cb497-1" tabindex="-1"></a>df.loc[[<span class="st">&#39;Pacific&#39;</span>, <span class="st">&#39;Mountain&#39;</span>]]</span></code></pre></div>
<pre class="python_output"><code>               state  individuals  family_members  state_pop
region                                                      
Pacific       Alaska       1434.0           582.0     735139
Pacific   California     109008.0         20964.0   39461588
Mountain     Arizona       7259.0          2606.0    7158024
Mountain    Colorado       7607.0          3250.0    5691287</code></pre>
<p>Để lấy nhãn đơn theo nhãn của <code>index</code> và tên <code>column</code> ta truyền vào phần nhãn của <code>index</code> trước và nhãn của <code>column</code> sau và phân biệt bởi dấu phẩy</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb499-1"><a href="#cb499-1" tabindex="-1"></a>df.loc[<span class="st">&#39;Pacific&#39;</span>, <span class="st">&#39;state&#39;</span>]</span></code></pre></div>
<pre class="python_output"><code>region
Pacific        Alaska
Pacific    California
Name: state, dtype: object</code></pre>
<p>Để lấy nhiều hơn 1 nhãn của <code>index</code> hoặc nhiều hơn 1 nhãn của <code>column</code> ta chỉ cần thay thế nhãn đơn của <code>index</code> thành danh sách hoặc slice, tương tự ta có thế thay thế nhãn đơn thành danh sách hoặc slice của <code>column</code></p>
<div class="sourceCode" id="cb501"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb501-1"><a href="#cb501-1" tabindex="-1"></a>df.loc[<span class="st">&#39;Pacific&#39;</span>, [<span class="st">&#39;individuals&#39;</span>, <span class="st">&#39;family_members&#39;</span>]])</span></code></pre></div>
<pre class="python_output"><code>         individuals  family_members
region                              
Pacific       1434.0           582.0
Pacific     109008.0         20964.0</code></pre>
<div class="sourceCode" id="cb503"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb503-1"><a href="#cb503-1" tabindex="-1"></a>df.loc[<span class="st">&#39;Pacific&#39;</span>, <span class="st">&#39;individuals&#39;</span>:<span class="st">&#39;state_pop&#39;</span>]</span></code></pre></div>
<pre class="python_output"><code>         individuals  family_members  state_pop
region                                         
Pacific       1434.0           582.0     735139
Pacific     109008.0         20964.0   39461588</code></pre>

<div class="rmdnote">
<p><strong><em>Lưu ý:</em></strong></p>
<ul>
<li><p>Dùng slice sẽ lấy theo thứ tự xuất hiện chứ không lấy theo thứ tự sắp xếp từ điển, như ví dụ trên thì mặc dù <code>family_members</code> &gt; <code>individuals</code> nhưng vẫn xếp sau.</p></li>
<li><p>Slice không áp dụng được cho <code>index</code> có nhãn trùng nhau, nếu dùng sẽ báo lỗi <code>KeyError: "Cannot get right slice bound for non-unique label:</code></p>
</div></li>
</ul>
<p>Danh sách dạng <code>boolean</code>, chỉ sử dụng cho <code>index</code>, không dùng cho <code>column</code></p>
<div class="sourceCode" id="cb505"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb505-1"><a href="#cb505-1" tabindex="-1"></a>df.loc[[<span class="va">False</span>, <span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>, <span class="va">False</span>, <span class="va">False</span>]]</span></code></pre></div>
<pre class="python_output"><code>                       state  individuals  family_members  state_pop
region                                                              
Pacific               Alaska       1434.0           582.0     735139
West South Central  Arkansas       2280.0           432.0    3009733</code></pre>
<p>Series boolean</p>
<div class="sourceCode" id="cb507"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb507-1"><a href="#cb507-1" tabindex="-1"></a>s <span class="op">=</span> pd.Series([<span class="va">False</span>, <span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>, <span class="va">False</span>, <span class="va">False</span>],</span>
<span id="cb507-2"><a href="#cb507-2" tabindex="-1"></a>              index<span class="op">=</span>[<span class="st">&#39;East South Central&#39;</span>, <span class="st">&#39;Pacific&#39;</span>, <span class="st">&#39;Mountain&#39;</span>, <span class="st">&#39;West South Central&#39;</span>, <span class="st">&#39;Pacific&#39;</span>, <span class="st">&#39;Mountain&#39;</span>])</span>
<span id="cb507-3"><a href="#cb507-3" tabindex="-1"></a>df.loc[s]</span></code></pre></div>
<pre class="python_output"><code>                       state  individuals  family_members  state_pop
region                                                              
Pacific               Alaska       1434.0           582.0     735139
West South Central  Arkansas       2280.0           432.0    3009733</code></pre>
<p><code>pd.Index</code></p>
<div class="sourceCode" id="cb509"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb509-1"><a href="#cb509-1" tabindex="-1"></a>df.loc[pd.Index([<span class="st">&quot;Pacific&quot;</span>, <span class="st">&quot;East South Central&quot;</span>], name<span class="op">=</span><span class="st">&quot;meow&quot;</span>)]</span></code></pre></div>
<pre class="python_output"><code>                         state  individuals  family_members  state_pop
meow                                                                   
Pacific                 Alaska       1434.0           582.0     735139
Pacific             California     109008.0         20964.0   39461588
East South Central     Alabama       2570.0           864.0    4887681</code></pre>
<p><strong>Select với <code>MultiIndex</code></strong></p>
<div class="sourceCode" id="cb511"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb511-1"><a href="#cb511-1" tabindex="-1"></a>                     individuals  family_members  state_pop</span>
<span id="cb511-2"><a href="#cb511-2" tabindex="-1"></a>region   state                                             </span>
<span id="cb511-3"><a href="#cb511-3" tabindex="-1"></a>Mountain Arizona          <span class="fl">7259.0</span>          <span class="fl">2606.0</span>    <span class="dv">7158024</span></span>
<span id="cb511-4"><a href="#cb511-4" tabindex="-1"></a>         Colorado         <span class="fl">7607.0</span>          <span class="fl">3250.0</span>    <span class="dv">5691287</span></span>
<span id="cb511-5"><a href="#cb511-5" tabindex="-1"></a>         Idaho            <span class="fl">1297.0</span>           <span class="fl">715.0</span>    <span class="dv">1750536</span></span>
<span id="cb511-6"><a href="#cb511-6" tabindex="-1"></a>Pacific  Alaska           <span class="fl">1434.0</span>           <span class="fl">582.0</span>     <span class="dv">735139</span></span>
<span id="cb511-7"><a href="#cb511-7" tabindex="-1"></a>         California     <span class="fl">109008.0</span>         <span class="fl">20964.0</span>   <span class="dv">39461588</span></span>
<span id="cb511-8"><a href="#cb511-8" tabindex="-1"></a>         Hawaii           <span class="fl">4131.0</span>          <span class="fl">2399.0</span>    <span class="dv">1420593</span></span></code></pre></div>
<p>Với nhãn đơn</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb512-1"><a href="#cb512-1" tabindex="-1"></a>df.loc[<span class="st">&#39;Mountain&#39;</span>]</span></code></pre></div>
<pre class="python_output"><code>          individuals  family_members  state_pop
state                                           
Arizona        7259.0          2606.0    7158024
Colorado       7607.0          3250.0    5691287
Idaho          1297.0           715.0    1750536</code></pre>

<div class="rmdnote">
<strong><em>Lưu ý:</em></strong>
Với <code>MultiIndex</code>,các index sẽ xếp theo thứ tự từ level 0 đến n (<code>level 0</code> cao hơn <code>level 1</code> …), với nhãn đơn là nhãn của 1 <code>index</code> thì chỉ thực hiện được index level đầu tiên, các index level sau sẽ báo lỗi.
Theo như ví dụ trên thì <code>region</code> có level cao hơn ‘state’ nên chỉ gọi được <code>.loc['Mountain']</code> còn <code>.loc['Arizona']</code> sẽ báo lỗi
</div>
<p>Để select nhiều index cùng lúc, ta truyền vào <code>tuple(label1, label2...)</code> theo thứ tự index có level từ cao đến thấp</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb514-1"><a href="#cb514-1" tabindex="-1"></a>df.loc[(<span class="st">&#39;Mountain&#39;</span>, <span class="st">&#39;Colorado&#39;</span>)]</span></code></pre></div>
<pre class="python_output"><code>individuals          7607.0
family_members       3250.0
state_pop         5691287.0
Name: (Mountain, Colorado), dtype: float64</code></pre>
<p>Tương tự ta cùng có select theo các column cho trước</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb516-1"><a href="#cb516-1" tabindex="-1"></a>df.loc[(<span class="st">&#39;Mountain&#39;</span>, <span class="st">&#39;Colorado&#39;</span>), [<span class="st">&#39;individuals&#39;</span>, <span class="st">&#39;family_members&#39;</span>]]</span></code></pre></div>
<pre class="python_output"><code>individuals       7607.0
family_members    3250.0
Name: (Mountain, Colorado), dtype: float64</code></pre>

<div class="rmdtip">
<p><strong><em>Mẹo:</em></strong>
Có thể select <code>index</code> ở các level sau bằng cách dùng <code>slice</code></p>
</div>
<div class="sourceCode" id="cb518"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb518-1"><a href="#cb518-1" tabindex="-1"></a>df.loc[(<span class="bu">slice</span>(<span class="va">None</span>), <span class="st">&#39;Arizona&#39;</span>), :]</span></code></pre></div>
<pre class="python_output"><code>                  individuals  family_members  state_pop
region   state                                          
Mountain Arizona       7259.0          2606.0    7158024</code></pre>
<p><strong>Slice cho MultiIndex</strong></p>
<p>Slice từ 1 tuple nhãn đến một nhãn đơn</p>
<div class="sourceCode" id="cb520"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb520-1"><a href="#cb520-1" tabindex="-1"></a>df.loc[(<span class="st">&#39;Mountain&#39;</span>, <span class="st">&#39;Colorado&#39;</span>):<span class="st">&#39;Pacific&#39;</span>]</span></code></pre></div>
<pre class="python_output"><code>                     individuals  family_members  state_pop
region   state                                             
Mountain Colorado         7607.0          3250.0    5691287
         Idaho            1297.0           715.0    1750536
Pacific  Alaska           1434.0           582.0     735139
         California     109008.0         20964.0   39461588
         Hawaii           4131.0          2399.0    1420593</code></pre>

<div class="rmdnote">
<strong><em>Lưu ý:</em></strong>
Nhãn đơn phía sau phải có cùng level với nhãn đầu tiên trong tuple. Trong ví dụ trên nếu thay <code>Pacific</code> thành <code>Hawaii</code> sẽ trả về rỗng. Nhưng khi truyền nhãn không nằm trong các nhãn của index thì vẫn có kết quả trả về
</div>
<div class="sourceCode" id="cb522"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb522-1"><a href="#cb522-1" tabindex="-1"></a>df.loc[(<span class="st">&#39;Mountain&#39;</span>, <span class="st">&#39;Colorado&#39;</span>): <span class="st">&#39;meow&#39;</span>]</span></code></pre></div>
<pre class="python_output"><code>                     individuals  family_members  state_pop
region   state                                             
Mountain Colorado         7607.0          3250.0    5691287
         Idaho            1297.0           715.0    1750536
Pacific  Alaska           1434.0           582.0     735139
         California     109008.0         20964.0   39461588
         Hawaii           4131.0          2399.0    1420593</code></pre>
<p>Slice từ 1 tuple nhãn đến một tuple nhãn</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb524-1"><a href="#cb524-1" tabindex="-1"></a>df.loc[(<span class="st">&#39;Mountain&#39;</span>, <span class="st">&#39;Colorado&#39;</span>):(<span class="st">&#39;Pacific&#39;</span>, <span class="st">&#39;California&#39;</span>)]</span></code></pre></div>
<pre class="python_output"><code>                     individuals  family_members  state_pop
region   state                                             
Mountain Colorado         7607.0          3250.0    5691287
         Idaho            1297.0           715.0    1750536
Pacific  Alaska           1434.0           582.0     735139
         California     109008.0         20964.0   39461588</code></pre>
<!--chapter:end:posts/04-SelectingAndFiltering/02-Select_Use_Loc.Rmd-->
<div id="sử-dụng-.iloc" class="section level2 hasAnchor" number="10.3">
<h2 class="hasAnchor"><span class="header-section-number">10.3</span> Sử dụng .iloc<a href="#s%E1%BB%AD-d%E1%BB%A5ng-.iloc" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.iloc</code> dùng để lấy dữ liệu theo cột hoặc hàng dựa theo index của nó, ngoài ra <code>.iloc</code> còn nhận các giá trị boolean.</p>
<p>Đầu vào của <code>.iloc</code> có thể gồm:</p>
<ul>
<li><p>Nhãn đơn: là 1 số <code>3</code></p></li>
<li><p>Danh sách các số : <code>[1, 2, 3]</code></p></li>
<li><p>Đối tượng dạng slice ví dụ <code>1:5</code></p></li>
<li><p>Danh sách kiểu <code>bool</code> có độ dài bằng với số lượng dòng</p></li>
</ul>
<p>Ví dụ với DataFrame</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb526-1"><a href="#cb526-1" tabindex="-1"></a>                         state  individuals  family_members  state_pop</span>
<span id="cb526-2"><a href="#cb526-2" tabindex="-1"></a>region                                                                </span>
<span id="cb526-3"><a href="#cb526-3" tabindex="-1"></a>East South Central     Alabama       <span class="fl">2570.0</span>           <span class="fl">864.0</span>    <span class="dv">4887681</span></span>
<span id="cb526-4"><a href="#cb526-4" tabindex="-1"></a>Pacific                 Alaska       <span class="fl">1434.0</span>           <span class="fl">582.0</span>     <span class="dv">735139</span></span>
<span id="cb526-5"><a href="#cb526-5" tabindex="-1"></a>Mountain               Arizona       <span class="fl">7259.0</span>          <span class="fl">2606.0</span>    <span class="dv">7158024</span></span>
<span id="cb526-6"><a href="#cb526-6" tabindex="-1"></a>West South Central    Arkansas       <span class="fl">2280.0</span>           <span class="fl">432.0</span>    <span class="dv">3009733</span></span>
<span id="cb526-7"><a href="#cb526-7" tabindex="-1"></a>Pacific             California     <span class="fl">109008.0</span>         <span class="fl">20964.0</span>   <span class="dv">39461588</span></span>
<span id="cb526-8"><a href="#cb526-8" tabindex="-1"></a>Mountain              Colorado       <span class="fl">7607.0</span>          <span class="fl">3250.0</span>    <span class="dv">5691287</span></span></code></pre></div>
<p>Khi truyền 1 giá trị nguyên, <code>.iloc</code> trả về giá trị của dòng tại vị trí truyền vào với kiểu <code>Series</code></p>
<div class="sourceCode" id="cb527"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb527-1"><a href="#cb527-1" tabindex="-1"></a>df.iloc[<span class="dv">0</span>]</span></code></pre></div>
<pre class="python_output"><code>state             Alabama
individuals        2570.0
family_members      864.0
state_pop         4887681
Name: East South Central, dtype: object</code></pre>

<div class="rmdnote">
<strong><em>Lưu ý:</em></strong>
<code>Series</code> trả về không chứa nhãn của index, ở đây là nhãn <code>East South Central</code> của index <code>region</code>
</div>
<p>Để lấy dữ liệu theo cột, ví dụ muốn lấy cột <code>family_members</code> thì sẽ truyền index cột là <code>2</code></p>
<div class="sourceCode" id="cb529"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb529-1"><a href="#cb529-1" tabindex="-1"></a>df.iloc[:, <span class="dv">2</span>]</span></code></pre></div>
<pre class="python_output"><code>region
East South Central      864.0
Pacific                 582.0
Mountain               2606.0
West South Central      432.0
Pacific               20964.0
Mountain               3250.0
Name: family_members, dtype: float64</code></pre>

<div class="rmdtip">
<p><strong><em>Mẹo:</em></strong></p>
<ul>
<li><p><code>.iloc</code> bắt buộc truyền vào vị trí của cột, không cho phép tên cột.</p></li>
<li><p>Sử dụng <code>.columns.get_loc(&lt;tên cột&gt;)</code> để lấy vị trí của cột</p>
</div></li>
</ul>
<div class="sourceCode" id="cb531"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb531-1"><a href="#cb531-1" tabindex="-1"></a>df.iloc[:, df.columns.get_loc(<span class="st">&#39;family_members&#39;</span>)]</span></code></pre></div>
<pre class="python_output"><code>region
East South Central      864.0
Pacific                 582.0
Mountain               2606.0
West South Central      432.0
Pacific               20964.0
Mountain               3250.0
Name: family_members, dtype: float64</code></pre>
<p>Select theo danh sách, mặc định đưa vào 1 danh sách <code>Pandas</code> sẽ hiểu là lấy theo các dòng</p>
<div class="sourceCode" id="cb533"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb533-1"><a href="#cb533-1" tabindex="-1"></a>df.iloc[[<span class="dv">1</span>, <span class="dv">3</span> ,<span class="dv">5</span>]]</span></code></pre></div>
<pre class="python_output"><code>                   individuals  family_members  state_pop
region   state                                           
Mountain Colorado       7607.0          3250.0    5691287
Pacific  Alaska         1434.0           582.0     735139
         Hawaii         4131.0          2399.0    1420593</code></pre>

<div class="rmdtip">
<strong><em>Mẹo:</em></strong>
Dòng lệnh trên cũng tương đương với <code>df.iloc[[1, 3 ,5], :]</code>, trong đó <code>:</code> dùng để lấy toàn bộ
</div>
<p>Tương tự để lấy theo danh sách index các cột</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb535-1"><a href="#cb535-1" tabindex="-1"></a>df.iloc[:, [<span class="dv">0</span>, <span class="dv">2</span>]]</span></code></pre></div>
<pre class="python_output"><code>                     individuals  state_pop
region   state                             
Mountain Arizona          7259.0    7158024
         Colorado         7607.0    5691287
         Idaho            1297.0    1750536
Pacific  Alaska           1434.0     735139
         California     109008.0   39461588
         Hawaii           4131.0    1420593</code></pre>
<p>Slice cả 2 chiều</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb537-1"><a href="#cb537-1" tabindex="-1"></a>df.iloc[<span class="dv">2</span>:<span class="dv">4</span>, <span class="dv">0</span>:<span class="dv">2</span>]</span></code></pre></div>
<pre class="python_output"><code>                 individuals  family_members
region   state                              
Mountain Idaho        1297.0           715.0
Pacific  Alaska       1434.0           582.0</code></pre>
<p>Sử dụng danh sách các boolean</p>
<div class="sourceCode" id="cb539"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb539-1"><a href="#cb539-1" tabindex="-1"></a><span class="co"># Theo dòng</span></span>
<span id="cb539-2"><a href="#cb539-2" tabindex="-1"></a>df.iloc[[<span class="va">True</span>, <span class="va">False</span>, <span class="va">True</span>, <span class="va">False</span>, <span class="va">False</span>, <span class="va">True</span>], :]</span></code></pre></div>
<pre class="python_output"><code>                  individuals  family_members  state_pop
region   state                                          
Mountain Arizona       7259.0          2606.0    7158024
         Idaho         1297.0           715.0    1750536
Pacific  Hawaii        4131.0          2399.0    1420593</code></pre>
<div class="sourceCode" id="cb541"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb541-1"><a href="#cb541-1" tabindex="-1"></a>df.iloc[:, [<span class="va">False</span>, <span class="va">True</span>,<span class="va">False</span>]]</span></code></pre></div>
<pre class="python_output"><code>                     family_members
region   state                     
Mountain Arizona             2606.0
         Colorado            3250.0
         Idaho                715.0
Pacific  Alaska               582.0
         California         20964.0
         Hawaii              2399.0</code></pre>
<!--chapter:end:posts/04-SelectingAndFiltering/03-Select_Use_Iloc.Rmd-->
<div id="lọc-theo-điều-kiện-1" class="section level2 hasAnchor" number="10.4">
<h2 class="hasAnchor"><span class="header-section-number">10.4</span> Lọc theo điều kiện<a href="#l%E1%BB%8Dc-theo-%C4%91i%E1%BB%81u-ki%E1%BB%87n-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Các phương thức <code>[]</code>, <code>.loc</code> hay <code>.iloc</code> ngoài việc lấy dữ liệu theo hàng và cột còn có thể lấy ra những bảng con theo các điều kiện cho trước. Bản chất các câu điều kiện sẽ trả về một danh sách dạng bolean và các hàm trên thực hiện lọc theo danh sách đó.</p>
<p>Trước hết ta cần biết câu điều kiện trong Pandas như thế nào. Ví dụ ta có 1 <code>DataFrame</code> như sau</p>
<div class="sourceCode" id="cb543"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb543-1"><a href="#cb543-1" tabindex="-1"></a>               state  individuals  family_members  state_pop</span>
<span id="cb543-2"><a href="#cb543-2" tabindex="-1"></a>region                                                      </span>
<span id="cb543-3"><a href="#cb543-3" tabindex="-1"></a>Mountain     Arizona       <span class="fl">7259.0</span>          <span class="fl">2606.0</span>    <span class="dv">7158024</span></span>
<span id="cb543-4"><a href="#cb543-4" tabindex="-1"></a>Mountain    Colorado       <span class="fl">7607.0</span>          <span class="fl">3250.0</span>    <span class="dv">5691287</span></span>
<span id="cb543-5"><a href="#cb543-5" tabindex="-1"></a>Mountain       Idaho       <span class="fl">1297.0</span>           <span class="fl">715.0</span>    <span class="dv">1750536</span></span>
<span id="cb543-6"><a href="#cb543-6" tabindex="-1"></a>Pacific       Alaska       <span class="fl">1434.0</span>           <span class="fl">582.0</span>     <span class="dv">735139</span></span>
<span id="cb543-7"><a href="#cb543-7" tabindex="-1"></a>Pacific   California     <span class="fl">109008.0</span>         <span class="fl">20964.0</span>   <span class="dv">39461588</span></span>
<span id="cb543-8"><a href="#cb543-8" tabindex="-1"></a>Pacific       Hawaii       <span class="fl">4131.0</span>          <span class="fl">2399.0</span>    <span class="dv">1420593</span></span></code></pre></div>
<div id="toán-tử-điều-kiện-1" class="section level3 hasAnchor" number="10.4.1">
<h3 class="hasAnchor"><span class="header-section-number">10.4.1</span> Toán tử điều kiện<a href="#to%C3%A1n-t%E1%BB%AD-%C4%91i%E1%BB%81u-ki%E1%BB%87n-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Giả sử ta có một điều kiện rằng <code>df['individuals'] &gt; 5000</code>. Kết quả trả về là 1 <code>Series</code></p>
<div class="sourceCode" id="cb544"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb544-1"><a href="#cb544-1" tabindex="-1"></a>df[<span class="st">&#39;individuals&#39;</span>] <span class="op">&gt;</span> <span class="dv">5000</span></span></code></pre></div>
<pre class="python_output"><code>region
Mountain     True
Mountain     True
Mountain    False
Pacific     False
Pacific      True
Pacific     False
Name: individuals, dtype: bool</code></pre>
<p>Để lọc theo điều kiện này ta có các cách như sau</p>
<div class="sourceCode" id="cb546"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb546-1"><a href="#cb546-1" tabindex="-1"></a><span class="co">## Dùng []</span></span>
<span id="cb546-2"><a href="#cb546-2" tabindex="-1"></a>df[df[<span class="st">&#39;individuals&#39;</span>] <span class="op">&gt;</span> <span class="dv">5000</span>]</span></code></pre></div>
<pre class="python_output"><code>               state  individuals  family_members  state_pop
region                                                      
Mountain     Arizona       7259.0          2606.0    7158024
Mountain    Colorado       7607.0          3250.0    5691287
Pacific   California     109008.0         20964.0   39461588</code></pre>
<div class="sourceCode" id="cb548"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb548-1"><a href="#cb548-1" tabindex="-1"></a><span class="co">## Dùng .loc</span></span>
<span id="cb548-2"><a href="#cb548-2" tabindex="-1"></a>df.loc[df[<span class="st">&#39;individuals&#39;</span>] <span class="op">&gt;</span> <span class="dv">5000</span>]</span></code></pre></div>
<pre class="python_output"><code>               state  individuals  family_members  state_pop
region                                                      
Mountain     Arizona       7259.0          2606.0    7158024
Mountain    Colorado       7607.0          3250.0    5691287
Pacific   California     109008.0         20964.0   39461588</code></pre>

<div class="rmdnote">
<p><strong><em>Lưu ý:</em></strong>
<code>.iloc</code> không nhận <code>Series</code> boolean nhưng <code>array</code> thì có thể. Do đó ta có thể dùng <code>.values</code> để lấy kết quả của Câu điều kiện</p>
</div>
<div class="sourceCode" id="cb550"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb550-1"><a href="#cb550-1" tabindex="-1"></a><span class="co">## Dùng .iloc</span></span>
<span id="cb550-2"><a href="#cb550-2" tabindex="-1"></a>df.iloc[(df[<span class="st">&#39;individuals&#39;</span>] <span class="op">&gt;</span> <span class="dv">5000</span>).values]</span></code></pre></div>
<pre class="python_output"><code>               state  individuals  family_members  state_pop
region                                                      
Mountain     Arizona       7259.0          2606.0    7158024
Mountain    Colorado       7607.0          3250.0    5691287
Pacific   California     109008.0         20964.0   39461588</code></pre>
<p>Ta cũng có thể áp nhiều điều kiện cùng lúc, mỗi điều kiện phải nằm trong dấu ngoặc đơn <code>()</code> và giữa các kiều kiện là toán tử <code>&amp;</code> hoặc <code>|</code></p>
<div class="sourceCode" id="cb552"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb552-1"><a href="#cb552-1" tabindex="-1"></a><span class="co">## Nhiều câu điều kiện trên một cột</span></span>
<span id="cb552-2"><a href="#cb552-2" tabindex="-1"></a>df.loc[(df[<span class="st">&#39;individuals&#39;</span>] <span class="op">&gt;</span> <span class="dv">5000</span>) <span class="op">&amp;</span> (df[<span class="st">&#39;individuals&#39;</span>] <span class="op">&lt;</span> <span class="dv">10000</span>)]</span></code></pre></div>
<pre class="python_output"><code>             state  individuals  family_members  state_pop
region                                                    
Mountain   Arizona       7259.0          2606.0    7158024
Mountain  Colorado       7607.0          3250.0    5691287</code></pre>
<div class="sourceCode" id="cb554"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb554-1"><a href="#cb554-1" tabindex="-1"></a><span class="co">## Nhiều câu điều kiện ở nhiều cột</span></span>
<span id="cb554-2"><a href="#cb554-2" tabindex="-1"></a>df.loc[(df[<span class="st">&#39;individuals&#39;</span>] <span class="op">&gt;</span> <span class="dv">5000</span>) <span class="op">&amp;</span> (df[<span class="st">&#39;family_members&#39;</span>] <span class="op">&lt;</span> <span class="dv">10000</span>)]</span></code></pre></div>
<pre class="python_output"><code>             state  individuals  family_members  state_pop
region                                                    
Mountain   Arizona       7259.0          2606.0    7158024
Mountain  Colorado       7607.0          3250.0    5691287</code></pre>
<div class="sourceCode" id="cb556"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb556-1"><a href="#cb556-1" tabindex="-1"></a><span class="co">## Một câu điều kiện trên nhiều cột</span></span>
<span id="cb556-2"><a href="#cb556-2" tabindex="-1"></a>df[df[<span class="st">&#39;individuals&#39;</span>] <span class="op">&gt;</span> <span class="dv">5</span> <span class="op">*</span> df[<span class="st">&#39;family_members&#39;</span>]]</span></code></pre></div>
<pre class="python_output"><code>              state  individuals  family_members  state_pop
region                                                     
Pacific  California     109008.0         20964.0   39461588</code></pre>

<div class="rmdtip">
<strong><em>Mẹo:</em></strong>
Bạn cũng có thể dùng <code>loc</code> để vừa lọc các dòng thỏa điều kiện, vừa chọn các cột muốn lấy
</div>
<div class="sourceCode" id="cb558"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb558-1"><a href="#cb558-1" tabindex="-1"></a>df.loc[df[<span class="st">&#39;individuals&#39;</span>] <span class="op">&gt;</span> <span class="dv">5</span> <span class="op">*</span> df[<span class="st">&#39;family_members&#39;</span>], [<span class="st">&#39;individuals&#39;</span>, <span class="st">&#39;family_members&#39;</span>]]</span></code></pre></div>
<pre class="python_output"><code>         individuals  family_members
region                              
Pacific     109008.0         20964.0</code></pre>
<p>Ngoài ra, <code>pandas</code> còn cho phép bạn lọc với cấu trúc câu truy vấn bằng <code>.query</code> theo cú pháp</p>
<div class="sourceCode" id="cb560"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb560-1"><a href="#cb560-1" tabindex="-1"></a>DataFrame.query(expr, inplace<span class="op">=</span><span class="va">False</span>, <span class="op">**</span>kwargs)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>expr</code>: là câu truy vấn</p></li>
<li><p><code>inplace</code>: thực hiện trên chính <code>DataFrame</code> đó hay tạo 1 bảng sao</p></li>
<li><p><code>**kwargs</code>: keyword arguments</p></li>
</ul>
<p>Theo ví dụ trên, để thực hiện lọc theo điều kiện <code>df['individuals'] &gt; 5000</code> và <code>df['family_members'] &lt; 10000</code> ta có thể làm như sau</p>
<div class="sourceCode" id="cb561"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb561-1"><a href="#cb561-1" tabindex="-1"></a>df.query(<span class="st">&#39;individuals &gt; 500 and family_members &lt; 10000&#39;</span>)</span></code></pre></div>
<pre class="python_output"><code>             state  individuals  family_members  state_pop
region                                                    
Mountain   Arizona       7259.0          2606.0    7158024
Mountain  Colorado       7607.0          3250.0    5691287</code></pre>
</div>
<div id="isin-1" class="section level3 hasAnchor" number="10.4.2">
<h3 class="hasAnchor"><span class="header-section-number">10.4.2</span> <code>.isin()</code><a href="#isin-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Phương thức <code>.isin(values)</code> để kiểm tra các phần tử trong <code>DataFrame</code> hoặc <code>Series</code> có nằm trong values hay không.</p>
<p>Ví dụ:</p>
<div class="sourceCode" id="cb563"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb563-1"><a href="#cb563-1" tabindex="-1"></a>df.isin([<span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Oklahoma&#39;</span>, <span class="st">&#39;Illinois&#39;</span>, <span class="st">&#39;Arizona&#39;</span>, <span class="dv">7259</span>, <span class="dv">582</span>, <span class="dv">300</span>])</span></code></pre></div>
<pre class="python_output"><code>          state  individuals  family_members  state_pop
region                                                 
Mountain   True         True           False      False
Mountain  False        False           False      False
Mountain  False        False           False      False
Pacific    True        False            True      False
Pacific   False        False           False      False
Pacific   False        False           False      False</code></pre>
<div class="sourceCode" id="cb565"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb565-1"><a href="#cb565-1" tabindex="-1"></a>df[<span class="st">&#39;state&#39;</span>].isin([<span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Oklahoma&#39;</span>, <span class="st">&#39;Illinois&#39;</span>, <span class="st">&#39;Arizona&#39;</span>])</span></code></pre></div>
<pre class="python_output"><code>region
Mountain     True
Mountain    False
Mountain    False
Pacific      True
Pacific     False
Pacific     False
Name: state, dtype: bool</code></pre>
<p>Ngoài ra bạn có thể truyền <code>values</code> là một <code>dictionary</code> để kiểm tra cho từng cột theo từng tập giá trị</p>
<div class="sourceCode" id="cb567"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb567-1"><a href="#cb567-1" tabindex="-1"></a>df.isin({<span class="st">&#39;state&#39;</span>: [<span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Oklahoma&#39;</span>, <span class="st">&#39;Illinois&#39;</span>, <span class="st">&#39;Arizona&#39;</span>], </span>
<span id="cb567-2"><a href="#cb567-2" tabindex="-1"></a>         <span class="st">&#39;individuals&#39;</span>: [<span class="dv">7259</span>, <span class="dv">582</span>, <span class="dv">300</span>]})</span></code></pre></div>
<pre class="python_output"><code>          state  individuals  family_members  state_pop
region                                                 
Mountain   True         True           False      False
Mountain  False        False           False      False
Mountain  False        False           False      False
Pacific    True        False           False      False
Pacific   False        False           False      False
Pacific   False        False           False      False</code></pre>
<p>Lọc với <code>.isin()</code></p>
<div class="sourceCode" id="cb569"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb569-1"><a href="#cb569-1" tabindex="-1"></a>df[df[<span class="st">&#39;state&#39;</span>].isin([<span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Oklahoma&#39;</span>, <span class="st">&#39;Illinois&#39;</span>, <span class="st">&#39;Arizona&#39;</span>])]</span></code></pre></div>
<pre class="python_output"><code>            state  individuals  family_members  state_pop
region                                                   
Mountain  Arizona       7259.0          2606.0    7158024
Pacific    Alaska       1434.0           582.0     735139</code></pre>
<p>trong trường hợp sự dụng <code>.isin</code> với <code>DataFrame</code>, kết quả của lọc sẽ trả về một <code>DataFrame</code> với giá trị các phần tử mà phép <code>isin</code> trả về <code>True</code>, các phần tử còn lại trả giá trị <code>NaN</code></p>
<div class="sourceCode" id="cb571"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb571-1"><a href="#cb571-1" tabindex="-1"></a>df[df.isin([<span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Oklahoma&#39;</span>, <span class="st">&#39;Illinois&#39;</span>, <span class="st">&#39;Arizona&#39;</span>, <span class="dv">7259</span>, <span class="dv">582</span>, <span class="dv">300</span>])]</span></code></pre></div>
<pre class="python_outputs"><code>            state  individuals  family_members  state_pop
region                                                   
Mountain  Arizona       7259.0             NaN        NaN
Mountain      NaN          NaN             NaN        NaN
Mountain      NaN          NaN             NaN        NaN
Pacific    Alaska          NaN           582.0        NaN
Pacific       NaN          NaN             NaN        NaN
Pacific       NaN          NaN             NaN        NaN</code></pre>

<div class="rmdtip">
<p><strong><em>Mẹo:</em></strong></p>
<ul>
<li><p>Bạn có dùng <code>.any()</code> để tổng hợp điều kiện của 1 DataFrame với các phần tử <code>boolean</code></p></li>
<li><p><code>.any(axis=1)</code> : Chỉ cần tồn tại 1 cột giá trị True, trả về giá trị True cho dòng</p></li>
<li><p><code>.any(axis=0)</code>: Chỉ cần tồn tại 1 dòng có giá trị True, trả về giá trị True cho cột.</p></li>
<li><p>Phương thức <code>.any()</code> thường dùng để kiểm tra các dòng tồn tại 1 cột giá trị <code>NaN</code></p>
</div></li>
</ul>
<p>Lọc với <code>.isin()</code> và <code>any(axis=1)</code></p>
<div class="sourceCode" id="cb573"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb573-1"><a href="#cb573-1" tabindex="-1"></a>df.isin([<span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Oklahoma&#39;</span>, <span class="st">&#39;Illinois&#39;</span>, <span class="st">&#39;Arizona&#39;</span>, <span class="dv">7259</span>, <span class="dv">582</span>, <span class="dv">300</span>]).<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<pre class="python_output"><code>region
Mountain     True
Mountain    False
Mountain    False
Pacific      True
Pacific     False
Pacific     False
dtype: bool</code></pre>
<div class="sourceCode" id="cb575"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb575-1"><a href="#cb575-1" tabindex="-1"></a>df[df.isin([<span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Oklahoma&#39;</span>, <span class="st">&#39;Illinois&#39;</span>, <span class="st">&#39;Arizona&#39;</span>, <span class="dv">7259</span>, <span class="dv">582</span>, <span class="dv">300</span>]).<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>)]</span></code></pre></div>
<pre class="python_output"><code>            state  individuals  family_members  state_pop
region                                                   
Mountain  Arizona       7259.0          2606.0    7158024
Pacific    Alaska       1434.0           582.0     735139</code></pre>
<p>Lọc với <code>isin()</code> và <code>any(axis=0)</code></p>
<div class="sourceCode" id="cb577"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb577-1"><a href="#cb577-1" tabindex="-1"></a>df.isin([<span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Oklahoma&#39;</span>, <span class="st">&#39;Illinois&#39;</span>, <span class="st">&#39;Arizona&#39;</span>, <span class="dv">7259</span>, <span class="dv">582</span>, <span class="dv">300</span>]).<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">0</span>)</span></code></pre></div>
<pre class="python_output"><code>state              True
individuals        True
family_members     True
state_pop         False
dtype: bool</code></pre>
<div class="sourceCode" id="cb579"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb579-1"><a href="#cb579-1" tabindex="-1"></a>df.loc[:,df.isin([<span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Oklahoma&#39;</span>, <span class="st">&#39;Illinois&#39;</span>, <span class="st">&#39;Arizona&#39;</span>, <span class="dv">7259</span>, <span class="dv">582</span>, <span class="dv">300</span>]).<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">0</span>)]</span></code></pre></div>
<pre class="python_output"><code>               state  individuals  family_members
region                                           
Mountain     Arizona       7259.0          2606.0
Mountain    Colorado       7607.0          3250.0
Mountain       Idaho       1297.0           715.0
Pacific       Alaska       1434.0           582.0
Pacific   California     109008.0         20964.0
Pacific       Hawaii       4131.0          2399.0</code></pre>
<p>Lọc với <code>isin()</code> và <code>any(axis=0)</code> và <code>any(axis=1)</code></p>
<div class="sourceCode" id="cb581"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb581-1"><a href="#cb581-1" tabindex="-1"></a>bool_df <span class="op">=</span> df.isin([<span class="st">&#39;Alaska&#39;</span>, <span class="st">&#39;Oklahoma&#39;</span>, <span class="st">&#39;Illinois&#39;</span>, <span class="st">&#39;Arizona&#39;</span>, <span class="dv">7259</span>, <span class="dv">582</span>, <span class="dv">300</span>])</span>
<span id="cb581-2"><a href="#cb581-2" tabindex="-1"></a>df.loc[bool_df.<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">1</span>), bool_df.<span class="bu">any</span>(axis<span class="op">=</span><span class="dv">0</span>)]</span></code></pre></div>
<pre class="python_output"><code>            state  individuals  family_members
region                                        
Mountain  Arizona       7259.0          2606.0
Pacific    Alaska       1434.0           582.0</code></pre>
<div id="lọc-missing-value-với-.dropna-1" class="section level3 hasAnchor" number="10.4.3">
<h3 class="hasAnchor"><span class="header-section-number">10.4.3</span> Lọc missing value với <code>.dropna()</code><a href="#l%E1%BB%8Dc-missing-value-v%E1%BB%9Bi-.dropna-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Trong quá trình xử lý dữ liệu, chúng ta thường gặp những bảng có chứa giá trị missing value. Ví dụ bảng <code>missing_df</code></p>
<div class="sourceCode" id="cb583"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb583-1"><a href="#cb583-1" tabindex="-1"></a>               state  individuals  family_members   state_pop</span>
<span id="cb583-2"><a href="#cb583-2" tabindex="-1"></a>region                                                       </span>
<span id="cb583-3"><a href="#cb583-3" tabindex="-1"></a>Mountain     Arizona       <span class="fl">7259.0</span>             NaN         NaN</span>
<span id="cb583-4"><a href="#cb583-4" tabindex="-1"></a>Mountain    Colorado          NaN          <span class="fl">3250.0</span>   <span class="fl">5691287.0</span></span>
<span id="cb583-5"><a href="#cb583-5" tabindex="-1"></a>Mountain       Idaho       <span class="fl">1297.0</span>           <span class="fl">715.0</span>   <span class="fl">1750536.0</span></span>
<span id="cb583-6"><a href="#cb583-6" tabindex="-1"></a>Pacific       Alaska       <span class="fl">1434.0</span>             NaN    <span class="fl">735139.0</span></span>
<span id="cb583-7"><a href="#cb583-7" tabindex="-1"></a>Pacific   California     <span class="fl">109008.0</span>         <span class="fl">20964.0</span>  <span class="fl">39461588.0</span></span>
<span id="cb583-8"><a href="#cb583-8" tabindex="-1"></a>Pacific       Hawaii       <span class="fl">4131.0</span>          <span class="fl">2399.0</span>         NaN</span></code></pre></div>
<p>Để lọc dữ liệu chứa <code>NaN</code> ta dùng phương thức <code>.dropna()</code></p>
<div class="sourceCode" id="cb584"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb584-1"><a href="#cb584-1" tabindex="-1"></a>DataFrame.dropna(axis<span class="op">=</span><span class="dv">0</span>, how<span class="op">=</span><span class="st">&#39;any&#39;</span>, thresh<span class="op">=</span><span class="va">None</span>, subset<span class="op">=</span><span class="va">None</span>, inplace<span class="op">=</span><span class="va">False</span>)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>axis</code>: Nhận diện lọc theo dòng <code>0</code>, <code>index</code>, hay cột <code>1</code>, <code>column</code></p></li>
<li><p><code>how</code>: Chỉ định cách lọc</p>
<ul>
<li><code>any</code>: Nếu có bất kì <code>NA</code>, loại bỏ dòng hoặc cột</li>
<li><code>all</code>: Nếu tất cả là <code>NA</code>, loại bỏ dòng hoặc cột</li>
</ul></li>
<li><p><code>thresh</code>: Số lượng <code>non-NA</code> yêu cầu</p></li>
<li><p><code>subset</code>: Chỉ định các cột cần lọc</p></li>
<li><p><code>inplace</code>: Thực hiện trên chính <code>DataFrame</code> hay tạo bản sao.</p></li>
</ul>
<p>Lọc bỏ các hàng nếu ít nhất một phần tử <code>NA</code></p>
<div class="sourceCode" id="cb585"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb585-1"><a href="#cb585-1" tabindex="-1"></a>missing_df.dropna(axis<span class="op">=</span><span class="dv">0</span>)</span></code></pre></div>
<pre class="python_output"><code>               state  individuals  family_members   state_pop
region                                                       
Mountain       Idaho       1297.0           715.0   1750536.0
Pacific   California     109008.0         20964.0  39461588.0</code></pre>
<p>Lọc bỏ các cột nếu ít nhất một phần tử <code>NA</code></p>
<div class="sourceCode" id="cb587"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb587-1"><a href="#cb587-1" tabindex="-1"></a>missing_df.dropna(axis<span class="op">=</span><span class="st">&#39;columns&#39;</span>)</span></code></pre></div>
<pre class="python_output"><code>               state
region              
Mountain     Arizona
Mountain    Colorado
Mountain       Idaho
Pacific       Alaska
Pacific   California
Pacific       Hawaii</code></pre>
<p>Lọc bỏ các dòng nếu tất cả phần tử trong các cột <code>['family_members', 'state_pop']</code> là <code>NA</code></p>
<div class="sourceCode" id="cb589"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb589-1"><a href="#cb589-1" tabindex="-1"></a>missing_df.dropna(axis<span class="op">=</span><span class="st">&#39;index&#39;</span>, how<span class="op">=</span><span class="st">&#39;all&#39;</span>, subset<span class="op">=</span>[<span class="st">&#39;family_members&#39;</span>, <span class="st">&#39;state_pop&#39;</span>])</span></code></pre></div>
<pre class="python_output"><code>               state  individuals  family_members   state_pop
region                                                       
Mountain    Colorado          NaN          3250.0   5691287.0
Mountain       Idaho       1297.0           715.0   1750536.0
Pacific       Alaska       1434.0             NaN    735139.0
Pacific   California     109008.0         20964.0  39461588.0
Pacific       Hawaii       4131.0          2399.0         NaN</code></pre>
<p>Giữ lại các dòng có ít nhất <code>3</code> phần tử <code>non-NA</code></p>
<div class="sourceCode" id="cb591"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb591-1"><a href="#cb591-1" tabindex="-1"></a>missing_df.dropna(thresh<span class="op">=</span><span class="dv">3</span>)</span></code></pre></div>
<pre class="python_output"><code>               state  individuals  family_members   state_pop
region                                                       
Mountain    Colorado          NaN          3250.0   5691287.0
Mountain       Idaho       1297.0           715.0   1750536.0
Pacific       Alaska       1434.0             NaN    735139.0
Pacific   California     109008.0         20964.0  39461588.0
Pacific       Hawaii       4131.0          2399.0         NaN</code></pre>
<!--chapter:end:posts/04-SelectingAndFiltering/04-Filtering.Rmd-->
</div>
<div id="tính-toán-trên-các-phần-tử-trong-pandas" class="section level1 hasAnchor" number="11">
<h1 class="hasAnchor"><span class="header-section-number">11</span> Tính toán trên các phần tử trong Pandas<a href="#t%C3%ADnh-to%C3%A1n-tr%C3%AAn-c%C3%A1c-ph%E1%BA%A7n-t%E1%BB%AD-trong-pandas" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb593"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb593-1"><a href="#cb593-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;data/big_mart_sales.csv&#39;</span>)</span></code></pre></div>
<div id="sử-dụng-vectorization" class="section level2 hasAnchor" number="11.1">
<h2 class="hasAnchor"><span class="header-section-number">11.1</span> Sử dụng Vectorization<a href="#s%E1%BB%AD-d%E1%BB%A5ng-vectorization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Giả sử như muốn tạo cột <code>price</code>= <code>Item_Outlet_Sales</code> * <code>5%</code></p>
<div class="sourceCode" id="cb594"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb594-1"><a href="#cb594-1" tabindex="-1"></a>df[<span class="st">&#39;price&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Item_Outlet_Sales&#39;</span>] <span class="op">*</span> <span class="fl">0.05</span></span>
<span id="cb594-2"><a href="#cb594-2" tabindex="-1"></a>df[[<span class="st">&#39;Item_Outlet_Sales&#39;</span>, <span class="st">&#39;price&#39;</span>]]</span></code></pre></div>
<pre class="python_output"><code>      Item_Outlet_Sales      price
0             3735.1380  186.75690
1              443.4228   22.17114
2             2097.2700  104.86350
3              732.3800   36.61900
4              994.7052   49.73526
...                 ...        ...
8518          2778.3834  138.91917
8519           549.2850   27.46425
8520          1193.1136   59.65568
8521          1845.5976   92.27988
8522           765.6700   38.28350</code></pre>
<p>Nối hai cột lại với nhau, Ví dụ</p>
<ul>
<li><p>nối <code>Item_type</code> và <code>Item_Fat_Content</code> thành <code>Item_Type_Fat_Content</code></p></li>
<li><p>nối <code>Outlet_Identifier</code> và <code>Outlet_Establishment_Year</code> thành <code>Outlet_Identifier_Establishment_Year</code>. Trong trường hợp hợp này <code>Outlet_Establishment_Year</code> thuộc dạng số nên để nối dạng text và số ta ép kiểu dạng số về text sử dụng <code>astype()</code></p></li>
</ul>
<div class="sourceCode" id="cb596"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb596-1"><a href="#cb596-1" tabindex="-1"></a>df[<span class="st">&#39;Item_Type_Fat_Content&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Item_Type&#39;</span>] <span class="op">+</span> <span class="st">&#39;_&#39;</span> <span class="op">+</span> df[<span class="st">&#39;Item_Fat_Content&#39;</span>]</span>
<span id="cb596-2"><a href="#cb596-2" tabindex="-1"></a>df[<span class="st">&#39;Outlet_Identifier_Establishment_Year&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Outlet_Identifier&#39;</span>] <span class="op">+</span> <span class="st">&#39;_&#39;</span> <span class="op">+</span>df[<span class="st">&#39;Outlet_Establishment_Year&#39;</span>].astype(<span class="st">&#39;str&#39;</span>)</span>
<span id="cb596-3"><a href="#cb596-3" tabindex="-1"></a>df[[<span class="st">&#39;Item_Type_Fat_Content&#39;</span>, <span class="st">&#39;Outlet_Identifier_Establishment_Year&#39;</span>]]</span></code></pre></div>
<pre class="python_output"><code>              Item_Type_Fat_Content Outlet_Identifier_Establishment_Year
0                     Dairy_Low Fat                          OUT049_1999
1               Soft Drinks_Regular                          OUT018_2009
2                      Meat_Low Fat                          OUT049_1999
3     Fruits and Vegetables_Regular                          OUT010_1998
4                 Household_Low Fat                          OUT013_1987
...                             ...                                  ...
8518            Snack Foods_Low Fat                          OUT013_1987
8519           Baking Goods_Regular                          OUT045_2002
8520     Health and Hygiene_Low Fat                          OUT035_2004
8521            Snack Foods_Regular                          OUT018_2009
8522            Soft Drinks_Low Fat                          OUT046_1997</code></pre>
</div>
<div id="sử-dụng-apply" class="section level2 hasAnchor" number="11.2">
<h2 class="hasAnchor"><span class="header-section-number">11.2</span> Sử dụng apply<a href="#s%E1%BB%AD-d%E1%BB%A5ng-apply" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>apply</code> để thực thi một hàm theo dòng hoặc cột</p>
<p><strong>Đối với Series</strong></p>
<div class="sourceCode" id="cb598"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb598-1"><a href="#cb598-1" tabindex="-1"></a>Series.<span class="bu">apply</span>(func, convert_dtype<span class="op">=</span><span class="va">True</span>, args<span class="op">=</span>(), <span class="op">**</span>kwargs)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>func</code>: là hàm cần thực thi</p></li>
<li><p><code>convert_dtype</code>: Giá trị kiểu boolean. Nếu nó được đặt thành True (mặc định), xử lý dữ liệu sẽ cố gắng tìm dtype tốt hơn cho các kết quả của hàm <code>func</code>. Nếu <code>False</code>, thì dtype sẽ là type(object)</p></li>
<li><p><code>args</code>: Các đối số của hàm</p></li>
</ul>
<p>Ví dụ, thao tác <code>Item_Outlet_Sales</code> * <code>5%</code></p>
<p>Sử dụng lambda function</p>
<div class="sourceCode" id="cb599"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb599-1"><a href="#cb599-1" tabindex="-1"></a>df[<span class="st">&#39;Item_Outlet_Sales&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x <span class="op">*</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre class="python_output"><code>0       186.75690
1        22.17114
2       104.86350
3        36.61900
4        49.73526
          ...    
8518    138.91917
8519     27.46425
8520     59.65568
8521     92.27988
8522     38.28350
Name: Item_Outlet_Sales, Length: 8523, dtype: float64</code></pre>
<p>Sử dụng hàm tự định nghĩa</p>
<div class="sourceCode" id="cb601"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb601-1"><a href="#cb601-1" tabindex="-1"></a><span class="kw">def</span> set_price(x, k<span class="op">=</span><span class="fl">0.05</span>):</span>
<span id="cb601-2"><a href="#cb601-2" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">*</span> k</span></code></pre></div>
<div class="sourceCode" id="cb602"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb602-1"><a href="#cb602-1" tabindex="-1"></a>df[<span class="st">&#39;Item_Outlet_Sales&#39;</span>].<span class="bu">apply</span>(set_price)</span></code></pre></div>
<pre class="python_output"><code>0       186.75690
1        22.17114
2       104.86350
3        36.61900
4        49.73526
          ...    
8518    138.91917
8519     27.46425
8520     59.65568
8521     92.27988
8522     38.28350
Name: Item_Outlet_Sales, Length: 8523, dtype: float64</code></pre>
<p>Có thể truyền tham số <code>k</code> vào hàm <code>set_price</code> bằng hai cách</p>
<div class="sourceCode" id="cb604"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb604-1"><a href="#cb604-1" tabindex="-1"></a><span class="co"># Cách 1 - Dùng lambda</span></span>
<span id="cb604-2"><a href="#cb604-2" tabindex="-1"></a>df[<span class="st">&#39;Item_Outlet_Sales&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: set_price(x, <span class="fl">0.1</span>))</span>
<span id="cb604-3"><a href="#cb604-3" tabindex="-1"></a></span>
<span id="cb604-4"><a href="#cb604-4" tabindex="-1"></a><span class="co"># Cách 2 - Dùng `arg`</span></span>
<span id="cb604-5"><a href="#cb604-5" tabindex="-1"></a>df[<span class="st">&#39;Item_Outlet_Sales&#39;</span>].<span class="bu">apply</span>(set_price, k<span class="op">=</span><span class="fl">0.1</span>)</span></code></pre></div>
<p><strong>Đối với <code>DataFrame</code></strong></p>
<p>Ta dùng cú pháp</p>
<div class="sourceCode" id="cb605"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb605-1"><a href="#cb605-1" tabindex="-1"></a>DataFrame.<span class="bu">apply</span>(func, axis<span class="op">=</span><span class="dv">0</span>, raw<span class="op">=</span><span class="va">False</span>, result_type<span class="op">=</span><span class="va">None</span>, args<span class="op">=</span>(), <span class="op">**</span>kwargs)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>func</code>: là hàm cần thực thi</p></li>
<li><p><code>axis</code>: thực thi theo dòng <code>0</code> hoặc cột <code>1</code></p></li>
<li><p><code>raw</code>: Xác định xem dòng hoặc cột có thể chuyển về <code>Series</code> hoặc <code>ndarray</code></p></li>
<li><p><code>result_type</code>: Chỉ áp dụng cho <code>axis=1</code></p></li>
<li><p><code>args</code>: Các đối số của hàm</p></li>
</ul>
<p>Ví dụ:</p>
<div class="sourceCode" id="cb606"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb606-1"><a href="#cb606-1" tabindex="-1"></a>sample_df <span class="op">=</span> sample_df <span class="op">=</span> pd.DataFrame([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="st">&#39;A&#39;</span>], [<span class="dv">3</span>, <span class="dv">6</span>, <span class="st">&#39;B&#39;</span>], [<span class="dv">5</span>, <span class="dv">10</span>, <span class="st">&#39;C&#39;</span>]], columns<span class="op">=</span>[<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>, <span class="st">&#39;C&#39;</span>])</span>
<span id="cb606-2"><a href="#cb606-2" tabindex="-1"></a>sample_df</span></code></pre></div>
<pre class="python_output"><code>   A   B  C
0  1   2  A
1  3   6  B
2  5  10  C</code></pre>
<p>Áp dụng trên toàn <code>DataFrame</code></p>
<div class="sourceCode" id="cb608"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb608-1"><a href="#cb608-1" tabindex="-1"></a>sample_df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x <span class="op">*</span> <span class="dv">2</span>)</span></code></pre></div>
<pre class="python_output"><code>     A   B   C
0    2   4  AA
1    6  12  BB
2   10  20  CC</code></pre>

<div class="rmdnote">
<p><strong><em>Lưu ý:</em></strong></p>
<p>Khi áp dụng cho toàn <code>DataFrame</code> hãy cẩn thận hàm <code>func</code> truyền vào, nếu <code>func</code> không áp dụng được cho toàn bộ các phần tử sẽ báo lỗi.</p>
Ví dụ ở trên với x * 2 vẫn áp dụng được cho cột <code>C</code> dạng <code>str</code>, nhưng khi thay bằng x ** 2 sẽ báo lỗi vì toán tử <code>**</code> không áp dụng cho <code>str</code>
</div>
<p>Áp dụng trên một số cột trong <code>DataFrame</code></p>
<div class="sourceCode" id="cb610"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb610-1"><a href="#cb610-1" tabindex="-1"></a><span class="co">## Theo cột</span></span>
<span id="cb610-2"><a href="#cb610-2" tabindex="-1"></a>sample_df[[<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>]].<span class="bu">apply</span>(np.<span class="bu">sum</span>, axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<pre class="python_output"><code>0    13
1    13
2    13
dtype: int64</code></pre>
<div class="sourceCode" id="cb612"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb612-1"><a href="#cb612-1" tabindex="-1"></a><span class="co">## Theo dòng</span></span>
<span id="cb612-2"><a href="#cb612-2" tabindex="-1"></a>df[[<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>]].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.<span class="bu">sum</span>(x), axis<span class="op">=</span><span class="dv">0</span>)</span></code></pre></div>
<pre class="python_output"><code>A    12
B    27
dtype: int64</code></pre>
<p>Một cách khác áp dụng trên một số cột trong <code>DataFrame</code></p>
<p>Sử dụng lambda</p>
<div class="sourceCode" id="cb614"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb614-1"><a href="#cb614-1" tabindex="-1"></a>sample_df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="st">&#39;A&#39;</span>] <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> x[<span class="st">&#39;B&#39;</span>], axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<pre class="python_output"><code>0     5
1    15
2    25
dtype: int64</code></pre>
<p>Dùng hàm định nghĩa</p>
<div class="sourceCode" id="cb616"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb616-1"><a href="#cb616-1" tabindex="-1"></a><span class="kw">def</span> dsum(row):</span>
<span id="cb616-2"><a href="#cb616-2" tabindex="-1"></a>    <span class="cf">return</span> row[<span class="st">&#39;A&#39;</span>] <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> row[<span class="st">&#39;B&#39;</span>]</span></code></pre></div>
<div class="sourceCode" id="cb617"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb617-1"><a href="#cb617-1" tabindex="-1"></a>sample_df.<span class="bu">apply</span>(dsum, axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<pre class="python_output"><code>0     5
1    15
2    25
dtype: int64</code></pre>

<div class="rmdtip">
<p><strong><em>Mẹo:</em></strong></p>
<ul>
<li><p>Không nhất thiết giá trị trả về của hàm là giá trị đơn, giá trị trả về có thể dưới dạng list, tuple hoặc dict</p></li>
<li><p>Dùng <code>result_type</code> để thay đổi cách trả về</p>
</div></li>
</ul>
<p>Ví dụ ta có 1 hàm trả về nhiều giá trị cùng lúc như sau</p>
<div class="sourceCode" id="cb619"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb619-1"><a href="#cb619-1" tabindex="-1"></a><span class="kw">def</span> dsum_2(row):</span>
<span id="cb619-2"><a href="#cb619-2" tabindex="-1"></a>    <span class="cf">return</span> [row[<span class="st">&#39;A&#39;</span>] <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> row[<span class="st">&#39;B&#39;</span>],  row[<span class="st">&#39;A&#39;</span>] <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> row[<span class="st">&#39;B&#39;</span>]]</span></code></pre></div>
<div class="sourceCode" id="cb620"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb620-1"><a href="#cb620-1" tabindex="-1"></a><span class="co">## Khi không sử dụng `result_type`</span></span>
<span id="cb620-2"><a href="#cb620-2" tabindex="-1"></a>sample_df.<span class="bu">apply</span>(dsum_2, axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<pre class="python_output"><code>0      [5, -3]
1     [15, -9]
2    [25, -15]
dtype: object</code></pre>
<p>Kết quả trả về của phương pháp trên là <code>Series</code> với các giá trị của nó là dạng list. Để chuyển <code>Series</code> này thành <code>DataFrame</code> với các cột chứa các giá trị của list theo thứ tự, ta dùng <code>result_type='expand'</code></p>
<div class="sourceCode" id="cb622"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb622-1"><a href="#cb622-1" tabindex="-1"></a>sample_df.<span class="bu">apply</span>(dsum_2, axis<span class="op">=</span><span class="dv">1</span>, result_type<span class="op">=</span><span class="st">&#39;expand&#39;</span>)</span></code></pre></div>
<pre class="python_output"><code>    0   1
0   5  -3
1  15  -9
2  25 -15</code></pre>

<div class="rmdtip">
<strong><em>Mẹo:</em></strong> Có thể cấu trúc trả về dưới dạng <code>DataFrame</code> cho ví dụ trên mà không cần dùng <code>result_type</code> bằng cách sử dụng <code>pd.Series</code> của một <code>dictionary</code>. Lúc này các cột của <code>DataFrame</code> sẽ được đánh nhãn theo key của <code>dictionary</code>
</div>
<div class="sourceCode" id="cb624"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb624-1"><a href="#cb624-1" tabindex="-1"></a><span class="kw">def</span> dsum_3(row):</span>
<span id="cb624-2"><a href="#cb624-2" tabindex="-1"></a>    <span class="cf">return</span> pd.Series({<span class="st">&#39;X&#39;</span>: row[<span class="st">&#39;A&#39;</span>] <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> row[<span class="st">&#39;B&#39;</span>],  <span class="st">&#39;Y&#39;</span>:row[<span class="st">&#39;A&#39;</span>] <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> row[<span class="st">&#39;B&#39;</span>]})</span></code></pre></div>
<div class="sourceCode" id="cb625"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb625-1"><a href="#cb625-1" tabindex="-1"></a>sample_df.<span class="bu">apply</span>(dsum_3, axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<pre class="python_output"><code>    X   Y
0   5   -3
1   15  -9
2   25  -15</code></pre>
<div id="sử-dụng-iterator" class="section level2 hasAnchor" number="11.3">
<h2 class="hasAnchor"><span class="header-section-number">11.3</span> Sử dụng iterator<a href="#s%E1%BB%AD-d%E1%BB%A5ng-iterator" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb627"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb627-1"><a href="#cb627-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;data/big_mart_sales.csv&#39;</span>, usecols<span class="op">=</span>[<span class="st">&#39;Item_Identifier&#39;</span>, <span class="st">&#39;Item_Fat_Content&#39;</span>, <span class="st">&#39;Item_Type&#39;</span>, <span class="st">&#39;Outlet_Size&#39;</span>, <span class="st">&#39;Item_Outlet_Sales&#39;</span>, <span class="st">&#39;Outlet_Establishment_Year&#39;</span>])</span></code></pre></div>
<div id="iterrows" class="section level3 hasAnchor" number="11.3.1">
<h3 class="hasAnchor"><span class="header-section-number">11.3.1</span> Iterrows<a href="#iterrows" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb628"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb628-1"><a href="#cb628-1" tabindex="-1"></a>DataFrame.iterrows()</span></code></pre></div>
<div class="sourceCode" id="cb629"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb629-1"><a href="#cb629-1" tabindex="-1"></a>row <span class="op">=</span> <span class="bu">next</span>(df.iterrows())</span>
<span id="cb629-2"><a href="#cb629-2" tabindex="-1"></a>row</span></code></pre></div>
<pre class="python_output"><code>(0,
 Item_Identifier                 FDA15
 Item_Fat_Content              Low Fat
 Item_Type                       Dairy
 Outlet_Establishment_Year        1999
 Outlet_Size                    Medium
 Item_Outlet_Sales            3735.138
 Name: 0, dtype: object)</code></pre>
<p>Kết quả trả về cho row là 1 tuple gồm index và Series chứa các giá trị tại index đó.</p>
<p><strong>Cách dùng vòng lặp trong iterrows</strong></p>
<p>Để duyệt từng dòng ta dùng <code>for</code> như bình thường</p>
<div class="sourceCode" id="cb631"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb631-1"><a href="#cb631-1" tabindex="-1"></a>prices <span class="op">=</span> []</span>
<span id="cb631-2"><a href="#cb631-2" tabindex="-1"></a><span class="cf">for</span> i, row <span class="kw">in</span> df.iterrows():</span>
<span id="cb631-3"><a href="#cb631-3" tabindex="-1"></a>    prices.append(row[<span class="st">&#39;Item_Outlet_Sales&#39;</span>] <span class="op">*</span> <span class="fl">0.5</span>)</span>
<span id="cb631-4"><a href="#cb631-4" tabindex="-1"></a><span class="bu">print</span>(prices[:<span class="dv">5</span>])</span></code></pre></div>
<pre class="python_output"><code>[1867.569, 221.7114, 1048.635, 366.19, 497.3526]</code></pre>
</div>
<div id="itertuple" class="section level3 hasAnchor" number="11.3.2">
<h3 class="hasAnchor"><span class="header-section-number">11.3.2</span> Itertuple<a href="#itertuple" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb633"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb633-1"><a href="#cb633-1" tabindex="-1"></a>DataFrame.itertuples(index<span class="op">=</span><span class="va">True</span>, name<span class="op">=</span><span class="st">&#39;Pandas&#39;</span>)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>index</code>: <code>True</code> trả về kết quả kèm theo index và <code>False</code> lược bỏ index</p></li>
<li><p><code>name</code>: Quy định kiểu trả về</p>
<ul>
<li><code>Pandas</code>: trả về namedtuple</li>
<li><code>None</code>: trả về tuple</li>
<li><code>namedtuple</code>: trả về namedtuple</li>
</ul></li>
</ul>
<p>Trả về <code>namedtuple</code></p>
<div class="sourceCode" id="cb634"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb634-1"><a href="#cb634-1" tabindex="-1"></a><span class="bu">next</span>(df.itertuples(index<span class="op">=</span><span class="va">True</span>))</span></code></pre></div>
<pre class="python_output"><code>Pandas(Index=0, Item_Identifier=&#39;FDA15&#39;, Item_Fat_Content=&#39;Low Fat&#39;, Item_Type=&#39;Dairy&#39;, Outlet_Establishment_Year=1999, Outlet_Size=&#39;Medium&#39;, Item_Outlet_Sales=3735.138)</code></pre>
<p>Trả về <code>tuple</code></p>
<div class="sourceCode" id="cb636"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb636-1"><a href="#cb636-1" tabindex="-1"></a><span class="bu">next</span>(df.itertuples(index<span class="op">=</span><span class="va">False</span>, name<span class="op">=</span><span class="va">None</span>))</span></code></pre></div>
<pre class="python_output"><code>(&#39;FDA15&#39;, &#39;Low Fat&#39;, &#39;Dairy&#39;, 1999, &#39;Medium&#39;, 3735.138)</code></pre>
<p><strong>Cách dùng vòng lặp trong itertuples</strong></p>
<p><code>name=default</code></p>
<div class="sourceCode" id="cb638"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb638-1"><a href="#cb638-1" tabindex="-1"></a>prices <span class="op">=</span> []</span>
<span id="cb638-2"><a href="#cb638-2" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> df.itertuples():</span>
<span id="cb638-3"><a href="#cb638-3" tabindex="-1"></a>    prices.append(row.Item_Outlet_Sales <span class="op">*</span> <span class="fl">0.5</span>)</span>
<span id="cb638-4"><a href="#cb638-4" tabindex="-1"></a><span class="bu">print</span>(prices[:<span class="dv">5</span>])</span></code></pre></div>
<p><code>name=None</code></p>
<div class="sourceCode" id="cb639"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb639-1"><a href="#cb639-1" tabindex="-1"></a>prices <span class="op">=</span> []</span>
<span id="cb639-2"><a href="#cb639-2" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> df.itertuples(index<span class="op">=</span><span class="va">False</span>, name<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb639-3"><a href="#cb639-3" tabindex="-1"></a>    prices.append(row[<span class="dv">5</span>] <span class="op">*</span> <span class="fl">0.5</span>)</span>
<span id="cb639-4"><a href="#cb639-4" tabindex="-1"></a><span class="bu">print</span>(prices[:<span class="dv">5</span>])</span></code></pre></div>
</div>
</div>
<div id="so-sánh-các-phương-pháp-lặp" class="section level2 hasAnchor" number="11.4">
<h2 class="hasAnchor"><span class="header-section-number">11.4</span> So sánh các phương pháp lặp<a href="#so-s%C3%A1nh-c%C3%A1c-ph%C6%B0%C6%A1ng-ph%C3%A1p-l%E1%BA%B7p" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb640"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb640-1"><a href="#cb640-1" tabindex="-1"></a></span>
<span id="cb640-2"><a href="#cb640-2" tabindex="-1"></a><span class="kw">def</span> vectorizer(df):</span>
<span id="cb640-3"><a href="#cb640-3" tabindex="-1"></a>    prices <span class="op">=</span> df[<span class="st">&#39;Item_Outlet_Sales&#39;</span>] <span class="op">*</span> <span class="fl">0.5</span></span>
<span id="cb640-4"><a href="#cb640-4" tabindex="-1"></a></span>
<span id="cb640-5"><a href="#cb640-5" tabindex="-1"></a><span class="kw">def</span> applyer(df):</span>
<span id="cb640-6"><a href="#cb640-6" tabindex="-1"></a>    prices <span class="op">=</span> df[<span class="st">&#39;Item_Outlet_Sales&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x <span class="op">*</span> <span class="fl">0.5</span>)</span>
<span id="cb640-7"><a href="#cb640-7" tabindex="-1"></a></span>
<span id="cb640-8"><a href="#cb640-8" tabindex="-1"></a><span class="kw">def</span> iterrows(df):</span>
<span id="cb640-9"><a href="#cb640-9" tabindex="-1"></a>    prices <span class="op">=</span> []</span>
<span id="cb640-10"><a href="#cb640-10" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> df.iterrows():</span>
<span id="cb640-11"><a href="#cb640-11" tabindex="-1"></a>        prices.append(row[<span class="st">&#39;Item_Outlet_Sales&#39;</span>] <span class="op">*</span> <span class="fl">0.5</span>)</span>
<span id="cb640-12"><a href="#cb640-12" tabindex="-1"></a></span>
<span id="cb640-13"><a href="#cb640-13" tabindex="-1"></a><span class="kw">def</span> itertuples1(df):</span>
<span id="cb640-14"><a href="#cb640-14" tabindex="-1"></a>    prices <span class="op">=</span> []</span>
<span id="cb640-15"><a href="#cb640-15" tabindex="-1"></a>    <span class="cf">for</span> row <span class="kw">in</span> df.itertuples():</span>
<span id="cb640-16"><a href="#cb640-16" tabindex="-1"></a>        prices.append(row.Item_Outlet_Sales <span class="op">*</span> <span class="fl">0.5</span>)</span>
<span id="cb640-17"><a href="#cb640-17" tabindex="-1"></a></span>
<span id="cb640-18"><a href="#cb640-18" tabindex="-1"></a><span class="kw">def</span> itertuples2(df):</span>
<span id="cb640-19"><a href="#cb640-19" tabindex="-1"></a>    prices <span class="op">=</span> []</span>
<span id="cb640-20"><a href="#cb640-20" tabindex="-1"></a>    <span class="cf">for</span> row <span class="kw">in</span> df.itertuples(index<span class="op">=</span><span class="va">False</span>, name<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb640-21"><a href="#cb640-21" tabindex="-1"></a>        prices.append(row[<span class="dv">5</span>] <span class="op">*</span> <span class="fl">0.5</span>)</span></code></pre></div>
<div class="sourceCode" id="cb641"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb641-1"><a href="#cb641-1" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n <span class="dv">10</span> vectorizer(df)</span></code></pre></div>
<pre class="python_output"><code>80.1 µs ± 42.8 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)</code></pre>
<div class="sourceCode" id="cb643"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb643-1"><a href="#cb643-1" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n <span class="dv">10</span> applyer(df)</span></code></pre></div>
<pre class="python_output"><code>1.37 ms ± 112 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)</code></pre>
<div class="sourceCode" id="cb645"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb645-1"><a href="#cb645-1" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n <span class="dv">10</span> iterrows(df)</span></code></pre></div>
<pre class="python_output"><code>256 ms ± 2.48 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)</code></pre>
<div class="sourceCode" id="cb647"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb647-1"><a href="#cb647-1" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n <span class="dv">10</span> itertuples1(df)</span></code></pre></div>
<pre class="python_output"><code>6.61 ms ± 200 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)</code></pre>
<div class="sourceCode" id="cb649"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb649-1"><a href="#cb649-1" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n <span class="dv">10</span> itertuples2(df)</span></code></pre></div>
<pre class="python_output"><code>3.91 ms ± 132 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)</code></pre>
</div>
<div id="xử-lý-song-song-trong-pandas" class="section level2 hasAnchor" number="11.5">
<h2 class="hasAnchor"><span class="header-section-number">11.5</span> Xử lý song song trong pandas<a href="#x%E1%BB%AD-l%C3%BD-song-song-trong-pandas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Xử lý song song là phương pháp tận dụng số lượng core của CPU để giải quyết vấn đề trong thời gian ngắn hơn.</p>
<div id="pandarallel" class="section level3 hasAnchor" number="11.5.1">
<h3 class="hasAnchor"><span class="header-section-number">11.5.1</span> pandarallel<a href="#pandarallel" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Để cài đặt pandarallel bằng <code>pip</code></p>
<div class="sourceCode" id="cb651"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb651-1"><a href="#cb651-1" tabindex="-1"></a>pip install pandarallel</span></code></pre></div>
<p>Cách sử dụng</p>
<div class="sourceCode" id="cb652"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb652-1"><a href="#cb652-1" tabindex="-1"></a><span class="im">from</span> pandarallel <span class="im">import</span> pandarallel</span>
<span id="cb652-2"><a href="#cb652-2" tabindex="-1"></a>pandarallel.initialize(progress_bar<span class="op">=</span><span class="va">True</span>, n_workers<span class="op">=</span><span class="dv">4</span>)</span></code></pre></div>
<p>Để thiết lập cho pandarallel ta dùng <code>.initialize</code>. Trong đó:</p>
<ul>
<li><p><code>n_workers</code>: là số lượng cores của CPU</p></li>
<li><p><code>progress_bar</code>: show tiến trình</p></li>
</ul>
<p>Để áp dụng pandarallel ta chỉ việc thay thế <code>.apply</code> bằng <code>.parallel_apply</code></p>
<div class="sourceCode" id="cb653"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb653-1"><a href="#cb653-1" tabindex="-1"></a><span class="co"># df.apply(func)</span></span>
<span id="cb653-2"><a href="#cb653-2" tabindex="-1"></a>df.parallel_apply(func)</span></code></pre></div>
<!--chapter:end:posts/05-Loop.Rmd-->
</div>
</div>
<div id="tính-toán-trên-các-phần-tử-trong-pandas-1" class="section level1 hasAnchor" number="12">
<h1 class="hasAnchor"><span class="header-section-number">12</span> Tính toán trên các phần tử trong Pandas<a href="#t%C3%ADnh-to%C3%A1n-tr%C3%AAn-c%C3%A1c-ph%E1%BA%A7n-t%E1%BB%AD-trong-pandas-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div class="sourceCode" id="cb654"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb654-1"><a href="#cb654-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;data/big_mart_sales.csv&#39;</span>)</span></code></pre></div>
<!--chapter:end:posts/05-Loop/00-Introduction.Rmd-->
<div id="sử-dụng-vectorization-1" class="section level2 hasAnchor" number="12.1">
<h2 class="hasAnchor"><span class="header-section-number">12.1</span> Sử dụng Vectorization<a href="#s%E1%BB%AD-d%E1%BB%A5ng-vectorization-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Giả sử như muốn tạo cột <code>price</code>= <code>Item_Outlet_Sales</code> * <code>5%</code></p>
<div class="sourceCode" id="cb655"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb655-1"><a href="#cb655-1" tabindex="-1"></a>df[<span class="st">&#39;price&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Item_Outlet_Sales&#39;</span>] <span class="op">*</span> <span class="fl">0.05</span></span>
<span id="cb655-2"><a href="#cb655-2" tabindex="-1"></a>df[[<span class="st">&#39;Item_Outlet_Sales&#39;</span>, <span class="st">&#39;price&#39;</span>]]</span></code></pre></div>
<pre class="python_output"><code>      Item_Outlet_Sales      price
0             3735.1380  186.75690
1              443.4228   22.17114
2             2097.2700  104.86350
3              732.3800   36.61900
4              994.7052   49.73526
...                 ...        ...
8518          2778.3834  138.91917
8519           549.2850   27.46425
8520          1193.1136   59.65568
8521          1845.5976   92.27988
8522           765.6700   38.28350</code></pre>
<p>Nối hai cột lại với nhau, Ví dụ</p>
<ul>
<li><p>nối <code>Item_type</code> và <code>Item_Fat_Content</code> thành <code>Item_Type_Fat_Content</code></p></li>
<li><p>nối <code>Outlet_Identifier</code> và <code>Outlet_Establishment_Year</code> thành <code>Outlet_Identifier_Establishment_Year</code>. Trong trường hợp hợp này <code>Outlet_Establishment_Year</code> thuộc dạng số nên để nối dạng text và số ta ép kiểu dạng số về text sử dụng <code>astype()</code></p></li>
</ul>
<div class="sourceCode" id="cb657"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb657-1"><a href="#cb657-1" tabindex="-1"></a>df[<span class="st">&#39;Item_Type_Fat_Content&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Item_Type&#39;</span>] <span class="op">+</span> <span class="st">&#39;_&#39;</span> <span class="op">+</span> df[<span class="st">&#39;Item_Fat_Content&#39;</span>]</span>
<span id="cb657-2"><a href="#cb657-2" tabindex="-1"></a>df[<span class="st">&#39;Outlet_Identifier_Establishment_Year&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;Outlet_Identifier&#39;</span>] <span class="op">+</span> <span class="st">&#39;_&#39;</span> <span class="op">+</span>df[<span class="st">&#39;Outlet_Establishment_Year&#39;</span>].astype(<span class="st">&#39;str&#39;</span>)</span>
<span id="cb657-3"><a href="#cb657-3" tabindex="-1"></a>df[[<span class="st">&#39;Item_Type_Fat_Content&#39;</span>, <span class="st">&#39;Outlet_Identifier_Establishment_Year&#39;</span>]]</span></code></pre></div>
<pre class="python_output"><code>              Item_Type_Fat_Content Outlet_Identifier_Establishment_Year
0                     Dairy_Low Fat                          OUT049_1999
1               Soft Drinks_Regular                          OUT018_2009
2                      Meat_Low Fat                          OUT049_1999
3     Fruits and Vegetables_Regular                          OUT010_1998
4                 Household_Low Fat                          OUT013_1987
...                             ...                                  ...
8518            Snack Foods_Low Fat                          OUT013_1987
8519           Baking Goods_Regular                          OUT045_2002
8520     Health and Hygiene_Low Fat                          OUT035_2004
8521            Snack Foods_Regular                          OUT018_2009
8522            Soft Drinks_Low Fat                          OUT046_1997</code></pre>
<!--chapter:end:posts/05-Loop/01-Vectorization.Rmd-->
</div>
<div id="sử-dụng-apply-1" class="section level2 hasAnchor" number="12.2">
<h2 class="hasAnchor"><span class="header-section-number">12.2</span> Sử dụng apply<a href="#s%E1%BB%AD-d%E1%BB%A5ng-apply-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>apply</code> để thực thi một hàm theo dòng hoặc cột</p>
<div id="sử-dụng-apply-lên-series" class="section level3 hasAnchor" number="12.2.1">
<h3 class="hasAnchor"><span class="header-section-number">12.2.1</span> Sử dụng apply lên Series<a href="#s%E1%BB%AD-d%E1%BB%A5ng-apply-l%C3%AAn-series" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb659"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb659-1"><a href="#cb659-1" tabindex="-1"></a>Series.<span class="bu">apply</span>(func, convert_dtype<span class="op">=</span><span class="va">True</span>, args<span class="op">=</span>(), <span class="op">**</span>kwargs)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>func</code>: là hàm cần thực thi</p></li>
<li><p><code>convert_dtype</code>: Giá trị kiểu boolean. Nếu nó được đặt thành True (mặc định), xử lý dữ liệu sẽ cố gắng tìm dtype tốt hơn cho các kết quả của hàm <code>func</code>. Nếu <code>False</code>, thì dtype sẽ là type(object)</p></li>
<li><p><code>args</code>: Các đối số của hàm</p></li>
</ul>
<p>Ví dụ, thao tác <code>Item_Outlet_Sales</code> * <code>5%</code></p>
<p>Sử dụng lambda function</p>
<div class="sourceCode" id="cb660"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb660-1"><a href="#cb660-1" tabindex="-1"></a>df[<span class="st">&#39;Item_Outlet_Sales&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x <span class="op">*</span> <span class="fl">0.05</span>)</span></code></pre></div>
<pre class="python_output"><code>0       186.75690
1        22.17114
2       104.86350
3        36.61900
4        49.73526
          ...    
8518    138.91917
8519     27.46425
8520     59.65568
8521     92.27988
8522     38.28350
Name: Item_Outlet_Sales, Length: 8523, dtype: float64</code></pre>
<p>Sử dụng hàm tự định nghĩa</p>
<div class="sourceCode" id="cb662"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb662-1"><a href="#cb662-1" tabindex="-1"></a><span class="kw">def</span> set_price(x, k<span class="op">=</span><span class="fl">0.05</span>):</span>
<span id="cb662-2"><a href="#cb662-2" tabindex="-1"></a>    <span class="cf">return</span> x <span class="op">*</span> k</span></code></pre></div>
<div class="sourceCode" id="cb663"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb663-1"><a href="#cb663-1" tabindex="-1"></a>df[<span class="st">&#39;Item_Outlet_Sales&#39;</span>].<span class="bu">apply</span>(set_price)</span></code></pre></div>
<pre class="python_output"><code>0       186.75690
1        22.17114
2       104.86350
3        36.61900
4        49.73526
          ...    
8518    138.91917
8519     27.46425
8520     59.65568
8521     92.27988
8522     38.28350
Name: Item_Outlet_Sales, Length: 8523, dtype: float64</code></pre>
<p>Có thể truyền tham số <code>k</code> vào hàm <code>set_price</code> bằng hai cách</p>
<div class="sourceCode" id="cb665"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb665-1"><a href="#cb665-1" tabindex="-1"></a><span class="co"># Cách 1 - Dùng lambda</span></span>
<span id="cb665-2"><a href="#cb665-2" tabindex="-1"></a>df[<span class="st">&#39;Item_Outlet_Sales&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: set_price(x, <span class="fl">0.1</span>))</span>
<span id="cb665-3"><a href="#cb665-3" tabindex="-1"></a></span>
<span id="cb665-4"><a href="#cb665-4" tabindex="-1"></a><span class="co"># Cách 2 - Dùng `arg`</span></span>
<span id="cb665-5"><a href="#cb665-5" tabindex="-1"></a>df[<span class="st">&#39;Item_Outlet_Sales&#39;</span>].<span class="bu">apply</span>(set_price, k<span class="op">=</span><span class="fl">0.1</span>)</span></code></pre></div>
</div>
<div id="sử-dụng-apply-lên-dataframe" class="section level3 hasAnchor" number="12.2.2">
<h3 class="hasAnchor"><span class="header-section-number">12.2.2</span> Sử dụng apply lên <code>DataFrame</code><a href="#s%E1%BB%AD-d%E1%BB%A5ng-apply-l%C3%AAn-dataframe" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Ta dùng cú pháp</p>
<div class="sourceCode" id="cb666"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb666-1"><a href="#cb666-1" tabindex="-1"></a>DataFrame.<span class="bu">apply</span>(func, axis<span class="op">=</span><span class="dv">0</span>, raw<span class="op">=</span><span class="va">False</span>, result_type<span class="op">=</span><span class="va">None</span>, args<span class="op">=</span>(), <span class="op">**</span>kwargs)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>func</code>: là hàm cần thực thi</p></li>
<li><p><code>axis</code>: thực thi theo dòng <code>0</code> hoặc cột <code>1</code></p></li>
<li><p><code>raw</code>: Xác định xem dòng hoặc cột có thể chuyển về <code>Series</code> hoặc <code>ndarray</code></p></li>
<li><p><code>result_type</code>: Chỉ áp dụng cho <code>axis=1</code></p></li>
<li><p><code>args</code>: Các đối số của hàm</p></li>
</ul>
<p>Ví dụ:</p>
<div class="sourceCode" id="cb667"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb667-1"><a href="#cb667-1" tabindex="-1"></a>sample_df <span class="op">=</span> sample_df <span class="op">=</span> pd.DataFrame([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="st">&#39;A&#39;</span>], [<span class="dv">3</span>, <span class="dv">6</span>, <span class="st">&#39;B&#39;</span>], [<span class="dv">5</span>, <span class="dv">10</span>, <span class="st">&#39;C&#39;</span>]], columns<span class="op">=</span>[<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>, <span class="st">&#39;C&#39;</span>])</span>
<span id="cb667-2"><a href="#cb667-2" tabindex="-1"></a>sample_df</span></code></pre></div>
<pre class="python_output"><code>   A   B  C
0  1   2  A
1  3   6  B
2  5  10  C</code></pre>
<p>Áp dụng trên toàn <code>DataFrame</code></p>
<div class="sourceCode" id="cb669"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb669-1"><a href="#cb669-1" tabindex="-1"></a>sample_df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x <span class="op">*</span> <span class="dv">2</span>)</span></code></pre></div>
<pre class="python_output"><code>     A   B   C
0    2   4  AA
1    6  12  BB
2   10  20  CC</code></pre>

<div class="rmdnote">
<p><strong><em>Lưu ý:</em></strong></p>
<p>Khi áp dụng cho toàn <code>DataFrame</code> hãy cẩn thận hàm <code>func</code> truyền vào, nếu <code>func</code> không áp dụng được cho toàn bộ các phần tử sẽ báo lỗi.</p>
Ví dụ ở trên với x * 2 vẫn áp dụng được cho cột <code>C</code> dạng <code>str</code>, nhưng khi thay bằng x ** 2 sẽ báo lỗi vì toán tử <code>**</code> không áp dụng cho <code>str</code>
</div>
<p>Áp dụng trên một số cột trong <code>DataFrame</code></p>
<div class="sourceCode" id="cb671"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb671-1"><a href="#cb671-1" tabindex="-1"></a><span class="co">## Theo cột</span></span>
<span id="cb671-2"><a href="#cb671-2" tabindex="-1"></a>sample_df[[<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>]].<span class="bu">apply</span>(np.<span class="bu">sum</span>, axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<pre class="python_output"><code>0    13
1    13
2    13
dtype: int64</code></pre>
<div class="sourceCode" id="cb673"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb673-1"><a href="#cb673-1" tabindex="-1"></a><span class="co">## Theo dòng</span></span>
<span id="cb673-2"><a href="#cb673-2" tabindex="-1"></a>df[[<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>]].<span class="bu">apply</span>(<span class="kw">lambda</span> x: np.<span class="bu">sum</span>(x), axis<span class="op">=</span><span class="dv">0</span>)</span></code></pre></div>
<pre class="python_output"><code>A    12
B    27
dtype: int64</code></pre>
<p>Một cách khác áp dụng trên một số cột trong <code>DataFrame</code></p>
<p>Sử dụng lambda</p>
<div class="sourceCode" id="cb675"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb675-1"><a href="#cb675-1" tabindex="-1"></a>sample_df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: x[<span class="st">&#39;A&#39;</span>] <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> x[<span class="st">&#39;B&#39;</span>], axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<pre class="python_output"><code>0     5
1    15
2    25
dtype: int64</code></pre>
<p>Dùng hàm định nghĩa</p>
<div class="sourceCode" id="cb677"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb677-1"><a href="#cb677-1" tabindex="-1"></a><span class="kw">def</span> dsum(row):</span>
<span id="cb677-2"><a href="#cb677-2" tabindex="-1"></a>    <span class="cf">return</span> row[<span class="st">&#39;A&#39;</span>] <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> row[<span class="st">&#39;B&#39;</span>]</span></code></pre></div>
<div class="sourceCode" id="cb678"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb678-1"><a href="#cb678-1" tabindex="-1"></a>sample_df.<span class="bu">apply</span>(dsum, axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<pre class="python_output"><code>0     5
1    15
2    25
dtype: int64</code></pre>

<div class="rmdtip">
<p><strong><em>Mẹo:</em></strong></p>
<ul>
<li><p>Không nhất thiết giá trị trả về của hàm là giá trị đơn, giá trị trả về có thể dưới dạng list, tuple hoặc dict</p></li>
<li><p>Dùng <code>result_type</code> để thay đổi cách trả về</p>
</div></li>
</ul>
<p>Ví dụ ta có 1 hàm trả về nhiều giá trị cùng lúc như sau</p>
<div class="sourceCode" id="cb680"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb680-1"><a href="#cb680-1" tabindex="-1"></a><span class="kw">def</span> dsum_2(row):</span>
<span id="cb680-2"><a href="#cb680-2" tabindex="-1"></a>    <span class="cf">return</span> [row[<span class="st">&#39;A&#39;</span>] <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> row[<span class="st">&#39;B&#39;</span>],  row[<span class="st">&#39;A&#39;</span>] <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> row[<span class="st">&#39;B&#39;</span>]]</span></code></pre></div>
<div class="sourceCode" id="cb681"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb681-1"><a href="#cb681-1" tabindex="-1"></a><span class="co">## Khi không sử dụng `result_type`</span></span>
<span id="cb681-2"><a href="#cb681-2" tabindex="-1"></a>sample_df.<span class="bu">apply</span>(dsum_2, axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<pre class="python_output"><code>0      [5, -3]
1     [15, -9]
2    [25, -15]
dtype: object</code></pre>
<p>Kết quả trả về của phương pháp trên là <code>Series</code> với các giá trị của nó là dạng list. Để chuyển <code>Series</code> này thành <code>DataFrame</code> với các cột chứa các giá trị của list theo thứ tự, ta dùng <code>result_type='expand'</code></p>
<div class="sourceCode" id="cb683"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb683-1"><a href="#cb683-1" tabindex="-1"></a>sample_df.<span class="bu">apply</span>(dsum_2, axis<span class="op">=</span><span class="dv">1</span>, result_type<span class="op">=</span><span class="st">&#39;expand&#39;</span>)</span></code></pre></div>
<pre class="python_output"><code>    0   1
0   5  -3
1  15  -9
2  25 -15</code></pre>

<div class="rmdtip">
<strong><em>Mẹo:</em></strong> Có thể cấu trúc trả về dưới dạng <code>DataFrame</code> cho ví dụ trên mà không cần dùng <code>result_type</code> bằng cách sử dụng <code>pd.Series</code> của một <code>dictionary</code>. Lúc này các cột của <code>DataFrame</code> sẽ được đánh nhãn theo key của <code>dictionary</code>
</div>
<div class="sourceCode" id="cb685"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb685-1"><a href="#cb685-1" tabindex="-1"></a><span class="kw">def</span> dsum_3(row):</span>
<span id="cb685-2"><a href="#cb685-2" tabindex="-1"></a>    <span class="cf">return</span> pd.Series({<span class="st">&#39;X&#39;</span>: row[<span class="st">&#39;A&#39;</span>] <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> row[<span class="st">&#39;B&#39;</span>],  <span class="st">&#39;Y&#39;</span>:row[<span class="st">&#39;A&#39;</span>] <span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> row[<span class="st">&#39;B&#39;</span>]})</span></code></pre></div>
<div class="sourceCode" id="cb686"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb686-1"><a href="#cb686-1" tabindex="-1"></a>sample_df.<span class="bu">apply</span>(dsum_3, axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
<pre class="python_output"><code>    X   Y
0   5   -3
1   15  -9
2   25  -15</code></pre>
<!--chapter:end:posts/05-Loop/02-Apply_Function.Rmd-->
<div id="sử-dụng-iterator-1" class="section level2 hasAnchor" number="12.3">
<h2 class="hasAnchor"><span class="header-section-number">12.3</span> Sử dụng iterator<a href="#s%E1%BB%AD-d%E1%BB%A5ng-iterator-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb688"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb688-1"><a href="#cb688-1" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">&#39;data/big_mart_sales.csv&#39;</span>, usecols<span class="op">=</span>[<span class="st">&#39;Item_Identifier&#39;</span>, <span class="st">&#39;Item_Fat_Content&#39;</span>, <span class="st">&#39;Item_Type&#39;</span>, <span class="st">&#39;Outlet_Size&#39;</span>, <span class="st">&#39;Item_Outlet_Sales&#39;</span>, <span class="st">&#39;Outlet_Establishment_Year&#39;</span>])</span></code></pre></div>
<div id="iterrows-1" class="section level3 hasAnchor" number="12.3.1">
<h3 class="hasAnchor"><span class="header-section-number">12.3.1</span> Iterrows<a href="#iterrows-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb689"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb689-1"><a href="#cb689-1" tabindex="-1"></a>DataFrame.iterrows()</span></code></pre></div>
<div class="sourceCode" id="cb690"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb690-1"><a href="#cb690-1" tabindex="-1"></a>row <span class="op">=</span> <span class="bu">next</span>(df.iterrows())</span>
<span id="cb690-2"><a href="#cb690-2" tabindex="-1"></a>row</span></code></pre></div>
<pre class="python_output"><code>(0,
 Item_Identifier                 FDA15
 Item_Fat_Content              Low Fat
 Item_Type                       Dairy
 Outlet_Establishment_Year        1999
 Outlet_Size                    Medium
 Item_Outlet_Sales            3735.138
 Name: 0, dtype: object)</code></pre>
<p>Kết quả trả về cho row là 1 tuple gồm index và Series chứa các giá trị tại index đó.</p>
<p><strong>Cách dùng vòng lặp trong iterrows</strong></p>
<p>Để duyệt từng dòng ta dùng <code>for</code> như bình thường</p>
<div class="sourceCode" id="cb692"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb692-1"><a href="#cb692-1" tabindex="-1"></a>prices <span class="op">=</span> []</span>
<span id="cb692-2"><a href="#cb692-2" tabindex="-1"></a><span class="cf">for</span> i, row <span class="kw">in</span> df.iterrows():</span>
<span id="cb692-3"><a href="#cb692-3" tabindex="-1"></a>    prices.append(row[<span class="st">&#39;Item_Outlet_Sales&#39;</span>] <span class="op">*</span> <span class="fl">0.5</span>)</span>
<span id="cb692-4"><a href="#cb692-4" tabindex="-1"></a><span class="bu">print</span>(prices[:<span class="dv">5</span>])</span></code></pre></div>
<pre class="python_output"><code>[1867.569, 221.7114, 1048.635, 366.19, 497.3526]</code></pre>
</div>
<div id="itertuple-1" class="section level3 hasAnchor" number="12.3.2">
<h3 class="hasAnchor"><span class="header-section-number">12.3.2</span> Itertuple<a href="#itertuple-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb694"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb694-1"><a href="#cb694-1" tabindex="-1"></a>DataFrame.itertuples(index<span class="op">=</span><span class="va">True</span>, name<span class="op">=</span><span class="st">&#39;Pandas&#39;</span>)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>index</code>: <code>True</code> trả về kết quả kèm theo index và <code>False</code> lược bỏ index</p></li>
<li><p><code>name</code>: Quy định kiểu trả về</p>
<ul>
<li><code>Pandas</code>: trả về namedtuple</li>
<li><code>None</code>: trả về tuple</li>
<li><code>namedtuple</code>: trả về namedtuple</li>
</ul></li>
</ul>
<p>Trả về <code>namedtuple</code></p>
<div class="sourceCode" id="cb695"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb695-1"><a href="#cb695-1" tabindex="-1"></a><span class="bu">next</span>(df.itertuples(index<span class="op">=</span><span class="va">True</span>))</span></code></pre></div>
<pre class="python_output"><code>Pandas(Index=0, Item_Identifier=&#39;FDA15&#39;, Item_Fat_Content=&#39;Low Fat&#39;, Item_Type=&#39;Dairy&#39;, Outlet_Establishment_Year=1999, Outlet_Size=&#39;Medium&#39;, Item_Outlet_Sales=3735.138)</code></pre>
<p>Trả về <code>tuple</code></p>
<div class="sourceCode" id="cb697"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb697-1"><a href="#cb697-1" tabindex="-1"></a><span class="bu">next</span>(df.itertuples(index<span class="op">=</span><span class="va">False</span>, name<span class="op">=</span><span class="va">None</span>))</span></code></pre></div>
<pre class="python_output"><code>(&#39;FDA15&#39;, &#39;Low Fat&#39;, &#39;Dairy&#39;, 1999, &#39;Medium&#39;, 3735.138)</code></pre>
<p><strong>Cách dùng vòng lặp trong itertuples</strong></p>
<p><code>name=default</code></p>
<div class="sourceCode" id="cb699"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb699-1"><a href="#cb699-1" tabindex="-1"></a>prices <span class="op">=</span> []</span>
<span id="cb699-2"><a href="#cb699-2" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> df.itertuples():</span>
<span id="cb699-3"><a href="#cb699-3" tabindex="-1"></a>    prices.append(row.Item_Outlet_Sales <span class="op">*</span> <span class="fl">0.5</span>)</span>
<span id="cb699-4"><a href="#cb699-4" tabindex="-1"></a><span class="bu">print</span>(prices[:<span class="dv">5</span>])</span></code></pre></div>
<p><code>name=None</code></p>
<div class="sourceCode" id="cb700"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb700-1"><a href="#cb700-1" tabindex="-1"></a>prices <span class="op">=</span> []</span>
<span id="cb700-2"><a href="#cb700-2" tabindex="-1"></a><span class="cf">for</span> row <span class="kw">in</span> df.itertuples(index<span class="op">=</span><span class="va">False</span>, name<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb700-3"><a href="#cb700-3" tabindex="-1"></a>    prices.append(row[<span class="dv">5</span>] <span class="op">*</span> <span class="fl">0.5</span>)</span>
<span id="cb700-4"><a href="#cb700-4" tabindex="-1"></a><span class="bu">print</span>(prices[:<span class="dv">5</span>])</span></code></pre></div>
<!--chapter:end:posts/05-Loop/03-Iterator.Rmd-->
</div>
</div>
<div id="so-sánh-các-phương-pháp-lặp-1" class="section level2 hasAnchor" number="12.4">
<h2 class="hasAnchor"><span class="header-section-number">12.4</span> So sánh các phương pháp lặp<a href="#so-s%C3%A1nh-c%C3%A1c-ph%C6%B0%C6%A1ng-ph%C3%A1p-l%E1%BA%B7p-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb701"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb701-1"><a href="#cb701-1" tabindex="-1"></a></span>
<span id="cb701-2"><a href="#cb701-2" tabindex="-1"></a><span class="kw">def</span> vectorizer(df):</span>
<span id="cb701-3"><a href="#cb701-3" tabindex="-1"></a>    prices <span class="op">=</span> df[<span class="st">&#39;Item_Outlet_Sales&#39;</span>] <span class="op">*</span> <span class="fl">0.5</span></span>
<span id="cb701-4"><a href="#cb701-4" tabindex="-1"></a></span>
<span id="cb701-5"><a href="#cb701-5" tabindex="-1"></a><span class="kw">def</span> applyer(df):</span>
<span id="cb701-6"><a href="#cb701-6" tabindex="-1"></a>    prices <span class="op">=</span> df[<span class="st">&#39;Item_Outlet_Sales&#39;</span>].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x <span class="op">*</span> <span class="fl">0.5</span>)</span>
<span id="cb701-7"><a href="#cb701-7" tabindex="-1"></a></span>
<span id="cb701-8"><a href="#cb701-8" tabindex="-1"></a><span class="kw">def</span> iterrows(df):</span>
<span id="cb701-9"><a href="#cb701-9" tabindex="-1"></a>    prices <span class="op">=</span> []</span>
<span id="cb701-10"><a href="#cb701-10" tabindex="-1"></a>    <span class="cf">for</span> i, row <span class="kw">in</span> df.iterrows():</span>
<span id="cb701-11"><a href="#cb701-11" tabindex="-1"></a>        prices.append(row[<span class="st">&#39;Item_Outlet_Sales&#39;</span>] <span class="op">*</span> <span class="fl">0.5</span>)</span>
<span id="cb701-12"><a href="#cb701-12" tabindex="-1"></a></span>
<span id="cb701-13"><a href="#cb701-13" tabindex="-1"></a><span class="kw">def</span> itertuples1(df):</span>
<span id="cb701-14"><a href="#cb701-14" tabindex="-1"></a>    prices <span class="op">=</span> []</span>
<span id="cb701-15"><a href="#cb701-15" tabindex="-1"></a>    <span class="cf">for</span> row <span class="kw">in</span> df.itertuples():</span>
<span id="cb701-16"><a href="#cb701-16" tabindex="-1"></a>        prices.append(row.Item_Outlet_Sales <span class="op">*</span> <span class="fl">0.5</span>)</span>
<span id="cb701-17"><a href="#cb701-17" tabindex="-1"></a></span>
<span id="cb701-18"><a href="#cb701-18" tabindex="-1"></a><span class="kw">def</span> itertuples2(df):</span>
<span id="cb701-19"><a href="#cb701-19" tabindex="-1"></a>    prices <span class="op">=</span> []</span>
<span id="cb701-20"><a href="#cb701-20" tabindex="-1"></a>    <span class="cf">for</span> row <span class="kw">in</span> df.itertuples(index<span class="op">=</span><span class="va">False</span>, name<span class="op">=</span><span class="va">None</span>):</span>
<span id="cb701-21"><a href="#cb701-21" tabindex="-1"></a>        prices.append(row[<span class="dv">5</span>] <span class="op">*</span> <span class="fl">0.5</span>)</span></code></pre></div>
<div class="sourceCode" id="cb702"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb702-1"><a href="#cb702-1" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n <span class="dv">10</span> vectorizer(df)</span></code></pre></div>
<pre class="python_output"><code>80.1 µs ± 42.8 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)</code></pre>
<div class="sourceCode" id="cb704"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb704-1"><a href="#cb704-1" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n <span class="dv">10</span> applyer(df)</span></code></pre></div>
<pre class="python_output"><code>1.37 ms ± 112 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)</code></pre>
<div class="sourceCode" id="cb706"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb706-1"><a href="#cb706-1" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n <span class="dv">10</span> iterrows(df)</span></code></pre></div>
<pre class="python_output"><code>256 ms ± 2.48 ms per loop (mean ± std. dev. of 7 runs, 10 loops each)</code></pre>
<div class="sourceCode" id="cb708"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb708-1"><a href="#cb708-1" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n <span class="dv">10</span> itertuples1(df)</span></code></pre></div>
<pre class="python_output"><code>6.61 ms ± 200 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)</code></pre>
<div class="sourceCode" id="cb710"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb710-1"><a href="#cb710-1" tabindex="-1"></a><span class="op">%</span>timeit <span class="op">-</span>n <span class="dv">10</span> itertuples2(df)</span></code></pre></div>
<pre class="python_output"><code>3.91 ms ± 132 µs per loop (mean ± std. dev. of 7 runs, 10 loops each)</code></pre>
<!--chapter:end:posts/05-Loop/04-Compare_Loop_Function.Rmd-->
</div>
<div id="xử-lý-song-song-trong-pandas-1" class="section level2 hasAnchor" number="12.5">
<h2 class="hasAnchor"><span class="header-section-number">12.5</span> Xử lý song song trong pandas<a href="#x%E1%BB%AD-l%C3%BD-song-song-trong-pandas-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Xử lý song song là phương pháp tận dụng số lượng core của CPU để giải quyết vấn đề trong thời gian ngắn hơn.</p>
<div id="pandarallel-1" class="section level3 hasAnchor" number="12.5.1">
<h3 class="hasAnchor"><span class="header-section-number">12.5.1</span> pandarallel<a href="#pandarallel-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Để cài đặt pandarallel bằng <code>pip</code></p>
<div class="sourceCode" id="cb712"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb712-1"><a href="#cb712-1" tabindex="-1"></a>pip install pandarallel</span></code></pre></div>
<p>Cách sử dụng</p>
<div class="sourceCode" id="cb713"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb713-1"><a href="#cb713-1" tabindex="-1"></a><span class="im">from</span> pandarallel <span class="im">import</span> pandarallel</span>
<span id="cb713-2"><a href="#cb713-2" tabindex="-1"></a>pandarallel.initialize(progress_bar<span class="op">=</span><span class="va">True</span>, n_workers<span class="op">=</span><span class="dv">4</span>)</span></code></pre></div>
<p>Để thiết lập cho pandarallel ta dùng <code>.initialize</code>. Trong đó:</p>
<ul>
<li><p><code>n_workers</code>: là số lượng cores của CPU</p></li>
<li><p><code>progress_bar</code>: show tiến trình</p></li>
</ul>
<p>Để áp dụng pandarallel ta chỉ việc thay thế <code>.apply</code> bằng <code>.parallel_apply</code></p>
<div class="sourceCode" id="cb714"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb714-1"><a href="#cb714-1" tabindex="-1"></a><span class="co"># df.apply(func)</span></span>
<span id="cb714-2"><a href="#cb714-2" tabindex="-1"></a>df.parallel_apply(func)</span></code></pre></div>
<!--chapter:end:posts/05-Loop/05-Parallel.Rmd-->
</div>
</div>
<div id="các-cách-phối-hợp-nhiều-bảng-với-nhau" class="section level1 hasAnchor" number="13">
<h1 class="hasAnchor"><span class="header-section-number">13</span> Các cách phối hợp nhiều bảng với nhau<a href="#c%C3%A1c-c%C3%A1ch-ph%E1%BB%91i-h%E1%BB%A3p-nhi%E1%BB%81u-b%E1%BA%A3ng-v%E1%BB%9Bi-nhau" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="join" class="section level2 hasAnchor" number="13.1">
<h2 class="hasAnchor"><span class="header-section-number">13.1</span> Join<a href="#join" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="merge" class="section level2 hasAnchor" number="13.2">
<h2 class="hasAnchor"><span class="header-section-number">13.2</span> Merge<a href="#merge" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="concat" class="section level2 hasAnchor" number="13.3">
<h2 class="hasAnchor"><span class="header-section-number">13.3</span> Concat<a href="#concat" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:posts/06-Merge_Join_Concat.Rmd-->
</div>
</div>
<div id="các-cách-phối-hợp-nhiều-bảng" class="section level1 hasAnchor" number="14">
<h1 class="hasAnchor"><span class="header-section-number">14</span> Các cách phối hợp nhiều bảng<a href="#c%C3%A1c-c%C3%A1ch-ph%E1%BB%91i-h%E1%BB%A3p-nhi%E1%BB%81u-b%E1%BA%A3ng" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:posts/06-Merge_Join_Concat/00-Introduction.Rmd-->
<div id="join-1" class="section level2 hasAnchor" number="14.1">
<h2 class="hasAnchor"><span class="header-section-number">14.1</span> Join<a href="#join-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:posts/06-Merge_Join_Concat/01-Join.Rmd-->
</div>
<div id="merge-1" class="section level2 hasAnchor" number="14.2">
<h2 class="hasAnchor"><span class="header-section-number">14.2</span> Merge<a href="#merge-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:posts/06-Merge_Join_Concat/02-Merge.Rmd-->
</div>
<div id="concat-1" class="section level2 hasAnchor" number="14.3">
<h2 class="hasAnchor"><span class="header-section-number">14.3</span> Concat<a href="#concat-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:posts/06-Merge_Join_Concat/03-Concat.Rmd-->
</div>
</div>
<div id="groupby" class="section level1 hasAnchor" number="15">
<h1 class="hasAnchor"><span class="header-section-number">15</span> Groupby<a href="#groupby" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="groupby-1" class="section level2 hasAnchor" number="15.1">
<h2 class="hasAnchor"><span class="header-section-number">15.1</span> Groupby<a href="#groupby-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.groupby</code> sẽ gom các dòng hoặc các cột thành các nhóm khác nhau. Cú pháp cơ bản của <code>.groupby</code> như sau</p>
<div class="sourceCode" id="cb715"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb715-1"><a href="#cb715-1" tabindex="-1"></a>DataFrame.groupby(by<span class="op">=</span><span class="va">None</span>, axis<span class="op">=</span><span class="dv">0</span>, dropna<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<p>Trong đó</p>
<ul>
<li><p><code>by</code>: có thể là dạng mapping, nhãn, danh sách nhãn hoặc một hàm trả về danh sách các index</p></li>
<li><p><code>axis</code>: Tùy chọn group theo dòng {<code>0</code> hoặc <code>index</code>} hoặc cột {<code>1</code> hoặc <code>columns</code>}, mặc định là dòng.</p></li>
<li><p><code>dropna</code>: Mặc định là <code>True</code> sẽ bỏ qua những dòng chứa <code>NA</code> và <code>False</code> sẽ thêm <code>NA</code> là một khóa trong nhóm, tương tự như <code>.value_counts()</code></p></li>
</ul>
<p>Ví dụ với dữ liệu <a href="https://www.kaggle.com/datasets/brijbhushannanda1979/bigmart-sales-data?select=Train.csv">Big Mart Salses</a></p>
<div class="sourceCode" id="cb716"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb716-1"><a href="#cb716-1" tabindex="-1"></a>df.head()</span></code></pre></div>
<pre class="python_output"><code>  Item_Identifier              Item_Type Outlet_Size  Item_Outlet_Sales
0           FDA15                  Dairy      Medium          3735.1380
1           DRC01            Soft Drinks      Medium           443.4228
2           FDN15                   Meat      Medium          2097.2700
3           FDX07  Fruits and Vegetables         NaN           732.3800
4           NCD19              Household        High           994.7052</code></pre>
<div class="sourceCode" id="cb718"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb718-1"><a href="#cb718-1" tabindex="-1"></a>grouped <span class="op">=</span> df.groupby(<span class="st">&#39;Item_Type&#39;</span>)</span>
<span id="cb718-2"><a href="#cb718-2" tabindex="-1"></a><span class="bu">type</span>(grouped)</span></code></pre></div>
<pre class="python_output"><code>pandas.core.groupby.generic.DataFrameGroupBy</code></pre>
<p>Để xem từng nhóm trong group, ta có thể sử dụng <code>.get_groups()</code> và truyền key vào đó. Ví dụ với key <code>Dairy</code></p>
<div class="sourceCode" id="cb720"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb720-1"><a href="#cb720-1" tabindex="-1"></a>grouped.get_group(<span class="st">&#39;Dairy&#39;</span>).head()</span></code></pre></div>
<pre class="python_output"><code>   Item_Identifier Item_Type Outlet_Size  Item_Outlet_Sales
0            FDA15     Dairy      Medium          3735.1380
11           FDA03     Dairy       Small          2187.1530
19           FDU02     Dairy       Small          2748.4224
28           FDE51     Dairy         NaN           178.4344
30           FDV38     Dairy         NaN           163.7868</code></pre>
<p>Khi chọn 1 column sau khi <code>.groupby</code> sẽ trả về kiểu <code>pandas.core.groupby.generic.SeriesGroupBy</code></p>
</div>
<div id="các-hàm-filtering-trong-groupby" class="section level2 hasAnchor" number="15.2">
<h2 class="hasAnchor"><span class="header-section-number">15.2</span> Các hàm Filtering trong Groupby<a href="#c%C3%A1c-h%C3%A0m-filtering-trong-groupby" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong><code>.head(n=5)</code></strong></p>
<p>Trả về <code>n</code> dòng đầu của mỗi group.</p>
<div class="sourceCode" id="cb722"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb722-1"><a href="#cb722-1" tabindex="-1"></a>df.groupby([<span class="st">&#39;Item_Type&#39;</span>]).head(n<span class="op">=</span><span class="dv">2</span>)</span></code></pre></div>
<pre class="python_output"><code>    Item_Identifier              Item_Type Outlet_Size  Item_Outlet_Sales
0             FDA15                  Dairy      Medium          3735.1380
1             DRC01            Soft Drinks      Medium           443.4228
2             FDN15                   Meat      Medium          2097.2700
3             FDX07  Fruits and Vegetables         NaN           732.3800
4             NCD19              Household        High           994.7052
5             FDP36           Baking Goods      Medium           556.6088
6             FDO10            Snack Foods        High           343.5528
7             FDP10            Snack Foods      Medium          4022.7636
8             FDH17           Frozen Foods         NaN          1076.5986
9             FDU28           Frozen Foods         NaN          4710.5350
10            FDY07  Fruits and Vegetables      Medium          1516.0266
11            FDA03                  Dairy       Small          2187.1530
15            FDP49              Breakfast       Small          1547.3192
16            NCB42     Health and Hygiene      Medium          1621.8888
17            FDP49              Breakfast      Medium           718.3982
18            DRI11            Hard Drinks      Medium          2303.6680
21            FDW12           Baking Goods      Medium          4064.0432
22            NCB30              Household       Small          1587.2672
27            DRJ59            Hard Drinks        High           308.9312
29            FDC14                 Canned       Small           125.8362
31            NCS17     Health and Hygiene      Medium          2741.7644
33            FDO23                 Breads         NaN          2174.5028
34            DRH01            Soft Drinks       Small          2085.2856
41            FDK43                   Meat        High          2150.5340
43            FDC02                 Canned      Medium          6768.5228
72            FDH35          Starchy Foods         NaN          4604.6728
114           FDV11                 Breads         NaN          3151.8972
136           FDH35          Starchy Foods      Medium          5262.4832
139           NCN07                 Others         NaN           263.6568
142           NCO55                 Others         NaN          2143.8760
231           FDG33                Seafood      Medium          3435.5280
713           FDH21                Seafood      Medium          1267.6832</code></pre>
<p><strong><code>.tail(n=5)</code></strong></p>
<p>Trả về <code>n</code> dòng cuối của mỗi group</p>
<div class="sourceCode" id="cb724"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb724-1"><a href="#cb724-1" tabindex="-1"></a>df.groupby([<span class="st">&#39;Item_Type&#39;</span>]).tail(n<span class="op">=</span><span class="dv">2</span>)</span></code></pre></div>
<pre class="python_output"><code>     Item_Identifier              Item_Type Outlet_Size  Item_Outlet_Sales
8317           FDN13              Breakfast         NaN          1306.9654
8335           FDO49              Breakfast      Medium           708.4112
8370           FDV23                 Breads       Small           871.5322
8413           FDW59                 Breads       Small          1691.1320
8423           FDJ57                Seafood      Medium          2600.6148
8426           FDA22          Starchy Foods       Small          4512.1266
8457           FDY50                  Dairy       Small          1516.6924
8463           FDG59          Starchy Foods      Medium           810.9444
8473           DRI47            Hard Drinks         NaN           431.4384
8483           DRI11            Hard Drinks         NaN          1612.5676
8488           NCN14                 Others      Medium          2756.4120
8489           FDV13                 Canned      Medium          2109.2544
8491           FDO03                   Meat      Medium          4809.7392
8496           FDJ57                Seafood         NaN          3715.1640
8499           NCK53     Health and Hygiene       Small          2976.1260
8502           NCH43              Household         NaN          3020.0688
8504           NCN18              Household      Medium          4138.6128
8506           DRF37            Soft Drinks      Medium          3944.8650
8508           FDW31  Fruits and Vegetables         NaN          2587.9646
8509           FDG45  Fruits and Vegetables         NaN           424.7804
8511           FDF05           Frozen Foods      Medium          4207.8560
8512           FDR26                  Dairy        High          2479.4392
8513           FDH31                   Meat       Small           595.2252
8514           FDA01                 Canned         NaN           468.7232
8515           FDH24           Baking Goods      Medium          1571.2880
8516           NCJ19                 Others      Medium           858.8820
8517           FDF53           Frozen Foods       Small          3608.6360
8518           FDF22            Snack Foods        High          2778.3834
8519           FDS36           Baking Goods         NaN           549.2850
8520           NCJ29     Health and Hygiene       Small          1193.1136
8521           FDN46            Snack Foods      Medium          1845.5976
8522           DRG01            Soft Drinks       Small           765.6700</code></pre>

<div class="rmdnote">
<strong><em>Lưu ý:</em></strong>
<code>.head()</code> và <code>.tail()</code> trả về các dòng theo thứ tự index của chúng, không trả về theo thứ tự sắp xếp theo key
</div>
</div>
<div id="aggregate-trong-groupby" class="section level2 hasAnchor" number="15.3">
<h2 class="hasAnchor"><span class="header-section-number">15.3</span> Aggregate trong Groupby<a href="#aggregate-trong-groupby" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong><code>.count()</code></strong></p>
<p>Đếm số lượng phần tử cho từng cột trong từng nhóm, không đếm các phần tử NA</p>
<div class="sourceCode" id="cb726"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb726-1"><a href="#cb726-1" tabindex="-1"></a>df.groupby([<span class="st">&#39;Item_Type&#39;</span>]).count() </span></code></pre></div>
<pre class="python_output"><code>                       Item_Identifier  Outlet_Size  Item_Outlet_Sales
Item_Type                                                             
Baking Goods                       648          463                648
Breads                             251          179                251
Breakfast                          110           79                110
Canned                             649          471                649
Dairy                              682          496                682
Frozen Foods                       856          615                856
Fruits and Vegetables             1232          883               1232
Hard Drinks                        214          148                214
Health and Hygiene                 520          367                520
Household                          910          649                910
Meat                               425          309                425
Others                             169          123                169
Seafood                             64           46                 64
Snack Foods                       1200          868               1200
Soft Drinks                        445          312                445
Starchy Foods                      148          105                148</code></pre>
<p><strong><code>.size()</code></strong></p>
<p>Đếm số lượng dòng cho từng nhóm</p>
<div class="sourceCode" id="cb728"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb728-1"><a href="#cb728-1" tabindex="-1"></a>df.groupby([<span class="st">&#39;Item_Type&#39;</span>]).size()</span></code></pre></div>
<pre class="python_output"><code>Item_Type
Baking Goods              648
Breads                    251
Breakfast                 110
Canned                    649
Dairy                     682
Frozen Foods              856
Fruits and Vegetables    1232
Hard Drinks               214
Health and Hygiene        520
Household                 910
Meat                      425
Others                    169
Seafood                    64
Snack Foods              1200
Soft Drinks               445
Starchy Foods             148
dtype: int64</code></pre>
<p><strong><code>SeriesGroupBy.nlargest(n=5)</code></strong></p>
<p>Trả về <code>n</code> dòng lớn nhất của từng nhóm Series</p>
<div class="sourceCode" id="cb730"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb730-1"><a href="#cb730-1" tabindex="-1"></a>df.groupby([<span class="st">&#39;Item_Type&#39;</span>])[<span class="st">&#39;Item_Outlet_Sales&#39;</span>].nlargest(n<span class="op">=</span><span class="dv">2</span>)</span></code></pre></div>
<pre class="python_output"><code>Item_Type                  
Baking Goods           2776     7931.6754
                       809      7759.8990
Breads                 3757     8958.3390
                       7737     7158.6816
Breakfast              7343     8209.3140
                       7690     7943.6598
Canned                 6541    10306.5840
                       6886     8217.3036
Dairy                  4888    10256.6490
                       1009    10236.6750
Frozen Foods           7752     9678.0688
                       997      9275.9256
Fruits and Vegetables  5223    12117.5600
                       1450    11445.1020
Hard Drinks            3087     7843.1240
                       1043     7152.0236
Health and Hygiene     4289     9779.9362
                       4991     8508.9240
Household              7188    13086.9648
                       7191    10072.8882
Meat                   8201     9390.4432
                       7930     9227.9880
Others                 197      6008.8450
                       3529     5546.1140
Seafood                2528     6503.5344
                       5042     5992.2000
Snack Foods            4349    10993.6896
                       333      9267.9360
Soft Drinks            6606     9554.2300
                       5619     8868.4560
Starchy Foods          1254     8132.0812
                       661      7443.6440
Name: Item_Outlet_Sales, dtype: float64</code></pre>
<p><strong><code>SeriesGroupBy.nsmallest(n=5)</code></strong></p>
<p>Trả về <code>n</code> dòng nhỏ nhất của từng nhóm Series</p>
<div class="sourceCode" id="cb732"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb732-1"><a href="#cb732-1" tabindex="-1"></a>df.groupby([<span class="st">&#39;Item_Type&#39;</span>])[<span class="st">&#39;Item_Outlet_Sales&#39;</span>].nsmallest(n<span class="op">=</span><span class="dv">2</span>)</span></code></pre></div>
<pre class="python_output"><code>Item_Type                  
Baking Goods           2055     37.2848
                       430      38.6164
Breads                 7388     35.2874
                       417      83.8908
Breakfast              4350     39.9480
                       920      50.6008
Canned                 5670     37.9506
                       4297     41.9454
Dairy                  3940     40.6138
                       5427     44.6086
Frozen Foods           4265     36.6190
                       7612     36.6190
Fruits and Vegetables  8486     45.2744
                       540      56.5930
Hard Drinks            574      37.9506
                       8116     71.9064
Health and Hygiene     3053     34.6216
                       4280     37.9506
Household              6950     33.2900
                       7861     41.2796
Meat                   5374     47.9376
                       2407     71.9064
Others                 6139     39.9480
                       2394     55.2614
Seafood                6903    149.8050
                       4502    158.4604
Snack Foods            2571     33.9558
                       6871     42.6112
Soft Drinks            906      33.2900
                       1913     40.6138
Starchy Foods          828      58.5904
                       5445     97.2068
Name: Item_Outlet_Sales, dtype: float64</code></pre>
<p><strong>aggregate</strong></p>
<div class="sourceCode" id="cb734"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb734-1"><a href="#cb734-1" tabindex="-1"></a>.aggregate(func<span class="op">=</span><span class="va">None</span>, <span class="op">*</span>args, engine<span class="op">=</span><span class="va">None</span>, engine_kwargs<span class="op">=</span><span class="va">None</span>)</span></code></pre></div>
<p>Trong đó:</p>
<ul>
<li><p><code>func</code>:</p>
<ul>
<li><p>một hàm hoặc danh sách hàm</p></li>
<li><p>hàm dạng string</p></li>
<li><p>dictionary chứa nhãn và hàm cho từng nhãn</p></li>
</ul></li>
<li><p><code>*args</code>: Đối số truyền vào hàm <code>func</code></p></li>
<li><p><code>engine</code>: Engine tính toán có thể là <code>cython</code>, <code>numba</code></p></li>
</ul>
<p>Danh sách hàm</p>
<div class="sourceCode" id="cb735"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb735-1"><a href="#cb735-1" tabindex="-1"></a>df.groupby(<span class="st">&#39;Item_Type&#39;</span>).agg([<span class="st">&#39;min&#39;</span>,<span class="st">&#39;max&#39;</span>])</span></code></pre></div>
<pre class="python_output"><code>                      Item_Identifier        Item_Outlet_Sales            
                                  min    max               min         max
Item_Type                                                                 
Baking Goods                    FDA11  FDZ60           37.2848   7931.6754
Breads                          FDN23  FDZ35           35.2874   8958.3390
Breakfast                       FDK25  FDR37           39.9480   8209.3140
Canned                          FDA01  FDZ49           37.9506  10306.5840
Dairy                           DRC27  FDZ50           40.6138  10256.6490
Frozen Foods                    FDA04  FDZ52           36.6190   9678.0688
Fruits and Vegetables           FDA07  FDZ56           45.2744  12117.5600
Hard Drinks                     DRF23  DRQ35           37.9506   7843.1240
Health and Hygiene              NCA05  NCZ53           34.6216   9779.9362
Household                       NCA06  NCZ54           33.2900  13086.9648
Meat                            FDA39  FDZ51           47.9376   9390.4432
Others                          NCI31  NCQ43           39.9480   6008.8450
Seafood                         FDF33  FDK45          149.8050   6503.5344
Snack Foods                     FDA09  FDZ58           33.9558  10993.6896
Soft Drinks                     DRA12  DRZ24           33.2900   9554.2300
Starchy Foods                   FDA22  FDZ34           58.5904   8132.0812</code></pre>

<div class="rmdnote">
<p><strong><em>Lưu ý:</em></strong></p>
<code>min</code>, <code>max</code> không áp dụng được cho các cột có NaN value. Lúc này pandas sẽ báo Warning <code>FutureWarning: ['Outlet_Size'] did not aggregate successfully.</code>
</div>
<p>Dictionary chứa nhãn và hàm</p>
<div class="sourceCode" id="cb737"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb737-1"><a href="#cb737-1" tabindex="-1"></a>df.groupby(<span class="st">&#39;Item_Type&#39;</span>).agg({<span class="st">&#39;Item_Identifier&#39;</span>: np.<span class="bu">max</span>, <span class="st">&#39;Item_Outlet_Sales&#39;</span>: [np.std, np.mean]})</span></code></pre></div>
<pre class="python_output"><code>                      Item_Identifier Item_Outlet_Sales             
                                 amax               std         mean
Item_Type                                                           
Baking Goods                    FDZ60       1546.788045  1952.971207
Breads                          FDZ35       1644.235914  2204.132226
Breakfast                       FDR37       1911.693586  2111.808651
Canned                          FDZ49       1645.235638  2225.194904
Dairy                           FDZ50       1884.404698  2232.542597
Frozen Foods                    FDZ52       1724.777720  2132.867744
Fruits and Vegetables           FDZ56       1799.503459  2289.009592
Hard Drinks                     DRQ35       1606.191587  2139.221622
Health and Hygiene              NCZ53       1553.633063  2010.000265
Household                       NCZ54       1692.245757  2258.784300
Meat                            FDZ51       1695.231081  2158.977911
Others                          NCQ43       1431.860471  1926.139702
Seafood                         FDK45       1842.988719  2326.065928
Snack Foods                     FDZ58       1705.121755  2277.321739
Soft Drinks                     DRZ24       1674.249752  2006.511735
Starchy Foods                   FDZ34       1773.945328  2374.332773</code></pre>
<p><strong>Sử dụng hàm tự định nghĩa trong Aggregate</strong></p>
<p>Ta có 2 function sau</p>
<div class="sourceCode" id="cb739"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb739-1"><a href="#cb739-1" tabindex="-1"></a><span class="kw">def</span> foo(item_outlet_sales, alpha<span class="op">=</span><span class="dv">1</span>):</span>
<span id="cb739-2"><a href="#cb739-2" tabindex="-1"></a>    mean <span class="op">=</span> np.mean(item_outlet_sales)</span>
<span id="cb739-3"><a href="#cb739-3" tabindex="-1"></a>    <span class="cf">return</span> np.<span class="bu">sum</span>(item_outlet_sales[item_outlet_sales <span class="op">&lt;</span> alpha <span class="op">*</span> mean])</span>
<span id="cb739-4"><a href="#cb739-4" tabindex="-1"></a></span>
<span id="cb739-5"><a href="#cb739-5" tabindex="-1"></a><span class="kw">def</span> bar(item_identifier):</span>
<span id="cb739-6"><a href="#cb739-6" tabindex="-1"></a>    <span class="cf">return</span> <span class="bu">len</span>(<span class="bu">set</span>(item_identifier))</span></code></pre></div>
<div class="sourceCode" id="cb740"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb740-1"><a href="#cb740-1" tabindex="-1"></a>df.groupby(<span class="st">&#39;Item_Type&#39;</span>).agg({<span class="st">&#39;Item_Identifier&#39;</span>: [np.<span class="bu">max</span>, bar], <span class="st">&#39;Item_Outlet_Sales&#39;</span>: [np.mean, foo]})</span></code></pre></div>
<pre class="python_output"><code>                      Item_Identifier      Item_Outlet_Sales             
                                 amax  bar              mean          foo
Item_Type                                                                
Baking Goods                    FDZ60  119       1952.971207  348230.7108
Breads                          FDZ35   45       2204.132226  152370.9932
Breakfast                       FDR37   20       2111.808651   64478.7352
Canned                          FDZ49  120       2225.194904  414387.2620
Dairy                           FDZ50  125       2232.542597  440485.2904
Frozen Foods                    FDZ52  155       2132.867744  514843.8318
Fruits and Vegetables           FDZ56  220       2289.009592  783023.4112
Hard Drinks                     DRQ35   40       2139.221622  126412.1170
Health and Hygiene              NCZ53   95       2010.000265  272449.3548
Household                       NCZ54  170       2258.784300  538634.1974
Meat                            FDZ51   80       2158.977911  263468.3786
Others                          NCQ43   30       1926.139702   81071.1370
Seafood                         FDK45   10       2326.065928   31677.4324
Snack Foods                     FDZ58  220       2277.321739  762663.2472
Soft Drinks                     DRZ24   80       2006.511735  257134.6232
Starchy Foods                   FDZ34   30       2374.332773   94087.5270</code></pre>
<p>bạn có thể truyền vào tham số alpha bằng cách dùng lambda</p>
<div class="sourceCode" id="cb742"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb742-1"><a href="#cb742-1" tabindex="-1"></a>df.groupby(<span class="st">&#39;Item_Type&#39;</span>).agg({<span class="st">&#39;Item_Outlet_Sales&#39;</span>: [np.mean, <span class="kw">lambda</span> x: foo(x, alpha<span class="op">=</span><span class="fl">0.1</span>)]})</span></code></pre></div>
<pre class="python_output"><code>                      Item_Outlet_Sales            
                                   mean  &lt;lambda_0&gt;
Item_Type                                          
Baking Goods                1952.971207   5035.4454
Breads                      2204.132226   1557.3062
Breakfast                   2111.808651   1440.7912
Canned                      2225.194904   5354.3636
Dairy                       2232.542597   5992.8658
Frozen Foods                2132.867744   7111.4098
Fruits and Vegetables       2289.009592  12268.0308
Hard Drinks                 2139.221622   1625.2178
Health and Hygiene          2010.000265   3723.8194
Household                   2258.784300   8425.0332
Meat                        2158.977911   4526.1084
Others                      1926.139702   1445.4518
Seafood                     2326.065928   1404.1722
Snack Foods                 2277.321739   9573.5382
Soft Drinks                 2006.511735   3207.1586
Starchy Foods               2374.332773   1151.1682</code></pre>
<p><strong>Apply trên nhiều cột và sử dụng function tự định nghĩa</strong></p>
<p>Giả sử muốn lấy top_2 item có số lượng Outlet_Sales cao nhất và cao nhì trong từng nhóm. Ta định nghĩa function sau</p>
<div class="sourceCode" id="cb744"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb744-1"><a href="#cb744-1" tabindex="-1"></a><span class="kw">def</span> get_top_ex1(g):</span>
<span id="cb744-2"><a href="#cb744-2" tabindex="-1"></a>    top_1, top_2 <span class="op">=</span> <span class="bu">sorted</span>(<span class="bu">list</span>(<span class="bu">zip</span>(g[<span class="st">&#39;Item_Identifier&#39;</span>], g[<span class="st">&#39;Item_Outlet_Sales&#39;</span>])), key<span class="op">=</span><span class="kw">lambda</span> x: <span class="op">-</span>x[<span class="dv">1</span>])[:<span class="dv">2</span>]</span>
<span id="cb744-3"><a href="#cb744-3" tabindex="-1"></a>    <span class="cf">return</span> pd.Series({<span class="st">&#39;top_1_Item_Identifier&#39;</span>: top_1[<span class="dv">0</span>],</span>
<span id="cb744-4"><a href="#cb744-4" tabindex="-1"></a>                      <span class="st">&#39;top_1_Item_Outlet_Sales&#39;</span>: top_1[<span class="dv">1</span>], </span>
<span id="cb744-5"><a href="#cb744-5" tabindex="-1"></a>                      <span class="st">&#39;top_2_Item_Identifier&#39;</span>: top_2[<span class="dv">0</span>],</span>
<span id="cb744-6"><a href="#cb744-6" tabindex="-1"></a>                      <span class="st">&#39;top_2_Item_Outlet_Sales&#39;</span>: top_2[<span class="dv">1</span>]})</span></code></pre></div>
<p>Trong đó g là DataFrame của từng nhóm chia theo key của <code>groupby</code></p>
<div class="sourceCode" id="cb745"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb745-1"><a href="#cb745-1" tabindex="-1"></a>df.groupby(<span class="st">&#39;Item_Type&#39;</span>).<span class="bu">apply</span>(get_top_ex1)</span></code></pre></div>
<pre class="python_output"><code>                      top_1_Item_Identifier  top_1_Item_Outlet_Sales  \
Item_Type                                                              
Baking Goods                          FDB37                7931.6754   
Breads                                FDR35                8958.3390   
Breakfast                             FDR37                8209.3140   
Canned                                FDI50               10306.5840   
Dairy                                 FDF39               10256.6490   
Frozen Foods                          FDC17                9678.0688   
Fruits and Vegetables                 FDQ19               12117.5600   
Hard Drinks                           DRK23                7843.1240   
Health and Hygiene                    NCM05                9779.9362   
Household                             NCE42               13086.9648   
Meat                                  FDO03                9390.4432   
Others                                NCN55                6008.8450   
Seafood                               FDI57                6503.5344   
Snack Foods                           FDP33               10993.6896   
Soft Drinks                           DRF36                9554.2300   
Starchy Foods                         FDG47                8132.0812   

                      top_2_Item_Identifier  top_2_Item_Outlet_Sales  
Item_Type                                                             
Baking Goods                          FDL24                7759.8990  
Breads                                FDS11                7158.6816  
Breakfast                             FDQ37                7943.6598  
Canned                                FDX13                8217.3036  
Dairy                                 FDU14               10236.6750  
Frozen Foods                          FDK28                9275.9256  
Fruits and Vegetables                 FDZ20               11445.1020  
Hard Drinks                           DRF23                7152.0236  
Health and Hygiene                    NCQ53                8508.9240  
Household                             NCH18               10072.8882  
Meat                                  FDP15                9227.9880  
Others                                NCM43                5546.1140  
Seafood                               FDI09                5992.2000  
Snack Foods                           FDN58                9267.9360  
Soft Drinks                           DRE48                8868.4560  
Starchy Foods                         FDA34                7443.6440  </code></pre>
<!--chapter:end:posts/07-Groupby_Aggregate.Rmd-->
</div>
</div>
<div id="groupby-2" class="section level1 hasAnchor" number="16">
<h1 class="hasAnchor"><span class="header-section-number">16</span> Groupby<a href="#groupby-2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:posts/07-Groupby_Aggregate/00-Introduction.Rmd-->
<div id="groupby-3" class="section level2 hasAnchor" number="16.1">
<h2 class="hasAnchor"><span class="header-section-number">16.1</span> Groupby<a href="#groupby-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Phương thức <code>.groupby</code> sẽ gom các dòng hoặc các cột thành các nhóm khác nhau. Cú pháp cơ bản của <code>.groupby</code> như sau</p>
<div class="sourceCode" id="cb747"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb747-1"><a href="#cb747-1" tabindex="-1"></a>DataFrame.groupby(by<span class="op">=</span><span class="va">None</span>, axis<span class="op">=</span><span class="dv">0</span>, dropna<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<p>Trong đó</p>
<ul>
<li><p><code>by</code>: có thể là dạng mapping, nhãn, danh sách nhãn hoặc một hàm trả về danh sách các index</p></li>
<li><p><code>axis</code>: Tùy chọn group theo dòng {<code>0</code> hoặc <code>index</code>} hoặc cột {<code>1</code> hoặc <code>columns</code>}, mặc định là dòng.</p></li>
<li><p><code>dropna</code>: Mặc định là <code>True</code> sẽ bỏ qua những dòng chứa <code>NA</code> và <code>False</code> sẽ thêm <code>NA</code> là một khóa trong nhóm, tương tự như <code>.value_counts()</code></p></li>
</ul>
<p>Ví dụ với dữ liệu <a href="https://www.kaggle.com/datasets/brijbhushannanda1979/bigmart-sales-data?select=Train.csv">Big Mart Salses</a></p>
<div class="sourceCode" id="cb748"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb748-1"><a href="#cb748-1" tabindex="-1"></a>df.head()</span></code></pre></div>
<pre class="python_output"><code>  Item_Identifier              Item_Type Outlet_Size  Item_Outlet_Sales
0           FDA15                  Dairy      Medium          3735.1380
1           DRC01            Soft Drinks      Medium           443.4228
2           FDN15                   Meat      Medium          2097.2700
3           FDX07  Fruits and Vegetables         NaN           732.3800
4           NCD19              Household        High           994.7052</code></pre>
<div class="sourceCode" id="cb750"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb750-1"><a href="#cb750-1" tabindex="-1"></a>grouped <span class="op">=</span> df.groupby(<span class="st">&#39;Item_Type&#39;</span>)</span>
<span id="cb750-2"><a href="#cb750-2" tabindex="-1"></a><span class="bu">type</span>(grouped)</span></code></pre></div>
<pre class="python_output"><code>pandas.core.groupby.generic.DataFrameGroupBy</code></pre>
<p>Để xem từng nhóm trong group, ta có thể sử dụng <code>.get_groups()</code> và truyền key vào đó. Ví dụ với key <code>Dairy</code></p>
<div class="sourceCode" id="cb752"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb752-1"><a href="#cb752-1" tabindex="-1"></a>grouped.get_group(<span class="st">&#39;Dairy&#39;</span>).head()</span></code></pre></div>
<pre class="python_output"><code>   Item_Identifier Item_Type Outlet_Size  Item_Outlet_Sales
0            FDA15     Dairy      Medium          3735.1380
11           FDA03     Dairy       Small          2187.1530
19           FDU02     Dairy       Small          2748.4224
28           FDE51     Dairy         NaN           178.4344
30           FDV38     Dairy         NaN           163.7868</code></pre>
<p>Khi chọn 1 column sau khi <code>.groupby</code> sẽ trả về kiểu <code>pandas.core.groupby.generic.SeriesGroupBy</code></p>
<!--chapter:end:posts/07-Groupby_Aggregate/01-Groupby_base.Rmd-->
</div>
<div id="các-hàm-filtering-trong-groupby-1" class="section level2 hasAnchor" number="16.2">
<h2 class="hasAnchor"><span class="header-section-number">16.2</span> Các hàm Filtering trong Groupby<a href="#c%C3%A1c-h%C3%A0m-filtering-trong-groupby-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong><code>.head(n=5)</code></strong></p>
<p>Trả về <code>n</code> dòng đầu của mỗi group.</p>
<div class="sourceCode" id="cb754"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb754-1"><a href="#cb754-1" tabindex="-1"></a>df.groupby([<span class="st">&#39;Item_Type&#39;</span>]).head(n<span class="op">=</span><span class="dv">2</span>)</span></code></pre></div>
<pre class="python_output"><code>    Item_Identifier              Item_Type Outlet_Size  Item_Outlet_Sales
0             FDA15                  Dairy      Medium          3735.1380
1             DRC01            Soft Drinks      Medium           443.4228
2             FDN15                   Meat      Medium          2097.2700
3             FDX07  Fruits and Vegetables         NaN           732.3800
4             NCD19              Household        High           994.7052
5             FDP36           Baking Goods      Medium           556.6088
6             FDO10            Snack Foods        High           343.5528
7             FDP10            Snack Foods      Medium          4022.7636
8             FDH17           Frozen Foods         NaN          1076.5986
9             FDU28           Frozen Foods         NaN          4710.5350
10            FDY07  Fruits and Vegetables      Medium          1516.0266
11            FDA03                  Dairy       Small          2187.1530
15            FDP49              Breakfast       Small          1547.3192
16            NCB42     Health and Hygiene      Medium          1621.8888
17            FDP49              Breakfast      Medium           718.3982
18            DRI11            Hard Drinks      Medium          2303.6680
21            FDW12           Baking Goods      Medium          4064.0432
22            NCB30              Household       Small          1587.2672
27            DRJ59            Hard Drinks        High           308.9312
29            FDC14                 Canned       Small           125.8362
31            NCS17     Health and Hygiene      Medium          2741.7644
33            FDO23                 Breads         NaN          2174.5028
34            DRH01            Soft Drinks       Small          2085.2856
41            FDK43                   Meat        High          2150.5340
43            FDC02                 Canned      Medium          6768.5228
72            FDH35          Starchy Foods         NaN          4604.6728
114           FDV11                 Breads         NaN          3151.8972
136           FDH35          Starchy Foods      Medium          5262.4832
139           NCN07                 Others         NaN           263.6568
142           NCO55                 Others         NaN          2143.8760
231           FDG33                Seafood      Medium          3435.5280
713           FDH21                Seafood      Medium          1267.6832</code></pre>
<p><strong><code>.tail(n=5)</code></strong></p>
<p>Trả về <code>n</code> dòng cuối của mỗi group</p>
<div class="sourceCode" id="cb756"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb756-1"><a href="#cb756-1" tabindex="-1"></a>df.groupby([<span class="st">&#39;Item_Type&#39;</span>]).tail(n<span class="op">=</span><span class="dv">2</span>)</span></code></pre></div>
<pre class="python_output"><code>     Item_Identifier              Item_Type Outlet_Size  Item_Outlet_Sales
8317           FDN13              Breakfast         NaN          1306.9654
8335           FDO49              Breakfast      Medium           708.4112
8370           FDV23                 Breads       Small           871.5322
8413           FDW59                 Breads       Small          1691.1320
8423           FDJ57                Seafood      Medium          2600.6148
8426           FDA22          Starchy Foods       Small          4512.1266
8457           FDY50                  Dairy       Small          1516.6924
8463           FDG59          Starchy Foods      Medium           810.9444
8473           DRI47            Hard Drinks         NaN           431.4384
8483           DRI11            Hard Drinks         NaN          1612.5676
8488           NCN14                 Others      Medium          2756.4120
8489           FDV13                 Canned      Medium          2109.2544
8491           FDO03                   Meat      Medium          4809.7392
8496           FDJ57                Seafood         NaN          3715.1640
8499           NCK53     Health and Hygiene       Small          2976.1260
8502           NCH43              Household         NaN          3020.0688
8504           NCN18              Household      Medium          4138.6128
8506           DRF37            Soft Drinks      Medium          3944.8650
8508           FDW31  Fruits and Vegetables         NaN          2587.9646
8509           FDG45  Fruits and Vegetables         NaN           424.7804
8511           FDF05           Frozen Foods      Medium          4207.8560
8512           FDR26                  Dairy        High          2479.4392
8513           FDH31                   Meat       Small           595.2252
8514           FDA01                 Canned         NaN           468.7232
8515           FDH24           Baking Goods      Medium          1571.2880
8516           NCJ19                 Others      Medium           858.8820
8517           FDF53           Frozen Foods       Small          3608.6360
8518           FDF22            Snack Foods        High          2778.3834
8519           FDS36           Baking Goods         NaN           549.2850
8520           NCJ29     Health and Hygiene       Small          1193.1136
8521           FDN46            Snack Foods      Medium          1845.5976
8522           DRG01            Soft Drinks       Small           765.6700</code></pre>

<div class="rmdnote">
<strong><em>Lưu ý:</em></strong>
<code>.head()</code> và <code>.tail()</code> trả về các dòng theo thứ tự index của chúng, không trả về theo thứ tự sắp xếp theo key
</div>
<!--chapter:end:posts/07-Groupby_Aggregate/02-Filtering_Groupby.Rmd-->
<!--chapter:end:posts/07-Groupby_Aggregate/03-Aggregate.Rmd-->
</div>
</div>
<div id="làm-việc-với-1-số-kiểu-dữ-liệu" class="section level1 hasAnchor" number="17">
<h1 class="hasAnchor"><span class="header-section-number">17</span> Làm việc với 1 số kiểu dữ liệu<a href="#l%C3%A0m-vi%E1%BB%87c-v%E1%BB%9Bi-1-s%E1%BB%91-ki%E1%BB%83u-d%E1%BB%AF-li%E1%BB%87u" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="xử-lý-dữ-liệu-dạng-text" class="section level2 hasAnchor" number="17.1">
<h2 class="hasAnchor"><span class="header-section-number">17.1</span> Xử lý dữ liệu dạng text<a href="#x%E1%BB%AD-l%C3%BD-d%E1%BB%AF-li%E1%BB%87u-d%E1%BA%A1ng-text" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Chúng ta có thể lưu dữ liệu text trong Pandas dưới hai dạng dữ liệu : object hoặc string​</p>
<div class="sourceCode" id="cb758"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb758-1"><a href="#cb758-1" tabindex="-1"></a>s <span class="op">=</span> pd.Series( [<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;Aaba&quot;</span>, <span class="st">&quot;Baca&quot;</span>, np.nan, <span class="st">&quot;CABA&quot;</span>, <span class="st">&quot;dog&quot;</span>, <span class="st">&quot;cat&quot;</span>], dtype<span class="op">=</span><span class="st">&quot;string&quot;</span>)​</span></code></pre></div>
<p>Để thực hiện các thao tác cho dữ liệu dạng text ta hay dùng <code>s.str.&lt;phương thức&gt;</code>.</p>
<p><strong>lower()</strong></p>
<p>Chúng ta có thể chuyển text về các kí tự viết thường bằng phương thức <code>lower()</code></p>
<div class="sourceCode" id="cb759"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb759-1"><a href="#cb759-1" tabindex="-1"></a>s.<span class="bu">str</span>.lower()</span></code></pre></div>
<pre class="python_output"><code>0       a
1       b
2       c
3    aaba
4    baca
5    &lt;NA&gt;
6    caba
7     dog
8     cat</code></pre>
<p><strong>upper()</strong></p>
<p>Chúng ta có thể chuyển text về các kí tự viết hoa bằng phương thức <code>upper()</code></p>
<div class="sourceCode" id="cb761"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb761-1"><a href="#cb761-1" tabindex="-1"></a>s.<span class="bu">str</span>.upper()</span></code></pre></div>
<pre class="python_output"><code>0       A
1       B
2       C
3    AABA
4    BACA
5    &lt;NA&gt;
6    CABA
7     DOG
8     CAT</code></pre>
<p><strong>split()</strong></p>
<p>split giúp cắt chuỗi theo một pattern cho trước, mặc định pattern là khoảng trắng</p>
<div class="sourceCode" id="cb763"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb763-1"><a href="#cb763-1" tabindex="-1"></a>s2 <span class="op">=</span> pd.Series([<span class="st">&quot;a_b_c &quot;</span>, <span class="st">&quot;c_d_e&quot;</span>, np.nan, <span class="st">&quot;f_g_h&quot;</span>], dtype<span class="op">=</span><span class="st">&quot;string&quot;</span>)</span>
<span id="cb763-2"><a href="#cb763-2" tabindex="-1"></a>s2.<span class="bu">str</span>.split(<span class="st">&quot;_&quot;</span>)​​</span></code></pre></div>
<pre class="python_output"><code>0    [a, b, c]​
1    [c, d, e]​
2         &lt;NA&gt;​
3    [f, g, h]​</code></pre>
<p>Chúng ta có thể chỉ lấy phần tử thứ <code>i</code> sau khi split bằng hai cách</p>
<p>Cách thứ nhất, dùng <code>get(i)</code></p>
<div class="sourceCode" id="cb765"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb765-1"><a href="#cb765-1" tabindex="-1"></a>s2.<span class="bu">str</span>.split(<span class="st">&quot;_&quot;</span>).<span class="bu">str</span>.get(<span class="dv">1</span>)​</span></code></pre></div>
<pre class="python_output"><code>0       b​
1       d​
2    &lt;NA&gt;​
3       g</code></pre>
<p>Cách thứ hai, dùng <code>[i]</code></p>
<div class="sourceCode" id="cb767"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb767-1"><a href="#cb767-1" tabindex="-1"></a>s2.<span class="bu">str</span>.split(<span class="st">&quot;_&quot;</span>).<span class="bu">str</span>[<span class="dv">1</span>]</span></code></pre></div>
<pre class="python_output"><code>0       b​
1       d​
2    &lt;NA&gt;​
3       g</code></pre>
</div>
<div id="xử-lý-dữ-liệu-dạng-timestamp" class="section level2 hasAnchor" number="17.2">
<h2 class="hasAnchor"><span class="header-section-number">17.2</span> Xử lý dữ liệu dạng timestamp<a href="#x%E1%BB%AD-l%C3%BD-d%E1%BB%AF-li%E1%BB%87u-d%E1%BA%A1ng-timestamp" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="category-trong-pandas" class="section level2 hasAnchor" number="17.3">
<h2 class="hasAnchor"><span class="header-section-number">17.3</span> Category trong pandas<a href="#category-trong-pandas" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="xử-lý-missing-data" class="section level2 hasAnchor" number="17.4">
<h2 class="hasAnchor"><span class="header-section-number">17.4</span> Xử lý Missing data<a href="#x%E1%BB%AD-l%C3%BD-missing-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:posts/08-Process_data.Rmd-->
</div>
</div>
<div id="xử-lý-một-số-kiểu-dữ-liệu-trong-pandas" class="section level1 hasAnchor" number="18">
<h1 class="hasAnchor"><span class="header-section-number">18</span> Xử lý một số kiểu dữ liệu trong Pandas<a href="#x%E1%BB%AD-l%C3%BD-m%E1%BB%99t-s%E1%BB%91-ki%E1%BB%83u-d%E1%BB%AF-li%E1%BB%87u-trong-pandas" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:posts/08-Working_with_datatype/00-Introduction.Rmd-->
<div id="xử-lý-dữ-liệu-dạng-text-1" class="section level2 hasAnchor" number="18.1">
<h2 class="hasAnchor"><span class="header-section-number">18.1</span> Xử lý dữ liệu dạng text<a href="#x%E1%BB%AD-l%C3%BD-d%E1%BB%AF-li%E1%BB%87u-d%E1%BA%A1ng-text-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Chúng ta có thể lưu dữ liệu text trong Pandas dưới hai dạng dữ liệu : object hoặc string​</p>
<div class="sourceCode" id="cb769"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb769-1"><a href="#cb769-1" tabindex="-1"></a>s <span class="op">=</span> pd.Series( [<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;Aaba&quot;</span>, <span class="st">&quot;Baca&quot;</span>, np.nan, <span class="st">&quot;CABA&quot;</span>, <span class="st">&quot;dog&quot;</span>, <span class="st">&quot;cat&quot;</span>], dtype<span class="op">=</span><span class="st">&quot;string&quot;</span>)​</span></code></pre></div>
<p>Để thực hiện các thao tác cho dữ liệu dạng text ta hay dùng <code>s.str.&lt;phương thức&gt;</code>.</p>
<div id="lower" class="section level3 hasAnchor" number="18.1.1">
<h3 class="hasAnchor"><span class="header-section-number">18.1.1</span> lower()<a href="#lower" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Chúng ta có thể chuyển text về các kí tự viết thường bằng phương thức <code>lower()</code></p>
<div class="sourceCode" id="cb770"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb770-1"><a href="#cb770-1" tabindex="-1"></a>s.<span class="bu">str</span>.lower()</span></code></pre></div>
<pre class="python_output"><code>0       a
1       b
2       c
3    aaba
4    baca
5    &lt;NA&gt;
6    caba
7     dog
8     cat</code></pre>
</div>
<div id="upper" class="section level3 hasAnchor" number="18.1.2">
<h3 class="hasAnchor"><span class="header-section-number">18.1.2</span> upper()<a href="#upper" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Chúng ta có thể chuyển text về các kí tự viết hoa bằng phương thức <code>upper()</code></p>
<div class="sourceCode" id="cb772"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb772-1"><a href="#cb772-1" tabindex="-1"></a>s.<span class="bu">str</span>.upper()</span></code></pre></div>
<pre class="python_output"><code>0       A
1       B
2       C
3    AABA
4    BACA
5    &lt;NA&gt;
6    CABA
7     DOG
8     CAT</code></pre>
</div>
<div id="split" class="section level3 hasAnchor" number="18.1.3">
<h3 class="hasAnchor"><span class="header-section-number">18.1.3</span> split()<a href="#split" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="thao-tác-cơ-bản" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Thao tác cơ bản<a href="#thao-t%C3%A1c-c%C6%A1-b%E1%BA%A3n" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>split giúp cắt chuỗi theo một pattern cho trước, mặc định pattern là khoảng trắng</p>
<div class="sourceCode" id="cb774"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb774-1"><a href="#cb774-1" tabindex="-1"></a>s2 <span class="op">=</span> pd.Series([<span class="st">&quot;a_b_c &quot;</span>, <span class="st">&quot;c_d_e&quot;</span>, np.nan, <span class="st">&quot;f_g_h&quot;</span>], dtype<span class="op">=</span><span class="st">&quot;string&quot;</span>)</span>
<span id="cb774-2"><a href="#cb774-2" tabindex="-1"></a>s2.<span class="bu">str</span>.split(<span class="st">&quot;_&quot;</span>)​​</span></code></pre></div>
<pre class="python_output"><code>0    [a, b, c]​
1    [c, d, e]​
2         &lt;NA&gt;​
3    [f, g, h]​</code></pre>
<p>Chúng ta có thể chỉ lấy phần tử thứ <code>i</code> sau khi split bằng hai cách</p>
<ul>
<li>Cách thứ nhất, dùng <code>get(i)</code></li>
</ul>
<div class="sourceCode" id="cb776"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb776-1"><a href="#cb776-1" tabindex="-1"></a>s2.<span class="bu">str</span>.split(<span class="st">&quot;_&quot;</span>).<span class="bu">str</span>.get(<span class="dv">1</span>)​</span></code></pre></div>
<pre class="python_output"><code>0       b​
1       d​
2    &lt;NA&gt;​
3       g</code></pre>
<ul>
<li>Cách thứ hai, dùng <code>[i]</code></li>
</ul>
<div class="sourceCode" id="cb778"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb778-1"><a href="#cb778-1" tabindex="-1"></a>s2.<span class="bu">str</span>.split(<span class="st">&quot;_&quot;</span>).<span class="bu">str</span>[<span class="dv">1</span>]</span></code></pre></div>
<pre class="python_output"><code>0       b​
1       d​
2    &lt;NA&gt;​
3       g</code></pre>
</div>
<div id="tách-các-phần-tử-thành-nhiều-series" class="section level4 unnumbered hasAnchor">
<h4 class="unnumbered hasAnchor">Tách các phần tử thành nhiều Series<a href="#t%C3%A1ch-c%C3%A1c-ph%E1%BA%A7n-t%E1%BB%AD-th%C3%A0nh-nhi%E1%BB%81u-series" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Như cách split mặc định ở phần đầu, chúng ta có kết quả là một Series với mỗi phần tử là một danh sách</p>
<div class="sourceCode" id="cb780"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb780-1"><a href="#cb780-1" tabindex="-1"></a>s2.<span class="bu">str</span>.split(<span class="st">&quot;_&quot;</span>)</span></code></pre></div>
<pre class="python_output"><code>0    [a, b, c]​
1    [c, d, e]​
2         &lt;NA&gt;​
3    [f, g, h]​</code></pre>
<p>Chúng ta có thể chia tách các danh sách thành các cột khác nhau bằng tham số <code>expand</code>, lúc này sẽ sinh ra một DataFrame mới với số cột bằng với số phần tử tối đa của các danh sách</p>
<div class="sourceCode" id="cb782"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb782-1"><a href="#cb782-1" tabindex="-1"></a>s2.<span class="bu">str</span>.split(<span class="st">&quot;_&quot;</span>, expand<span class="op">=</span><span class="va">True</span>)​</span></code></pre></div>
<pre class="python_output"><code>      0     1     2​
0     a     b     c​
1     c     d     e​
2  &lt;NA&gt;  &lt;NA&gt;  &lt;NA&gt;​
3     f     g     h</code></pre>
<p>Ngoài ra, chúng ta cũng có thể chỉ định cắt theo vị trí bằng tham số <code>n</code>. Ví dụ chúng ta chỉ cắt chuỗi theo ký tự phân tách <code>_</code> đầu tiên</p>
<div class="sourceCode" id="cb784"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb784-1"><a href="#cb784-1" tabindex="-1"></a>s2.<span class="bu">str</span>.split(<span class="st">&quot;_&quot;</span>, expand<span class="op">=</span><span class="va">True</span>, n<span class="op">=</span><span class="dv">1</span>)​</span></code></pre></div>
<pre class="python_output"><code>      0     1
0     a   b_c
1     c   d_e
2  &lt;NA&gt;  &lt;NA&gt;
3     f   g_h</code></pre>
</div>
</div>
<div id="replace" class="section level3 hasAnchor" number="18.1.4">
<h3 class="hasAnchor"><span class="header-section-number">18.1.4</span> replace<a href="#replace" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb786"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb786-1"><a href="#cb786-1" tabindex="-1"></a>s3 <span class="op">=</span> pd.Series(​</span>
<span id="cb786-2"><a href="#cb786-2" tabindex="-1"></a></span>
<span id="cb786-3"><a href="#cb786-3" tabindex="-1"></a>    [<span class="st">&quot;A &quot;</span>, <span class="st">&quot;B &quot;</span>, <span class="st">&quot;C &quot;</span>, <span class="st">&quot;Aaba &quot;</span>, <span class="st">&quot;Baca &quot;</span>, <span class="st">&quot;&quot;</span>, np.nan, <span class="st">&quot;CABA &quot;</span>, <span class="st">&quot;dog &quot;</span>, <span class="st">&quot;cat&quot;</span>],​</span>
<span id="cb786-4"><a href="#cb786-4" tabindex="-1"></a></span>
<span id="cb786-5"><a href="#cb786-5" tabindex="-1"></a>    dtype<span class="op">=</span><span class="st">&quot;string&quot;</span>,​</span>
<span id="cb786-6"><a href="#cb786-6" tabindex="-1"></a></span>
<span id="cb786-7"><a href="#cb786-7" tabindex="-1"></a>)​</span>
<span id="cb786-8"><a href="#cb786-8" tabindex="-1"></a>s3</span></code></pre></div>
<pre class="python_output"><code>0       A
1       B
2       C
3    Aaba
4    Baca
5        
6    &lt;NA&gt;
7    CABA
8     dog
9     cat</code></pre>
<div class="sourceCode" id="cb788"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb788-1"><a href="#cb788-1" tabindex="-1"></a>s3.<span class="bu">str</span>.replace(<span class="st">&quot;^.a|dog &quot;</span>, <span class="st">&quot;XX-XX &quot;</span>, case<span class="op">=</span><span class="va">False</span>, regex<span class="op">=</span><span class="va">True</span>)​</span></code></pre></div>
<pre class="python_output"><code>0           A
1           B
2           C
3    XX-XX ba
4    XX-XX ca
5            
6        &lt;NA&gt;
7    XX-XX BA
8      XX-XX 
9     XX-XX t</code></pre>
</div>
<div id="remove" class="section level3 hasAnchor" number="18.1.5">
<h3 class="hasAnchor"><span class="header-section-number">18.1.5</span> remove<a href="#remove" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb790"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb790-1"><a href="#cb790-1" tabindex="-1"></a>s <span class="op">=</span> pd.Series([<span class="st">&quot;str_foo &quot;</span>, <span class="st">&quot;str_bar &quot;</span>, <span class="st">&quot;no_prefix&quot;</span>])</span>
<span id="cb790-2"><a href="#cb790-2" tabindex="-1"></a>s​</span></code></pre></div>
<pre class="python_output"><code>0             str_foo
1             bar_str
2    no_prefix_suffix</code></pre>
<div class="sourceCode" id="cb792"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb792-1"><a href="#cb792-1" tabindex="-1"></a>s.<span class="bu">str</span>.removeprefix(<span class="st">&quot;str_&quot;</span>)​</span></code></pre></div>
<pre class="python_output"><code>0                 foo
1             bar_str
2    no_prefix_suffix</code></pre>
<div class="sourceCode" id="cb794"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb794-1"><a href="#cb794-1" tabindex="-1"></a>s.<span class="bu">str</span>.removesuffix(<span class="st">&quot;_str&quot;</span>)​</span></code></pre></div>
<pre class="python_output"><code>0             str_foo
1                 bar
2    no_prefix_suffix</code></pre>
</div>
<div id="concatenate" class="section level3 hasAnchor" number="18.1.6">
<h3 class="hasAnchor"><span class="header-section-number">18.1.6</span> concatenate<a href="#concatenate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Để nối các text với nhau, chúng ta có thể sử dụng phương thức .str.cat()​</p>
<div class="sourceCode" id="cb796"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb796-1"><a href="#cb796-1" tabindex="-1"></a>Series.<span class="bu">str</span>.cat(others<span class="op">=</span><span class="va">None</span>, sep<span class="op">=</span><span class="va">None</span>, na_rep<span class="op">=</span><span class="va">None</span>, join<span class="op">=</span><span class="st">&quot;left&quot;</span>)</span></code></pre></div>
<p>Trong đó​</p>
<ul>
<li><p>others: có thể là Series, DataFrame, np.ndarray hoặc có thể là None​</p></li>
<li><p>sep: dùng để thể hiện phân cách giữa các thành phần sau khi nối​</p></li>
<li><p>na_rep: thay thế các giá trị bị thiếu bằng một giá trị nào đó​</p></li>
<li><p>join: Nếu others là một series thì sẽ join 2 kết quả theo index và theo phương thức { “left”, “right”, “outer”, “inner”}​</p></li>
</ul>
<p>Khi không truyền gì cả vào others, toàn bộ giá trị của series sẽ nối về thành một string​</p>
<div class="sourceCode" id="cb797"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb797-1"><a href="#cb797-1" tabindex="-1"></a>s <span class="op">=</span> pd.Series([<span class="st">&quot;a &quot;</span>, <span class="st">&quot;b &quot;</span>, <span class="st">&quot;c &quot;</span>, <span class="st">&quot;d&quot;</span>, np.nan], dtype<span class="op">=</span><span class="st">&quot;string&quot;</span>)​</span>
<span id="cb797-2"><a href="#cb797-2" tabindex="-1"></a>s.<span class="bu">str</span>.cat()​</span></code></pre></div>
<pre class="python_output"><code>&#39;abcd&#39;</code></pre>
<div class="sourceCode" id="cb799"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb799-1"><a href="#cb799-1" tabindex="-1"></a>s.<span class="bu">str</span>.cat(sep<span class="op">=</span><span class="st">&quot;,&quot;</span>)</span></code></pre></div>
<pre class="python_output"><code>&#39;a,b,c,d&#39;</code></pre>
<div class="sourceCode" id="cb801"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb801-1"><a href="#cb801-1" tabindex="-1"></a>s.<span class="bu">str</span>.cat(sep<span class="op">=</span><span class="st">&quot;</span><span class="ch">\t</span><span class="st">&quot;</span>) </span></code></pre></div>
<pre class="python_output"><code>&#39;a\tb\tc\td&#39;</code></pre>
<div class="sourceCode" id="cb803"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb803-1"><a href="#cb803-1" tabindex="-1"></a>s.<span class="bu">str</span>.cat(sep<span class="op">=</span><span class="st">&quot;,&quot;</span>, na_rep<span class="op">=</span><span class="st">&quot;?&quot;</span>)</span></code></pre></div>
<pre class="python_output"><code>&#39;a,b,c,d,?&#39;</code></pre>
<p>Khi truyền vào <code>cat</code> một List hoặc Array, bắt buộc độ dài của chúng phải bằng với độ dài của Series ​</p>
<div class="sourceCode" id="cb805"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb805-1"><a href="#cb805-1" tabindex="-1"></a>s.<span class="bu">str</span>.cat([<span class="st">&quot;A &quot;</span>, <span class="st">&quot;B &quot;</span>, <span class="st">&quot;C&quot;</span>, np.nan, <span class="st">&quot;E&quot;</span>], na_rep<span class="op">=</span><span class="st">&quot;?&quot;</span>) ​</span></code></pre></div>
<pre class="python_output"><code>0    aA
1    bB
2    cC
3    d?
4    ?E</code></pre>
<p>Concat 2 Series</p>
<p>ví dụ ta muốn kết hợp series <code>s</code> với series <code>t</code>, có các cách kết hợp như sau</p>
<div class="sourceCode" id="cb807"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb807-1"><a href="#cb807-1" tabindex="-1"></a>t <span class="op">=</span> pd.Series([<span class="st">&quot;A &quot;</span>, <span class="st">&quot;B &quot;</span>, <span class="st">&quot;C &quot;</span>, <span class="st">&quot;D&quot;</span>], index<span class="op">=</span>[<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">2</span>])</span>
<span id="cb807-2"><a href="#cb807-2" tabindex="-1"></a>t​</span></code></pre></div>
<pre class="python_output"><code>3    A
0    B
4    C
2    D
dtype: object</code></pre>
<ul>
<li>Sử dụng <code>join="outer"</code>, lúc này sẽ kết hợp cả hai index của hai Series với nhau, nếu Series nào không có index của Series kia thì giá trị phần tử tại đó sẽ là NaN</li>
</ul>
<div class="sourceCode" id="cb809"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb809-1"><a href="#cb809-1" tabindex="-1"></a> s.<span class="bu">str</span>.cat(t, join<span class="op">=</span><span class="st">&quot;outer&quot;</span>)</span></code></pre></div>
<pre class="python_output"><code>0    aB
1    NaN
2     cD
3    dA
4    NaN</code></pre>
<p>Để thay thế NaN bằng một giá trị khác, chúng ta có thể thêm tham số <code>na_rep</code></p>
<div class="sourceCode" id="cb811"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb811-1"><a href="#cb811-1" tabindex="-1"></a>s.<span class="bu">str</span>.cat(t, join<span class="op">=</span><span class="st">&quot;outer&quot;</span>, na_rep<span class="op">=</span><span class="st">&quot;?&quot;</span>)</span></code></pre></div>
<pre class="python_output"><code>0    aB
1    b?
2    cD
3    dA
4    ?C</code></pre>
<!--chapter:end:posts/08-Working_with_datatype/01-Text.Rmd-->
</div>
</div>
<div id="xử-lý-dữ-liệu-dạng-timestamp-1" class="section level2 hasAnchor" number="18.2">
<h2 class="hasAnchor"><span class="header-section-number">18.2</span> Xử lý dữ liệu dạng timestamp<a href="#x%E1%BB%AD-l%C3%BD-d%E1%BB%AF-li%E1%BB%87u-d%E1%BA%A1ng-timestamp-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:posts/08-Working_with_datatype/02-Timestamp.Rmd-->
<!--chapter:end:posts/08-Working_with_datatype/03-Category.Rmd-->
<!--chapter:end:posts/08-Working_with_datatype/04-Missing_values.Rmd-->
</div>
</div>
<div id="một-số-kiến-thức-nâng-cao" class="section level1 hasAnchor" number="19">
<h1 class="hasAnchor"><span class="header-section-number">19</span> Một số kiến thức nâng cao<a href="#m%E1%BB%99t-s%E1%BB%91-ki%E1%BA%BFn-th%E1%BB%A9c-n%C3%A2ng-cao" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="multiindex" class="section level2 hasAnchor" number="19.1">
<h2 class="hasAnchor"><span class="header-section-number">19.1</span> MultiIndex<a href="#multiindex" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="pivot-và-melt" class="section level2 hasAnchor" number="19.2">
<h2 class="hasAnchor"><span class="header-section-number">19.2</span> Pivot và Melt<a href="#pivot-v%C3%A0-melt" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="resample" class="section level2 hasAnchor" number="19.3">
<h2 class="hasAnchor"><span class="header-section-number">19.3</span> Resample<a href="#resample" class="anchor-section" aria-label="Anchor link to header"></a></h2>
</div>
<div id="window" class="section level2 hasAnchor" number="19.4">
<h2 class="hasAnchor"><span class="header-section-number">19.4</span> Window<a href="#window" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:posts/09-Advance_Function.Rmd-->
</div>
</div>
<div id="một-số-kiến-thức-nâng-cao-1" class="section level1 hasAnchor" number="20">
<h1 class="hasAnchor"><span class="header-section-number">20</span> Một số kiến thức nâng cao<a href="#m%E1%BB%99t-s%E1%BB%91-ki%E1%BA%BFn-th%E1%BB%A9c-n%C3%A2ng-cao-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:posts/09-Advanced_Funtion/00-Introduction.Rmd-->
<div id="multiindex-1" class="section level2 hasAnchor" number="20.1">
<h2 class="hasAnchor"><span class="header-section-number">20.1</span> MultiIndex<a href="#multiindex-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<!--chapter:end:posts/09-Advanced_Funtion/01-MultiIndex.Rmd-->
</div>
<div id="sample-và-resample" class="section level2 hasAnchor" number="20.2">
<h2 class="hasAnchor"><span class="header-section-number">20.2</span> Sample và Resample<a href="#sample-v%C3%A0-resample" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sample" class="section level3 hasAnchor" number="20.2.1">
<h3 class="hasAnchor"><span class="header-section-number">20.2.1</span> Sample<a href="#sample" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="resample-1" class="section level3 hasAnchor" number="20.2.2">
<h3 class="hasAnchor"><span class="header-section-number">20.2.2</span> Resample<a href="#resample-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!--chapter:end:posts/09-Advanced_Funtion/02-Sample_Resample.Rmd-->
</div>
</div>
<div id="window-1" class="section level2 hasAnchor" number="20.3">
<h2 class="hasAnchor"><span class="header-section-number">20.3</span> Window<a href="#window-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="shift" class="section level3 hasAnchor" number="20.3.1">
<h3 class="hasAnchor"><span class="header-section-number">20.3.1</span> Shift<a href="#shift" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="rolling" class="section level3 hasAnchor" number="20.3.2">
<h3 class="hasAnchor"><span class="header-section-number">20.3.2</span> Rolling<a href="#rolling" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="expand" class="section level3 hasAnchor" number="20.3.3">
<h3 class="hasAnchor"><span class="header-section-number">20.3.3</span> Expand<a href="#expand" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!--chapter:end:posts/09-Advanced_Funtion/03-Window.Rmd-->
</div>
</div>
<div id="reshape" class="section level2 hasAnchor" number="20.4">
<h2 class="hasAnchor"><span class="header-section-number">20.4</span> Reshape<a href="#reshape" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="transpose" class="section level3 hasAnchor" number="20.4.1">
<h3 class="hasAnchor"><span class="header-section-number">20.4.1</span> transpose<a href="#transpose" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="pivot" class="section level3 hasAnchor" number="20.4.2">
<h3 class="hasAnchor"><span class="header-section-number">20.4.2</span> pivot<a href="#pivot" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="pivot_table" class="section level3 hasAnchor" number="20.4.3">
<h3 class="hasAnchor"><span class="header-section-number">20.4.3</span> pivot_table<a href="#pivot_table" class="anchor-section" aria-label="Anchor link to header"></a></h3>
</div>
<div id="melt" class="section level3 hasAnchor" number="20.4.4">
<h3 class="hasAnchor"><span class="header-section-number">20.4.4</span> melt<a href="#melt" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<!--chapter:end:posts/09-Advanced_Funtion/04-Reshape.Rmd-->
</div>
</div>
</div>
<div id="anomaly-detection-project" class="section level1 hasAnchor" number="21">
<h1 class="hasAnchor"><span class="header-section-number">21</span> Anomaly Detection Project<a href="#anomaly-detection-project" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:posts/10-AD.Rmd-->
</div>
<div id="anomaly-detection-project-1" class="section level1 hasAnchor" number="22">
<h1 class="hasAnchor"><span class="header-section-number">22</span> Anomaly Detection Project<a href="#anomaly-detection-project-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:posts/10-Anormaly_Detection/10-AD.Rmd-->
</div>
<div id="visualize-với-matplotlib" class="section level1 hasAnchor" number="23">
<h1 class="hasAnchor"><span class="header-section-number">23</span> Visualize với Matplotlib<a href="#visualize-v%E1%BB%9Bi-matplotlib" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:posts/11-Visualization/11-Visualize.Rmd-->
</div>
<div id="visualize-với-matplotlib-1" class="section level1 hasAnchor" number="24">
<h1 class="hasAnchor"><span class="header-section-number">24</span> Visualize với Matplotlib<a href="#visualize-v%E1%BB%9Bi-matplotlib-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:posts/11-Visualize.Rmd-->
</div>
<div id="cấu-hình-pandas-1" class="section level1 hasAnchor" number="25">
<h1 class="hasAnchor"><span class="header-section-number">25</span> Cấu hình pandas<a href="#c%E1%BA%A5u-h%C3%ACnh-pandas-1" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:posts/12-Configuration.Rmd-->
</div>
<div id="cấu-hình-pandas-2" class="section level1 hasAnchor" number="26">
<h1 class="hasAnchor"><span class="header-section-number">26</span> Cấu hình pandas<a href="#c%E1%BA%A5u-h%C3%ACnh-pandas-2" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<!--chapter:end:posts/Configuration/12-Configuration.Rmd-->
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<!--bookdown:body:end-->
            </section>

          </div>
        </div>
      </div>
<!--bookdown:link_prev-->
<!--bookdown:link_next-->
    </div>
  </div>
<!--bookdown:config-->

</body>

</html>
